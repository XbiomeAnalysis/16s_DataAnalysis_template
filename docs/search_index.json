[["index.html", "16s microbiota data analysis based on XMAS package Chapter 1 Prerequisites 1.1 Preparing for the tutorial 1.2 Workflow description", " 16s microbiota data analysis based on XMAS package Hua Zou 2022-05-25 Chapter 1 Prerequisites Here, we give users one example to practice the 16s microbiota data analysis workflow by XMAS 2.0. By the way, we also recommend users handling your own microbiota data in a reasonable manner when you utilize this package or workflow. Pay attention to whether your data fit the methods this package provided. 1.1 Preparing for the tutorial This tutorial requires that the users should have basic knowledge on R language and statistics. If you are new to microbial research, we recommend the Statistical Analysis of Microbiome Data with R (Xia et al. 2018) as guide book. We suggest users using local laptop because our own server have not deployed XMAS 2.0 package yet. In addition, installing the following software before using XMAS 2.0. R 3.6.3 or later release Download link. Rstudio Desktop Download link. 1.2 Workflow description The standard data analysis of 16S and MGS data by XMAS 2.0. The upstream process is performed by in-house pipeline. and this example just shows how to perform downstream data analysis. In briefly, the example comprises the following steps: Converting inputs into phyloseq object; Quality Evaluation; Pre-Processing Data; Diversity analysis; Ordination analysis; Composition analysis; Differential analysis. Figure 1.1: Functions of XMAS 2.0 in 16s References "],["convert-inputdata-into-phyloseq-object.html", "Chapter 2 Convert inputdata into phyloseq object 2.1 DADA2 2.2 Summarize phyloseq-class object 2.3 Systematic Information", " Chapter 2 Convert inputdata into phyloseq object r Biocpkg(“phyloseq”) (McMurdie and Holmes 2013) is the most popular Biocondcutor package used by the microbiome research field, and phyloseq-class objects are a great data-standard for microbiota data in R. Therefore, the core functions in XMAS take phyloseq-class object as input. In the phyloseq object, information on OTU abundances, taxonomy of OTUs, the phylogenetic tree and metadata is stored. This tutorial will introduce you the basic steps to convert results from the in-house pipeline into phyloseq-class object. More importantly on how to look at your data and filter appropriately. We will use the inputs from /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/. Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) 2.1 DADA2 dada2 results from standardized_analytics_workflow_R_function 2.1.1 Importing results from dada2 pipeline /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/process/xdada2/dada2_res.rds /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/process/fasta2tree/tree.nwk /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/metadata.txt dada2_res &lt;- readRDS( system.file( &quot;extdata&quot;, &quot;dada2_res.rds&quot;, package = &quot;XMAS&quot; ) ) sam_tab &lt;- read.table( system.file( &quot;extdata&quot;, &quot;dada2_metadata.tsv&quot;, package = &quot;XMAS&quot; ), sep = &quot;\\t&quot;, header = TRUE, stringsAsFactors = FALSE ) tree &lt;- read_tree( system.file( &quot;extdata&quot;, &quot;tree.nwk&quot;, package = &quot;XMAS&quot; ) ) 2.1.2 taxa table We use import_dada2_taxa to convert dada2_res$tax_tab into our own taxa table tax_tab &lt;- import_dada2_taxa(dada2_res$tax_tab) head(tax_tab, 1) ## Kingdom ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG k__Bacteria ## Phylum ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG p__Firmicutes ## Class ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG c__Clostridia ## Order ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG o__Clostridiales ## Family ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG f__Lachnospiraceae ## Genus ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG g__Blautia ## Species ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG s__Blautia_unclassified 2.1.3 otu table otu_tab &lt;- dada2_res$seq_tab # Shouldn&#39;t use the Total Number as SampleID (wrong: 123456; right: X123456) rownames(otu_tab) &lt;- paste0(&quot;S&quot;, rownames(otu_tab)) head(otu_tab[, 1, F]) ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG ## S6030 1253 ## S6032 14677 ## S6033 2929 ## S6035 0 ## S6036 3548 ## S6037 8484 2.1.4 metadata table sam_tab &lt;- sam_tab %&gt;% tibble::column_to_rownames(&quot;seqID&quot;) # Shouldn&#39;t use the Total Number as SampleID (wrong: 123456; right: X123456) rownames(sam_tab) &lt;- paste0(&quot;S&quot;, rownames(sam_tab)) head(sam_tab) ## Group ## S6065 AA ## S6049 AA ## S6043 AA ## S6037 AA ## S6059 AA ## S6060 AA 2.1.5 phyloseq object dada2_ps &lt;- import_dada2(seq_tab = otu_tab, tax_tab = tax_tab, sam_tab = sam_tab, phy_tree = tree) dada2_ps ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 896 taxa and 24 samples ] ## sample_data() Sample Data: [ 24 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 896 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 896 tips and 893 internal nodes ] ## refseq() DNAStringSet: [ 896 reference sequences ] we obtain the phyloseq-class object and then use it to perform data analysis. Here, the phyloseq object comprises five components (OTU Table, Sample Data, Taxonomy Table, Phylogenetic Tree and DNAStringSet). otu_table dada2_ps@otu_table %&gt;% data.frame() %&gt;% head() ## S6030 S6032 S6033 S6035 S6036 S6037 S6040 S6043 S6045 S6046 S6048 S6049 S6050 S6054 S6055 S6058 S6059 S6060 S6061 S6063 S6065 ## ASV_1 1253 14677 2929 0 3548 8484 11727 5218 4942 7347 3503 3803 14593 4275 2812 0 6847 17893 2956 3328 6302 ## ASV_2 2810 1558 1839 11885 0 5632 631 7326 1809 4781 3476 108 3100 39 3879 6389 298 4995 196 45061 542 ## ASV_3 7107 2915 2200 0 1232 19675 0 1617 839 9362 4815 0 0 1121 13472 0 1421 0 0 0 9694 ## ASV_4 0 2280 94 13775 0 4456 937 746 3730 273 85 64 562 448 18 611 96 5976 0 837 0 ## ASV_5 6983 15963 1172 256 12140 874 1722 120 210 0 111 802 994 1971 18 517 808 443 48 109 7 ## ASV_6 489 0 199 0 836 0 8565 0 0 1257 0 5998 0 3093 2091 0 10572 0 8495 0 2703 ## S6066 S6068 S8005 ## ASV_1 8414 0 0 ## ASV_2 357 10870 7325 ## ASV_3 4387 0 14797 ## ASV_4 706 17977 0 ## ASV_5 122 546 2516 ## ASV_6 0 0 974 tax_table dada2_ps@tax_table %&gt;% data.frame() %&gt;% head() ## Kingdom Phylum Class Order Family Genus ## ASV_1 k__Bacteria p__Firmicutes c__Clostridia o__Clostridiales f__Lachnospiraceae g__Blautia ## ASV_2 k__Bacteria p__Actinobacteria c__Actinobacteria o__Bifidobacteriales f__Bifidobacteriaceae g__Bifidobacterium ## ASV_3 k__Bacteria p__Actinobacteria c__Actinobacteria o__Bifidobacteriales f__Bifidobacteriaceae g__Bifidobacterium ## ASV_4 k__Bacteria p__Firmicutes c__Clostridia o__Clostridiales f__Lachnospiraceae g__Lachnospiraceae_unclassified ## ASV_5 k__Bacteria p__Firmicutes c__Bacilli o__Lactobacillales f__Streptococcaceae g__Streptococcus ## ASV_6 k__Bacteria p__Firmicutes c__Clostridia o__Clostridiales f__Ruminococcaceae g__Faecalibacterium ## Species ## ASV_1 s__Blautia_unclassified ## ASV_2 s__Bifidobacterium_unclassified ## ASV_3 s__Bifidobacterium_unclassified ## ASV_4 s__Lachnospiraceae_unclassified ## ASV_5 s__Streptococcus_unclassified ## ASV_6 s__Faecalibacterium_unclassified sample_table dada2_ps@sam_data %&gt;% data.frame() %&gt;% head() ## Group ## S6030 BB ## S6032 BB ## S6033 BB ## S6035 AA ## S6036 BB ## S6037 AA 2.2 Summarize phyloseq-class object summarize_phyloseq(dada2_ps) ## Compositional = NO2 ## 1] Min. number of reads = 511812] Max. number of reads = 936223] Total number of reads = 15025374] Average number of reads = 62605.70833333335] Median number of reads = 619157] Sparsity = 0.8653738839285716] Any OTU sum to 1 or less? NO8] Number of singletons = 09] Percent of OTUs that are singletons ## (i.e. exactly one read detected across all samples)010] Number of sample variables are: 1Group2 ## [[1]] ## [1] &quot;1] Min. number of reads = 51181&quot; ## ## [[2]] ## [1] &quot;2] Max. number of reads = 93622&quot; ## ## [[3]] ## [1] &quot;3] Total number of reads = 1502537&quot; ## ## [[4]] ## [1] &quot;4] Average number of reads = 62605.7083333333&quot; ## ## [[5]] ## [1] &quot;5] Median number of reads = 61915&quot; ## ## [[6]] ## [1] &quot;7] Sparsity = 0.865373883928571&quot; ## ## [[7]] ## [1] &quot;6] Any OTU sum to 1 or less? NO&quot; ## ## [[8]] ## [1] &quot;8] Number of singletons = 0&quot; ## ## [[9]] ## [1] &quot;9] Percent of OTUs that are singletons\\n (i.e. exactly one read detected across all samples)0&quot; ## ## [[10]] ## [1] &quot;10] Number of sample variables are: 1&quot; ## ## [[11]] ## [1] &quot;Group&quot; The minus account of the OTU counts is 51181 in the phyloseq object, and we can use it as the threshold to rarefy. Notice the Sparsity (0.865), indicating the data has many zeros and pay attention to the downstream data analysis. A common property of amplicon based microbiota data generated by sequencing. 2.3 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] backports_1.4.1 Hmisc_4.6-0 plyr_1.8.6 igraph_1.2.11 ## [5] splines_4.1.2 BiocParallel_1.28.3 GenomeInfoDb_1.30.1 TH.data_1.1-0 ## [9] lpsymphony_1.22.0 digest_0.6.29 foreach_1.5.2 htmltools_0.5.2 ## [13] fansi_1.0.2 checkmate_2.0.0 magrittr_2.0.2 memoise_2.0.1 ## [17] cluster_2.1.2 limma_3.50.1 Biostrings_2.62.0 annotate_1.72.0 ## [21] matrixStats_0.61.0 sandwich_3.0-1 metagenomeSeq_1.36.0 jpeg_0.1-9 ## [25] colorspace_2.0-3 ggrepel_0.9.1 blob_1.2.2 corncob_0.2.0 ## [29] xfun_0.30 crayon_1.5.0 RCurl_1.98-1.6 jsonlite_1.8.0 ## [33] libcoin_1.0-9 genefilter_1.76.0 biglm_0.9-2.1 survival_3.3-1 ## [37] zoo_1.8-9 iterators_1.0.14 ape_5.6-2 glue_1.6.2 ## [41] gtable_0.3.0 zlibbioc_1.40.0 XVector_0.34.0 DelayedArray_0.20.0 ## [45] car_3.0-12 Rhdf5lib_1.16.0 shape_1.4.6 BiocGenerics_0.40.0 ## [49] DEoptimR_1.0-10 abind_1.4-5 scales_1.1.1 mvtnorm_1.1-3 ## [53] DBI_1.1.2 edgeR_3.36.0 rstatix_0.7.0 Rcpp_1.0.8.2 ## [57] htmlTable_2.4.0 xtable_1.8-4 foreign_0.8-82 bit_4.0.4 ## [61] Formula_1.2-4 stats4_4.1.2 glmnet_4.1-3 htmlwidgets_1.5.4 ## [65] httr_1.4.2 getopt_1.20.3 DiagrammeR_1.0.9 gplots_3.1.1 ## [69] RColorBrewer_1.1-2 modeltools_0.2-23 ellipsis_0.3.2 pkgconfig_2.0.3 ## [73] XML_3.99-0.9 nnet_7.3-17 sass_0.4.0 locfit_1.5-9.5 ## [77] utf8_1.2.2 tidyselect_1.1.2 rlang_1.0.2 reshape2_1.4.4 ## [81] AnnotationDbi_1.56.2 munsell_0.5.0 tools_4.1.2 visNetwork_2.1.0 ## [85] cachem_1.0.6 cli_3.2.0 generics_0.1.2 RSQLite_2.2.10 ## [89] ade4_1.7-18 broom_0.7.12 evaluate_0.15 biomformat_1.22.0 ## [93] stringr_1.4.0 fastmap_1.1.0 yaml_2.3.5 knitr_1.37 ## [97] bit64_4.0.5 robustbase_0.93-9 caTools_1.18.2 purrr_0.3.4 ## [101] KEGGREST_1.34.0 coin_1.4-2 nlme_3.1-155 protoclust_1.6.3 ## [105] RAIDA_1.0 compiler_4.1.2 rstudioapi_0.13 png_0.1-7 ## [109] ggsignif_0.6.3 geneplotter_1.72.0 bslib_0.3.1 pcaPP_1.9-74 ## [113] stringi_1.7.6 Maaslin2_1.8.0 lattice_0.20-45 Matrix_1.4-0 ## [117] vegan_2.5-7 permute_0.9-7 multtest_2.50.0 vctrs_0.3.8 ## [121] pillar_1.7.0 lifecycle_1.0.1 rhdf5filters_1.6.0 optparse_1.7.1 ## [125] jquerylib_0.1.4 data.table_1.14.2 cowplot_1.1.1 bitops_1.0-7 ## [129] qvalue_2.26.0 GenomicRanges_1.46.1 latticeExtra_0.6-29 R6_2.5.1 ## [133] bookdown_0.24 gridExtra_2.3 KernSmooth_2.23-20 IRanges_2.28.0 ## [137] codetools_0.2-18 gtools_3.9.2 MASS_7.3-55 assertthat_0.2.1 ## [141] Wrench_1.12.0 rhdf5_2.38.1 SummarizedExperiment_1.24.0 DESeq2_1.34.0 ## [145] withr_2.5.0 multcomp_1.4-18 S4Vectors_0.32.3 GenomeInfoDbData_1.2.7 ## [149] mgcv_1.8-39 parallel_4.1.2 rpart_4.1.16 grid_4.1.2 ## [153] tidyr_1.2.0 rmarkdown_2.13 MatrixGenerics_1.6.0 carData_3.0-5 ## [157] base64enc_0.1-3 Biobase_2.54.0 References "],["quality-control.html", "Chapter 3 Quality Control 3.1 Reads’ track by DADA2 3.2 Spike-in sample (BRS) assessment 3.3 Spike-in sample’s (BRS) remove 3.4 Rarefaction curves 3.5 Summarize phyloseq-class object 3.6 Systematic Information", " Chapter 3 Quality Control Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) Quality control of DADA2 results will help us have more rational determinations on the further data analysis. 3.1 Reads’ track by DADA2 plot_Dada2Track(data=dada2_res$reads_track) Figure 3.1: Reads’ track by DADA2 The percentage of the final remained read counts approximate 70%, indicating that we should consider the sequence depth for analysis when we build the sequence library. 3.2 Spike-in sample (BRS) assessment The taxonomic levels of spike-in sample’s bacteria is genus. Firstly, using the summarize_taxa to get the genus level phyloseq object and get the BRS_ID. dada2_ps_genus &lt;- summarize_taxa(dada2_ps, taxa_level = &quot;Genus&quot;) dada2_ps_genus@sam_data ## Group ## S6030 BB ## S6032 BB ## S6033 BB ## S6035 AA ## S6036 BB ## S6037 AA ## S6040 BB ## S6043 AA ## S6045 BB ## S6046 BB ## S6048 BB ## S6049 AA ## S6050 BB ## S6054 BB ## S6055 BB ## S6058 BB ## S6059 AA ## S6060 AA ## S6061 AA ## S6063 BB ## S6065 AA ## S6066 AA ## S6068 BB ## S8005 QC do run_RefCheck under the optimal parameters. BRS_ID: the ID of BRS sample; Reference: the directory of the latest spike-in sample matrix (default: /share/projects/Analytics/analytics/XMAS/RefCheck/); Save: the directory to save the latest spike-in sample matrix (default: /share/projects/Analytics/analytics/XMAS/RefCheck/). To see more details to use ?run_RefCheck. run_RefCheck( ps=dada2_ps_genus, BRS_ID=&quot;S8005&quot;, Reference=NULL, Ref_type=&quot;16s&quot;, Save=NULL) ## Noting: the Reference Matrix is for 16s ## S8005 is in the Reference Matrix&#39;s samples and remove it to run ## ## #########Matched baterica of the Spike-in sample########### ## Checking out all the taxa of the Reference Matrix are in the sequencing dataset ## g__Bifidobacterium ## g__Bacteroides ## g__Faecalibacterium ## g__Lactobacillus ## g__Parabacteroides ## g__Collinsella ## g__Coprococcus_3 ## g__Dorea ## g__Streptococcus ## g__Roseburia ## g__Anaerostipes ## g__Escherichia/Shigella ## g__Enterococcus ## g__Prevotella_9 ## g__Eggerthella ## ## The number of the additional Taxa in the sequencing dataset is 1 ## ########################################################### ## ## ##############Value of the Reference sample############### ## Correlation Coefficient of the Reference sample is: 0.9714 ## Bray Curtis of the Reference sample is: 0.07607 ## Impurity of the Reference sample is: 0.06409 ## ########################################################### ## #####Final Evaluation Results of the Spike-in sample####### ## The spike-in sample of sequencing dataset passed the cutoff of the Reference Matrix ## Cutoff of Coefficient is 0.8946 ## Cutoff of BrayCurtis is 0.3878 ## Cutoff of Impurity is 0.1565 ## ########################################################### ## 8002 8003 8004 8006 8007 8008 8009 8005 mean ## Bifidobacterium 31.11079015 30.88310969 32.31232692 18.4930259 20.20409870 17.96225391 18.03588291 27.22437034 24.52823232 ## Bacteroides 20.44753484 14.46581958 24.57151411 26.7370147 25.85863655 27.51353663 26.99272343 24.23896093 23.85321759 ## Faecalibacterium 0.79850615 0.62937893 1.05531023 1.7487249 1.64282727 1.96346413 1.81219797 1.04035376 1.33634542 ## Lactobacillus 2.61732573 3.36856272 3.44379163 5.9292703 5.78000836 5.78189064 6.32672332 3.87088505 4.63980722 ## Parabacteroides 7.11124408 7.45952579 5.36075144 8.7149995 8.01840234 8.74899584 8.62634005 5.61833757 7.45732457 ## Collinsella 0.12792605 0.88271385 0.55665744 1.2764130 0.67921372 1.89356397 1.26367828 0.45502126 0.89189845 ## Coprococcus_3 1.00380683 0.97969362 0.80270938 1.6693557 1.56419908 1.67969035 1.71221463 0.87586251 1.28594151 ## Dorea 2.80715148 3.45564660 2.46613277 3.9684605 3.99163530 3.81529666 3.69382881 2.34880690 3.31836988 ## Streptococcus 2.91960260 3.43387563 2.59149764 3.4818362 3.31409452 3.51378702 3.37721491 2.68740253 3.16491388 ## Roseburia 0.03404484 0.04750030 0.02806676 0.0338295 0.03178586 0.02503886 0.02499583 0.03311188 0.03229673 ## Anaerostipes 0.32291011 0.43245062 0.31528329 0.5386697 0.44500209 0.53416240 0.48047548 0.32471000 0.42420796 ## Escherichia/Shigella 15.27581475 16.00265210 12.36527954 10.8423545 13.43203680 10.15743185 11.59945565 14.03516268 12.96377349 ## Enterococcus 14.51444842 14.66472707 11.04239952 13.1674820 12.07360937 12.88771113 12.84924735 11.61906390 12.85233610 ## Prevotella_9 0.77374627 3.07465463 2.75709154 2.9145415 2.52446675 3.04952478 2.84952508 5.40257632 2.91826586 ## Eggerthella 0.04951976 0.15437596 0.27131203 0.4840221 0.43998327 0.47365181 0.35549631 0.16128688 0.29870601 ## Impurity_level 0.08562792 0.06531291 0.05987576 0.0000000 0.00000000 0.00000000 0.00000000 0.06409000 0.03436332 3.3 Spike-in sample’s (BRS) remove After evaluating the sequencing quality, we remove the BRS. dada2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = dada2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;) dada2_ps_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 896 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 896 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 896 tips and 893 internal nodes ] ## refseq() DNAStringSet: [ 896 reference sequences ] 3.4 Rarefaction curves plot_RarefCure(ps = dada2_ps_remove_BRS, taxa_level = &quot;OTU&quot;, step = 100, label = &quot;Group&quot;, color = &quot;Group&quot;) ## rarefying sample S6030 ## rarefying sample S6032 ## rarefying sample S6033 ## rarefying sample S6035 ## rarefying sample S6036 ## rarefying sample S6037 ## rarefying sample S6040 ## rarefying sample S6043 ## rarefying sample S6045 ## rarefying sample S6046 ## rarefying sample S6048 ## rarefying sample S6049 ## rarefying sample S6050 ## rarefying sample S6054 ## rarefying sample S6055 ## rarefying sample S6058 ## rarefying sample S6059 ## rarefying sample S6060 ## rarefying sample S6061 ## rarefying sample S6063 ## rarefying sample S6065 ## rarefying sample S6066 ## rarefying sample S6068 Figure 3.2: Rarefaction curves The result showed that all the samples had different sequence depth but had the full sample richness. 3.5 Summarize phyloseq-class object Summarizing the phyloseq-class object by using summarize_phyloseq. It displayed that briefly introduction of the object. summarize_phyloseq(dada2_ps_remove_BRS) ## Compositional = NO2 ## 1] Min. number of reads = 511812] Max. number of reads = 716673] Total number of reads = 14089154] Average number of reads = 61257.17391304355] Median number of reads = 614357] Sparsity = 0.8610248447204976] Any OTU sum to 1 or less? YES8] Number of singletons = 49] Percent of OTUs that are singletons ## (i.e. exactly one read detected across all samples)010] Number of sample variables are: 1Group2 ## [[1]] ## [1] &quot;1] Min. number of reads = 51181&quot; ## ## [[2]] ## [1] &quot;2] Max. number of reads = 71667&quot; ## ## [[3]] ## [1] &quot;3] Total number of reads = 1408915&quot; ## ## [[4]] ## [1] &quot;4] Average number of reads = 61257.1739130435&quot; ## ## [[5]] ## [1] &quot;5] Median number of reads = 61435&quot; ## ## [[6]] ## [1] &quot;7] Sparsity = 0.861024844720497&quot; ## ## [[7]] ## [1] &quot;6] Any OTU sum to 1 or less? YES&quot; ## ## [[8]] ## [1] &quot;8] Number of singletons = 4&quot; ## ## [[9]] ## [1] &quot;9] Percent of OTUs that are singletons\\n (i.e. exactly one read detected across all samples)0&quot; ## ## [[10]] ## [1] &quot;10] Number of sample variables are: 1&quot; ## ## [[11]] ## [1] &quot;Group&quot; The minus account of the OTU counts is 51181 in the phyloseq object, and we can use it as the threshold to rarefy. Notice the Sparsity (0.86), indicating the data has many zeros and pay attention to the downstream data analysis. A common property of amplicon based microbiota data generated by sequencing. 3.6 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] backports_1.4.1 Hmisc_4.6-0 plyr_1.8.6 igraph_1.2.11 ## [5] splines_4.1.2 BiocParallel_1.28.3 GenomeInfoDb_1.30.1 TH.data_1.1-0 ## [9] lpsymphony_1.22.0 digest_0.6.29 foreach_1.5.2 htmltools_0.5.2 ## [13] fansi_1.0.2 checkmate_2.0.0 magrittr_2.0.2 memoise_2.0.1 ## [17] cluster_2.1.2 limma_3.50.1 Biostrings_2.62.0 annotate_1.72.0 ## [21] matrixStats_0.61.0 sandwich_3.0-1 metagenomeSeq_1.36.0 jpeg_0.1-9 ## [25] colorspace_2.0-3 ggrepel_0.9.1 blob_1.2.2 corncob_0.2.0 ## [29] xfun_0.30 crayon_1.5.0 RCurl_1.98-1.6 jsonlite_1.8.0 ## [33] libcoin_1.0-9 genefilter_1.76.0 biglm_0.9-2.1 survival_3.3-1 ## [37] zoo_1.8-9 iterators_1.0.14 ape_5.6-2 glue_1.6.2 ## [41] gtable_0.3.0 zlibbioc_1.40.0 XVector_0.34.0 DelayedArray_0.20.0 ## [45] car_3.0-12 Rhdf5lib_1.16.0 shape_1.4.6 BiocGenerics_0.40.0 ## [49] DEoptimR_1.0-10 abind_1.4-5 scales_1.1.1 mvtnorm_1.1-3 ## [53] DBI_1.1.2 edgeR_3.36.0 rstatix_0.7.0 Rcpp_1.0.8.2 ## [57] htmlTable_2.4.0 xtable_1.8-4 foreign_0.8-82 bit_4.0.4 ## [61] Formula_1.2-4 stats4_4.1.2 glmnet_4.1-3 htmlwidgets_1.5.4 ## [65] httr_1.4.2 getopt_1.20.3 DiagrammeR_1.0.9 gplots_3.1.1 ## [69] RColorBrewer_1.1-2 modeltools_0.2-23 ellipsis_0.3.2 farver_2.1.0 ## [73] pkgconfig_2.0.3 XML_3.99-0.9 nnet_7.3-17 sass_0.4.0 ## [77] locfit_1.5-9.5 utf8_1.2.2 labeling_0.4.2 tidyselect_1.1.2 ## [81] rlang_1.0.2 reshape2_1.4.4 AnnotationDbi_1.56.2 munsell_0.5.0 ## [85] tools_4.1.2 visNetwork_2.1.0 cachem_1.0.6 cli_3.2.0 ## [89] generics_0.1.2 RSQLite_2.2.10 ade4_1.7-18 broom_0.7.12 ## [93] evaluate_0.15 biomformat_1.22.0 stringr_1.4.0 fastmap_1.1.0 ## [97] yaml_2.3.5 knitr_1.37 bit64_4.0.5 robustbase_0.93-9 ## [101] caTools_1.18.2 purrr_0.3.4 KEGGREST_1.34.0 coin_1.4-2 ## [105] nlme_3.1-155 protoclust_1.6.3 RAIDA_1.0 compiler_4.1.2 ## [109] rstudioapi_0.13 png_0.1-7 ggsignif_0.6.3 geneplotter_1.72.0 ## [113] bslib_0.3.1 pcaPP_1.9-74 stringi_1.7.6 highr_0.9 ## [117] Maaslin2_1.8.0 lattice_0.20-45 Matrix_1.4-0 vegan_2.5-7 ## [121] permute_0.9-7 multtest_2.50.0 vctrs_0.3.8 pillar_1.7.0 ## [125] lifecycle_1.0.1 rhdf5filters_1.6.0 optparse_1.7.1 jquerylib_0.1.4 ## [129] data.table_1.14.2 cowplot_1.1.1 bitops_1.0-7 qvalue_2.26.0 ## [133] GenomicRanges_1.46.1 latticeExtra_0.6-29 R6_2.5.1 bookdown_0.24 ## [137] gridExtra_2.3 KernSmooth_2.23-20 IRanges_2.28.0 codetools_0.2-18 ## [141] gtools_3.9.2 MASS_7.3-55 assertthat_0.2.1 Wrench_1.12.0 ## [145] rhdf5_2.38.1 SummarizedExperiment_1.24.0 DESeq2_1.34.0 withr_2.5.0 ## [149] multcomp_1.4-18 S4Vectors_0.32.3 GenomeInfoDbData_1.2.7 mgcv_1.8-39 ## [153] parallel_4.1.2 rpart_4.1.16 grid_4.1.2 tidyr_1.2.0 ## [157] rmarkdown_2.13 MatrixGenerics_1.6.0 carData_3.0-5 base64enc_0.1-3 ## [161] Biobase_2.54.0 "],["data-processing.html", "Chapter 4 Data processing 4.1 Rarefy otu counts 4.2 Extracting specific taxonomic level 4.3 Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 10) 4.4 Trimming the taxa with low occurrence less than threshold 4.5 Systematic Information", " Chapter 4 Data processing Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) This part has too may procedures and we only choose some of them. Please go to XMAS tutorial: Chapter 6 to see more approaches and details for being familiar with this part. 4.1 Rarefy otu counts From previous results of quality evaluation, the sequence depth of samples are different which have effects on the downstream analysis. Here, choosing the rarefy (Normaliztion method: random subsampling counts to the smallest library size) to get the equal sample sums. dada2_ps_rare &lt;- norm_rarefy(dada2_ps_remove_BRS, size = 51181, rng_seed = 123) dada2_ps_rare ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 891 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 891 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 891 tips and 888 internal nodes ] ## refseq() DNAStringSet: [ 891 reference sequences ] In addition, we could also perform some other normalization methods on the rarefied phyloseq object. By the way, we didn’t transform the data by using log algorithm because the count matrix is required by the following data analysis methods. 4.2 Extracting specific taxonomic level dada2_ps_rare_genus &lt;- summarize_taxa(dada2_ps_rare, taxa_level = &quot;Genus&quot;) dada2_ps_rare_genus ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 198 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 198 taxa by 6 taxonomic ranks ] 4.3 Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 10) dada2_ps_rare_genus_filter &lt;- run_filter(dada2_ps_rare_genus, cutoff = 10, unclass = TRUE) dada2_ps_rare_genus_filter ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 149 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 149 taxa by 6 taxonomic ranks ] 4.4 Trimming the taxa with low occurrence less than threshold dada2_ps_rare_genus_filter_trim &lt;- run_trim(dada2_ps_rare_genus_filter, cutoff = 0.2, trim = &quot;feature&quot;) dada2_ps_rare_genus_filter_trim ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 100 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 100 taxa by 6 taxonomic ranks ] Finally, we obtained the final phyloseq-class object dada2_ps_rare_genus_filter_trim and changed its name. 4.5 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] backports_1.4.1 Hmisc_4.6-0 plyr_1.8.6 igraph_1.2.11 ## [5] splines_4.1.2 BiocParallel_1.28.3 GenomeInfoDb_1.30.1 TH.data_1.1-0 ## [9] lpsymphony_1.22.0 digest_0.6.29 foreach_1.5.2 htmltools_0.5.2 ## [13] fansi_1.0.2 checkmate_2.0.0 magrittr_2.0.2 memoise_2.0.1 ## [17] cluster_2.1.2 limma_3.50.1 Biostrings_2.62.0 annotate_1.72.0 ## [21] matrixStats_0.61.0 sandwich_3.0-1 metagenomeSeq_1.36.0 jpeg_0.1-9 ## [25] colorspace_2.0-3 ggrepel_0.9.1 blob_1.2.2 corncob_0.2.0 ## [29] xfun_0.30 crayon_1.5.0 RCurl_1.98-1.6 jsonlite_1.8.0 ## [33] libcoin_1.0-9 genefilter_1.76.0 biglm_0.9-2.1 survival_3.3-1 ## [37] zoo_1.8-9 iterators_1.0.14 ape_5.6-2 glue_1.6.2 ## [41] gtable_0.3.0 zlibbioc_1.40.0 XVector_0.34.0 DelayedArray_0.20.0 ## [45] car_3.0-12 Rhdf5lib_1.16.0 shape_1.4.6 BiocGenerics_0.40.0 ## [49] DEoptimR_1.0-10 abind_1.4-5 scales_1.1.1 mvtnorm_1.1-3 ## [53] DBI_1.1.2 edgeR_3.36.0 rstatix_0.7.0 Rcpp_1.0.8.2 ## [57] htmlTable_2.4.0 xtable_1.8-4 foreign_0.8-82 bit_4.0.4 ## [61] Formula_1.2-4 stats4_4.1.2 glmnet_4.1-3 htmlwidgets_1.5.4 ## [65] httr_1.4.2 getopt_1.20.3 DiagrammeR_1.0.9 gplots_3.1.1 ## [69] RColorBrewer_1.1-2 modeltools_0.2-23 ellipsis_0.3.2 farver_2.1.0 ## [73] pkgconfig_2.0.3 XML_3.99-0.9 nnet_7.3-17 sass_0.4.0 ## [77] locfit_1.5-9.5 utf8_1.2.2 labeling_0.4.2 tidyselect_1.1.2 ## [81] rlang_1.0.2 reshape2_1.4.4 AnnotationDbi_1.56.2 munsell_0.5.0 ## [85] tools_4.1.2 visNetwork_2.1.0 cachem_1.0.6 cli_3.2.0 ## [89] generics_0.1.2 RSQLite_2.2.10 ade4_1.7-18 broom_0.7.12 ## [93] evaluate_0.15 biomformat_1.22.0 stringr_1.4.0 fastmap_1.1.0 ## [97] yaml_2.3.5 knitr_1.37 bit64_4.0.5 robustbase_0.93-9 ## [101] caTools_1.18.2 purrr_0.3.4 KEGGREST_1.34.0 coin_1.4-2 ## [105] nlme_3.1-155 protoclust_1.6.3 RAIDA_1.0 compiler_4.1.2 ## [109] rstudioapi_0.13 png_0.1-7 ggsignif_0.6.3 geneplotter_1.72.0 ## [113] bslib_0.3.1 pcaPP_1.9-74 stringi_1.7.6 highr_0.9 ## [117] Maaslin2_1.8.0 lattice_0.20-45 Matrix_1.4-0 vegan_2.5-7 ## [121] permute_0.9-7 multtest_2.50.0 vctrs_0.3.8 pillar_1.7.0 ## [125] lifecycle_1.0.1 rhdf5filters_1.6.0 optparse_1.7.1 jquerylib_0.1.4 ## [129] data.table_1.14.2 cowplot_1.1.1 bitops_1.0-7 qvalue_2.26.0 ## [133] GenomicRanges_1.46.1 latticeExtra_0.6-29 R6_2.5.1 bookdown_0.24 ## [137] gridExtra_2.3 KernSmooth_2.23-20 IRanges_2.28.0 codetools_0.2-18 ## [141] gtools_3.9.2 MASS_7.3-55 assertthat_0.2.1 Wrench_1.12.0 ## [145] rhdf5_2.38.1 SummarizedExperiment_1.24.0 DESeq2_1.34.0 withr_2.5.0 ## [149] multcomp_1.4-18 S4Vectors_0.32.3 GenomeInfoDbData_1.2.7 mgcv_1.8-39 ## [153] parallel_4.1.2 rpart_4.1.16 grid_4.1.2 tidyr_1.2.0 ## [157] rmarkdown_2.13 MatrixGenerics_1.6.0 carData_3.0-5 base64enc_0.1-3 ## [161] Biobase_2.54.0 "],["diversity-analysis.html", "Chapter 5 Diversity analysis 5.1 Alpha diveristy 5.2 Beta diversity 5.3 Systematic Information", " Chapter 5 Diversity analysis Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) 5.1 Alpha diveristy Calculate the alpha diversity Notes: the otu table must be counts matrix (rarefied but not trim counts matrix) when you choose Observed etc measures. dada_ps_rare_genus_alpha &lt;- run_alpha_diversity(ps=dada2_ps_rare_genus, measures = c(&quot;Shannon&quot;, &quot;Chao1&quot;, &quot;Observed&quot;)) print(dada_ps_rare_genus_alpha) ## SampleID Group Observed Chao1 se.chao1 Shannon ## 1 S6030 BB 74 74.00000 0.0000000 2.622800 ## 2 S6032 BB 38 38.00000 0.0000000 1.711068 ## 3 S6033 BB 80 80.16667 0.5431879 2.719495 ## 4 S6035 AA 35 35.00000 0.1232013 1.953807 ## 5 S6036 BB 95 95.00000 0.0000000 2.942657 ## 6 S6037 AA 35 35.00000 0.0000000 1.933007 ## 7 S6040 BB 58 58.00000 0.0000000 2.490198 ## 8 S6043 AA 65 65.33333 0.9246628 2.098003 ## 9 S6045 BB 60 60.00000 0.0000000 2.920363 ## 10 S6046 BB 71 71.00000 0.1241166 2.264433 ## 11 S6048 BB 66 66.00000 0.0000000 2.630421 ## 12 S6049 AA 60 60.00000 0.0000000 2.506885 ## 13 S6050 BB 53 53.00000 0.0000000 2.431334 ## 14 S6054 BB 84 84.00000 0.0000000 2.769973 ## 15 S6055 BB 75 75.00000 0.0000000 2.297388 ## 16 S6058 BB 37 37.00000 0.2465985 2.262059 ## 17 S6059 AA 71 71.00000 0.0000000 2.682960 ## 18 S6060 AA 48 48.00000 0.0000000 1.883809 ## 19 S6061 AA 80 80.00000 0.0000000 3.088651 ## 20 S6063 BB 38 38.00000 0.0000000 1.543267 ## 21 S6065 AA 77 77.00000 0.0000000 2.877568 ## 22 S6066 AA 67 67.00000 0.0000000 2.638564 ## 23 S6068 BB 40 40.00000 0.0000000 2.100363 visualization plot_boxplot(data=dada_ps_rare_genus_alpha, y_index = c(&quot;Shannon&quot;, &quot;Chao1&quot;, &quot;Observed&quot;), group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), group_color = c(&quot;red&quot;, &quot;blue&quot;)) Figure 5.1: Alpha diversity (16s example) 5.2 Beta diversity beta dipersion dada2_ps_beta &lt;- run_beta_diversity(ps=dada2_ps_rare_genus_filter_trim, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.01412 0.0141198 1.6675 999 0.201 ## Residuals 21 0.17783 0.0084679 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## AA BB ## AA 0.21 ## BB 0.21063 dada2_ps_beta$BetaDispersion Figure 5.2: Beta diversity (16s example) 5.3 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] backports_1.4.1 Hmisc_4.6-0 plyr_1.8.6 igraph_1.2.11 ## [5] splines_4.1.2 BiocParallel_1.28.3 GenomeInfoDb_1.30.1 TH.data_1.1-0 ## [9] lpsymphony_1.22.0 digest_0.6.29 foreach_1.5.2 htmltools_0.5.2 ## [13] fansi_1.0.2 checkmate_2.0.0 magrittr_2.0.2 memoise_2.0.1 ## [17] cluster_2.1.2 limma_3.50.1 Biostrings_2.62.0 annotate_1.72.0 ## [21] matrixStats_0.61.0 sandwich_3.0-1 metagenomeSeq_1.36.0 jpeg_0.1-9 ## [25] colorspace_2.0-3 ggrepel_0.9.1 blob_1.2.2 corncob_0.2.0 ## [29] xfun_0.30 crayon_1.5.0 RCurl_1.98-1.6 jsonlite_1.8.0 ## [33] libcoin_1.0-9 genefilter_1.76.0 biglm_0.9-2.1 survival_3.3-1 ## [37] zoo_1.8-9 iterators_1.0.14 ape_5.6-2 glue_1.6.2 ## [41] gtable_0.3.0 zlibbioc_1.40.0 XVector_0.34.0 DelayedArray_0.20.0 ## [45] car_3.0-12 Rhdf5lib_1.16.0 shape_1.4.6 BiocGenerics_0.40.0 ## [49] DEoptimR_1.0-10 abind_1.4-5 scales_1.1.1 mvtnorm_1.1-3 ## [53] DBI_1.1.2 edgeR_3.36.0 rstatix_0.7.0 Rcpp_1.0.8.2 ## [57] htmlTable_2.4.0 xtable_1.8-4 foreign_0.8-82 bit_4.0.4 ## [61] Formula_1.2-4 stats4_4.1.2 glmnet_4.1-3 htmlwidgets_1.5.4 ## [65] httr_1.4.2 getopt_1.20.3 DiagrammeR_1.0.9 gplots_3.1.1 ## [69] RColorBrewer_1.1-2 modeltools_0.2-23 ellipsis_0.3.2 farver_2.1.0 ## [73] pkgconfig_2.0.3 XML_3.99-0.9 nnet_7.3-17 sass_0.4.0 ## [77] locfit_1.5-9.5 utf8_1.2.2 labeling_0.4.2 tidyselect_1.1.2 ## [81] rlang_1.0.2 reshape2_1.4.4 AnnotationDbi_1.56.2 munsell_0.5.0 ## [85] tools_4.1.2 visNetwork_2.1.0 cachem_1.0.6 cli_3.2.0 ## [89] generics_0.1.2 RSQLite_2.2.10 ade4_1.7-18 broom_0.7.12 ## [93] evaluate_0.15 biomformat_1.22.0 stringr_1.4.0 fastmap_1.1.0 ## [97] yaml_2.3.5 knitr_1.37 bit64_4.0.5 robustbase_0.93-9 ## [101] caTools_1.18.2 purrr_0.3.4 KEGGREST_1.34.0 coin_1.4-2 ## [105] nlme_3.1-155 protoclust_1.6.3 RAIDA_1.0 compiler_4.1.2 ## [109] rstudioapi_0.13 png_0.1-7 ggsignif_0.6.3 geneplotter_1.72.0 ## [113] bslib_0.3.1 pcaPP_1.9-74 stringi_1.7.6 highr_0.9 ## [117] Maaslin2_1.8.0 lattice_0.20-45 Matrix_1.4-0 vegan_2.5-7 ## [121] permute_0.9-7 multtest_2.50.0 vctrs_0.3.8 pillar_1.7.0 ## [125] lifecycle_1.0.1 rhdf5filters_1.6.0 optparse_1.7.1 jquerylib_0.1.4 ## [129] data.table_1.14.2 cowplot_1.1.1 bitops_1.0-7 qvalue_2.26.0 ## [133] GenomicRanges_1.46.1 latticeExtra_0.6-29 R6_2.5.1 bookdown_0.24 ## [137] gridExtra_2.3 KernSmooth_2.23-20 IRanges_2.28.0 codetools_0.2-18 ## [141] gtools_3.9.2 MASS_7.3-55 assertthat_0.2.1 Wrench_1.12.0 ## [145] rhdf5_2.38.1 SummarizedExperiment_1.24.0 DESeq2_1.34.0 withr_2.5.0 ## [149] multcomp_1.4-18 S4Vectors_0.32.3 GenomeInfoDbData_1.2.7 mgcv_1.8-39 ## [153] parallel_4.1.2 rpart_4.1.16 grid_4.1.2 tidyr_1.2.0 ## [157] rmarkdown_2.13 MatrixGenerics_1.6.0 carData_3.0-5 base64enc_0.1-3 ## [161] Biobase_2.54.0 "],["permanova-beta-dispersion-ordination.html", "Chapter 6 PERMANOVA + beta dispersion + Ordination 6.1 PERMANOVA 6.2 beta dispersion 6.3 Ordination 6.4 Systematic Information", " Chapter 6 PERMANOVA + beta dispersion + Ordination Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) 6.1 PERMANOVA dada2_ps_per &lt;- run_permanova(ps=dada2_ps_rare_genus_filter_trim, method = &quot;bray&quot;, columns = &quot;Group&quot;) print(dada2_ps_per) ## SumsOfSample Df SumsOfSqs MeanSqs F.Model R2 Pr(&gt;F) AdjustedPvalue ## Group 23 1 0.2290643 0.2290643 1.331995 0.05964515 0.225 0.225 The PERMANOVA result of the Group (AdjustedPvalue &gt; 0.05) revealed that the two groups had not the distinct patterns of microbial community. 6.2 beta dispersion beta_df &lt;- run_beta_diversity(ps=dada2_ps_rare_genus_filter_trim, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.01412 0.0141198 1.6675 999 0.201 ## Residuals 21 0.17783 0.0084679 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## AA BB ## AA 0.21 ## BB 0.21063 6.3 Ordination We performed ordination by using Principal Coordinate Analysis (PCoA). If you want to try other methods please go to see Chapter 8 for more details. dada2_ps_ordination &lt;- run_ordination( ps = dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, method = &quot;PCoA&quot;) plot_Ordination(ResultList = dada2_ps_ordination, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), group_color = c(&quot;blue&quot;, &quot;red&quot;)) Figure 6.1: PCoA (16s example) 6.4 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] backports_1.4.1 Hmisc_4.6-0 plyr_1.8.6 igraph_1.2.11 ## [5] splines_4.1.2 BiocParallel_1.28.3 GenomeInfoDb_1.30.1 TH.data_1.1-0 ## [9] lpsymphony_1.22.0 digest_0.6.29 foreach_1.5.2 htmltools_0.5.2 ## [13] fansi_1.0.2 checkmate_2.0.0 magrittr_2.0.2 memoise_2.0.1 ## [17] cluster_2.1.2 limma_3.50.1 Biostrings_2.62.0 annotate_1.72.0 ## [21] matrixStats_0.61.0 sandwich_3.0-1 metagenomeSeq_1.36.0 jpeg_0.1-9 ## [25] colorspace_2.0-3 ggrepel_0.9.1 blob_1.2.2 corncob_0.2.0 ## [29] xfun_0.30 crayon_1.5.0 RCurl_1.98-1.6 jsonlite_1.8.0 ## [33] libcoin_1.0-9 genefilter_1.76.0 biglm_0.9-2.1 survival_3.3-1 ## [37] zoo_1.8-9 iterators_1.0.14 ape_5.6-2 glue_1.6.2 ## [41] gtable_0.3.0 zlibbioc_1.40.0 XVector_0.34.0 DelayedArray_0.20.0 ## [45] car_3.0-12 Rhdf5lib_1.16.0 shape_1.4.6 BiocGenerics_0.40.0 ## [49] DEoptimR_1.0-10 abind_1.4-5 scales_1.1.1 mvtnorm_1.1-3 ## [53] DBI_1.1.2 edgeR_3.36.0 rstatix_0.7.0 Rcpp_1.0.8.2 ## [57] htmlTable_2.4.0 xtable_1.8-4 foreign_0.8-82 bit_4.0.4 ## [61] Formula_1.2-4 stats4_4.1.2 glmnet_4.1-3 htmlwidgets_1.5.4 ## [65] httr_1.4.2 getopt_1.20.3 DiagrammeR_1.0.9 gplots_3.1.1 ## [69] RColorBrewer_1.1-2 modeltools_0.2-23 ellipsis_0.3.2 farver_2.1.0 ## [73] pkgconfig_2.0.3 XML_3.99-0.9 nnet_7.3-17 sass_0.4.0 ## [77] locfit_1.5-9.5 utf8_1.2.2 labeling_0.4.2 tidyselect_1.1.2 ## [81] rlang_1.0.2 reshape2_1.4.4 AnnotationDbi_1.56.2 munsell_0.5.0 ## [85] tools_4.1.2 visNetwork_2.1.0 cachem_1.0.6 cli_3.2.0 ## [89] generics_0.1.2 RSQLite_2.2.10 ade4_1.7-18 broom_0.7.12 ## [93] evaluate_0.15 biomformat_1.22.0 stringr_1.4.0 fastmap_1.1.0 ## [97] yaml_2.3.5 knitr_1.37 bit64_4.0.5 robustbase_0.93-9 ## [101] caTools_1.18.2 purrr_0.3.4 KEGGREST_1.34.0 coin_1.4-2 ## [105] nlme_3.1-155 protoclust_1.6.3 RAIDA_1.0 compiler_4.1.2 ## [109] rstudioapi_0.13 png_0.1-7 ggsignif_0.6.3 geneplotter_1.72.0 ## [113] bslib_0.3.1 pcaPP_1.9-74 stringi_1.7.6 highr_0.9 ## [117] Maaslin2_1.8.0 lattice_0.20-45 Matrix_1.4-0 vegan_2.5-7 ## [121] permute_0.9-7 multtest_2.50.0 vctrs_0.3.8 pillar_1.7.0 ## [125] lifecycle_1.0.1 rhdf5filters_1.6.0 optparse_1.7.1 jquerylib_0.1.4 ## [129] data.table_1.14.2 cowplot_1.1.1 bitops_1.0-7 qvalue_2.26.0 ## [133] GenomicRanges_1.46.1 latticeExtra_0.6-29 R6_2.5.1 bookdown_0.24 ## [137] gridExtra_2.3 KernSmooth_2.23-20 IRanges_2.28.0 codetools_0.2-18 ## [141] gtools_3.9.2 MASS_7.3-55 assertthat_0.2.1 Wrench_1.12.0 ## [145] rhdf5_2.38.1 SummarizedExperiment_1.24.0 DESeq2_1.34.0 withr_2.5.0 ## [149] multcomp_1.4-18 S4Vectors_0.32.3 GenomeInfoDbData_1.2.7 mgcv_1.8-39 ## [153] parallel_4.1.2 rpart_4.1.16 grid_4.1.2 tidyr_1.2.0 ## [157] rmarkdown_2.13 MatrixGenerics_1.6.0 carData_3.0-5 base64enc_0.1-3 ## [161] Biobase_2.54.0 "],["microbial-composition.html", "Chapter 7 Microbial composition 7.1 Stacked barplot 7.2 Core microbiota 7.3 Systematic Information", " Chapter 7 Microbial composition Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) A whole picture of the microbial composition. 7.1 Stacked barplot XMAS package plot_StackBarPlot( ps=dada2_ps_rare, taxa_level=&quot;Phylum&quot;, group = &quot;Group&quot;, cluster = TRUE) Figure 7.1: Microbial composition (16s example) XVIZ package plot_stacked_bar_XIVZ( phyloseq = dada2_ps_rare, level = &quot;Phylum&quot;, feature = &quot;Group&quot;) Figure 7.2: Microbial composition (16s example) XVIZ 7.2 Core microbiota convert absolute abundance into relative abundance dada2_ps_rare_genus_filter_trim_rb &lt;- normalize(dada2_ps_rare_genus_filter_trim, method = &quot;TSS&quot;) dada2_ps_rare_genus_filter_trim_rb ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 100 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 100 taxa by 6 taxonomic ranks ] visualization prevalences &lt;- seq(0.05, 1, 0.05) detections &lt;- 10^seq(log10(1e-3), log10(0.2), length = 10) pl_core &lt;- plot_core_taxa(dada2_ps_rare_genus_filter_trim_rb, plot.type = &quot;heatmap&quot;, colours = gray(seq(0, 1, length=5)), prevalences = prevalences, detections = detections, min.prevalence = 0.5)+ xlab(&quot;Detection Threshold (Relative Abundance (%))&quot;) pl_core Figure 7.3: Core taxa (16s example) The degree of color indicates the size of abundance and prevalence. Use core_members to obtain the core taxa. detection for abundance and prevalence for occurrence. core_taxa_name &lt;- core_members(dada2_ps_rare_genus_filter_trim_rb, detection = 0.01, prevalence = 0.8) print(core_taxa_name) ## [1] &quot;g__Bifidobacterium&quot; &quot;g__Blautia&quot; Result: Only 2 genera (g__Bifidobacterium and g__Blautia) passed the threshold of detection and prevalence which we choose. 7.3 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] backports_1.4.1 Hmisc_4.6-0 plyr_1.8.6 igraph_1.2.11 ## [5] splines_4.1.2 BiocParallel_1.28.3 GenomeInfoDb_1.30.1 TH.data_1.1-0 ## [9] lpsymphony_1.22.0 digest_0.6.29 foreach_1.5.2 htmltools_0.5.2 ## [13] fansi_1.0.2 checkmate_2.0.0 magrittr_2.0.2 memoise_2.0.1 ## [17] cluster_2.1.2 limma_3.50.1 Biostrings_2.62.0 annotate_1.72.0 ## [21] matrixStats_0.61.0 sandwich_3.0-1 metagenomeSeq_1.36.0 jpeg_0.1-9 ## [25] colorspace_2.0-3 ggrepel_0.9.1 blob_1.2.2 corncob_0.2.0 ## [29] xfun_0.30 crayon_1.5.0 RCurl_1.98-1.6 jsonlite_1.8.0 ## [33] libcoin_1.0-9 genefilter_1.76.0 biglm_0.9-2.1 survival_3.3-1 ## [37] zoo_1.8-9 iterators_1.0.14 ape_5.6-2 glue_1.6.2 ## [41] gtable_0.3.0 zlibbioc_1.40.0 XVector_0.34.0 DelayedArray_0.20.0 ## [45] car_3.0-12 Rhdf5lib_1.16.0 shape_1.4.6 BiocGenerics_0.40.0 ## [49] DEoptimR_1.0-10 abind_1.4-5 scales_1.1.1 mvtnorm_1.1-3 ## [53] DBI_1.1.2 edgeR_3.36.0 rstatix_0.7.0 Rcpp_1.0.8.2 ## [57] htmlTable_2.4.0 xtable_1.8-4 foreign_0.8-82 bit_4.0.4 ## [61] Formula_1.2-4 stats4_4.1.2 glmnet_4.1-3 htmlwidgets_1.5.4 ## [65] httr_1.4.2 getopt_1.20.3 DiagrammeR_1.0.9 gplots_3.1.1 ## [69] RColorBrewer_1.1-2 modeltools_0.2-23 ellipsis_0.3.2 farver_2.1.0 ## [73] pkgconfig_2.0.3 XML_3.99-0.9 nnet_7.3-17 sass_0.4.0 ## [77] locfit_1.5-9.5 utf8_1.2.2 labeling_0.4.2 tidyselect_1.1.2 ## [81] rlang_1.0.2 reshape2_1.4.4 AnnotationDbi_1.56.2 munsell_0.5.0 ## [85] tools_4.1.2 visNetwork_2.1.0 cachem_1.0.6 cli_3.2.0 ## [89] generics_0.1.2 RSQLite_2.2.10 ade4_1.7-18 broom_0.7.12 ## [93] evaluate_0.15 biomformat_1.22.0 stringr_1.4.0 fastmap_1.1.0 ## [97] yaml_2.3.5 knitr_1.37 bit64_4.0.5 robustbase_0.93-9 ## [101] caTools_1.18.2 purrr_0.3.4 KEGGREST_1.34.0 coin_1.4-2 ## [105] nlme_3.1-155 protoclust_1.6.3 RAIDA_1.0 compiler_4.1.2 ## [109] rstudioapi_0.13 png_0.1-7 ggsignif_0.6.3 geneplotter_1.72.0 ## [113] bslib_0.3.1 pcaPP_1.9-74 stringi_1.7.6 highr_0.9 ## [117] Maaslin2_1.8.0 lattice_0.20-45 Matrix_1.4-0 vegan_2.5-7 ## [121] permute_0.9-7 multtest_2.50.0 vctrs_0.3.8 pillar_1.7.0 ## [125] lifecycle_1.0.1 rhdf5filters_1.6.0 optparse_1.7.1 jquerylib_0.1.4 ## [129] data.table_1.14.2 cowplot_1.1.1 bitops_1.0-7 qvalue_2.26.0 ## [133] GenomicRanges_1.46.1 latticeExtra_0.6-29 R6_2.5.1 bookdown_0.24 ## [137] gridExtra_2.3 KernSmooth_2.23-20 IRanges_2.28.0 codetools_0.2-18 ## [141] gtools_3.9.2 MASS_7.3-55 assertthat_0.2.1 Wrench_1.12.0 ## [145] rhdf5_2.38.1 SummarizedExperiment_1.24.0 DESeq2_1.34.0 withr_2.5.0 ## [149] multcomp_1.4-18 S4Vectors_0.32.3 GenomeInfoDbData_1.2.7 mgcv_1.8-39 ## [153] parallel_4.1.2 rpart_4.1.16 grid_4.1.2 tidyr_1.2.0 ## [157] rmarkdown_2.13 MatrixGenerics_1.6.0 carData_3.0-5 base64enc_0.1-3 ## [161] Biobase_2.54.0 "],["differential-analysis.html", "Chapter 8 Differential Analysis 8.1 Liner discriminant analysis (LDA) effect size (LEfSe) 8.2 Wilcoxon Rank-Sum test 8.3 Dominant taxa 8.4 Multiple differential analysis by one function 8.5 Systematic Information", " Chapter 8 Differential Analysis Loading packages library(XMAS) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) There are more than 10 approaches to perform differential analysis. Here, we choose two of them and recommend users going to Chapter 10 to see more detials. 8.1 Liner discriminant analysis (LDA) effect size (LEfSe) Calculation dada2_ps_lefse &lt;- run_lefse( dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), Lda = 1) head(dada2_ps_lefse) ## TaxaID Block Enrichment LDA_Score EffectSize Log2FoldChange (Median)\\nAA_vs_BB Median Abundance\\n(All) ## 1 g__Parasutterella 9_AA vs 14_BB AA -3.679337 1.668801 4.402050 172.77125 ## 2 g__Ruminococcaceae_UCG_004 9_AA vs 14_BB AA -2.467155 1.593295 NA 241.24923 ## 3 g__Odoribacter 9_AA vs 14_BB BB 2.720655 1.317365 NA 21.93175 ## 4 g__Romboutsia 9_AA vs 14_BB BB 3.750779 3.016968 -6.856424 2189.79596 ## 5 g__Lactobacillus 9_AA vs 14_BB BB 4.075009 2.628616 -3.336128 1283.85401 ## Median Abundance\\nAA Median Abundance\\nBB Log2FoldChange (Mean)\\nAA_vs_BB Mean Abundance\\n(All) Mean Abundance\\nAA Mean Abundance\\nBB ## 1 1080.35695 51.09966 4.481148 3901.0977 9320.3061 417.3209 ## 2 2451.90494 0.00000 2.342928 1443.2092 2822.7139 556.3847 ## 3 604.99989 0.00000 2.099583 578.0758 1083.9017 252.9020 ## 4 50.35627 5835.02623 -3.334490 7094.1306 1086.1419 10956.4090 ## 5 520.46061 5256.08763 -5.173067 19938.7655 892.0297 32183.0957 ## Occurrence (100%)\\n(All) Occurrence (100%)\\nAA Occurrence (100%)\\nBB Odds Ratio (95% CI) ## 1 65.22 88.89 50.00 0.0025 (-12;12) ## 2 52.17 77.78 35.71 0.14 (-3.7;4) ## 3 52.17 77.78 35.71 0.31 (-2;2.6) ## 4 78.26 55.56 92.86 76 (85;68) ## 5 86.96 77.78 92.86 1.1e+08 (1.1e+08;1.1e+08) Visualization plot_lefse( da_res = dada2_ps_lefse, x_index = &quot;LDA_Score&quot;, x_index_cutoff = 1, group_color = c(&quot;green&quot;, &quot;red&quot;)) Figure 8.1: Lefse analysis (16s example) 8.2 Wilcoxon Rank-Sum test Calculation dada2_ps_wilcox &lt;- run_wilcox( dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;)) head(dada2_ps_wilcox) ## TaxaID Block Enrichment EffectSize Statistic Pvalue AdjustedPvalue Log2FoldChange (Median)\\nAA_vs_BB ## 1 g__Actinomyces 9_AA vs 14_BB Nonsignif 39.65079 44.5 0.2556616 0.7114368 -0.9577718 ## 2 g__Adlercreutzia 9_AA vs 14_BB Nonsignif 23.17460 44.0 0.1980169 0.7114368 NA ## 3 g__Agathobacter 9_AA vs 14_BB Nonsignif 1222.58730 71.0 0.6293971 0.9106171 0.1524904 ## 4 g__Alistipes 9_AA vs 14_BB Nonsignif 23.03175 67.0 0.8239942 0.9286981 -0.1085245 ## 5 g__Anaerostipes 9_AA vs 14_BB Nonsignif 60.25397 57.0 0.7343041 0.9167109 0.9551297 ## 6 g__Bacteroides 9_AA vs 14_BB Nonsignif 4064.23016 89.0 0.1093014 0.7114368 1.5367266 ## Median Abundance\\n(All) Median Abundance\\nAA Median Abundance\\nBB Log2FoldChange (Rank)\\nAA_vs_BB Mean Rank Abundance\\nAA ## 1 30 26 50.5 -0.42227633 9.94 ## 2 0 0 9.0 -0.43387758 9.89 ## 3 316 329 296.0 0.17342686 12.89 ## 4 64 64 69.0 0.08724541 12.44 ## 5 537 918 473.5 -0.13367844 11.33 ## 6 3807 9103 3137.5 0.55428610 14.89 ## Mean Rank Abundance\\nBB Occurrence (100%)\\n(All) Occurrence (100%)\\nAA Occurrence (100%)\\nBB Odds Ratio (95% CI) ## 1 13.32 82.61 88.89 78.57 4.1 (6.8;1.3) ## 2 13.36 43.48 33.33 50.00 8.6 (13;4.3) ## 3 11.43 65.22 55.56 71.43 0.39 (-1.4;2.2) ## 4 11.71 73.91 77.78 71.43 0.88 (0.64;1.1) ## 5 12.43 95.65 100.00 92.86 1.1 (1.2;0.93) ## 6 10.14 100.00 100.00 100.00 0.45 (-1.1;2) Volcano plot_volcano( dada2_ps_wilcox, group_names = c(&quot;AA&quot;, &quot;BB&quot;), x_index = &quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, group_color = c(&quot;red&quot;, &quot;grey&quot;, &quot;blue&quot;), topN = 5) Figure 8.2: Wilcoxon Rank-Sum test (16s example) 8.3 Dominant taxa Display the significant taxa with selection using boxplot. plot_topN_boxplot( ps = dada2_ps_rare_genus_filter_trim, da_res = dada2_ps_wilcox, x_index = &quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, topN = 5, group = &quot;Group&quot;) Figure 8.3: Dominant Taxa 8.4 Multiple differential analysis by one function here, we provide the run_multiple_da for obtaining the results list from multiple differential analysis methods. multiple_res &lt;- run_multiple_da( dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), da_method = c(&quot;aldex&quot;, &quot;limma_voom&quot;, &quot;mbzinb&quot;, &quot;omnibus&quot;)) ## Start GMPR normalization ... ## Start Winsorization ... ## Perform filtering ... ## --A total of 68 taxa will be tested with a sample size of 23 ! ## --Omnibus test is selected! ## --Dispersion is treated as a parameter of interest! ## Start testing ... ## 10 % ## 20 % ## 30 % ## 40 % ## 50 % ## 60 % ## 70 % ## 80 % ## 90 % ## 100%! ## Handle failed taxa using permutation test! ## Permutation test .... ## Completed! names(multiple_res) ## [1] &quot;aldex&quot; &quot;limma_voom&quot; &quot;mbzinb&quot; &quot;omnibus&quot; plot results plot_multiple_DA( Multip_DA_res = multiple_res, x_index_list = c(&quot;EffectSize&quot;, &quot;logFC&quot;, &quot;mean.LFC&quot;, &quot;abund.LFC.CompvarBB.est&quot;), x_index_cutoff = 1, y_index = &quot;AdjustedPvalue&quot;, y_index_cutoff = 0.5, cellwidth = 50, cellheight = 15, fontsize_number = 15) Figure 8.4: Multiple DA results 8.5 Systematic Information sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Monterey 12.2.1 ## ## Matrix products: default ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] ggpubr_0.4.0 ggplot2_3.3.5 phyloseq_1.38.0 tibble_3.1.6 dplyr_1.0.8 XMAS_2.1.1 ## ## loaded via a namespace (and not attached): ## [1] utf8_1.2.2 tidyselect_1.1.2 RSQLite_2.2.10 AnnotationDbi_1.56.2 ## [5] htmlwidgets_1.5.4 grid_4.1.2 BiocParallel_1.28.3 munsell_0.5.0 ## [9] codetools_0.2-18 withr_2.5.0 colorspace_2.0-3 Biobase_2.54.0 ## [13] highr_0.9 knitr_1.37 rstudioapi_0.13 pscl_1.5.5 ## [17] stats4_4.1.2 robustbase_0.93-9 ggsignif_0.6.3 MatrixGenerics_1.6.0 ## [21] labeling_0.4.2 optparse_1.7.1 mbzinb_0.2 GenomeInfoDbData_1.2.7 ## [25] lpsymphony_1.22.0 pheatmap_1.0.12 bit64_4.0.5 farver_2.1.0 ## [29] rhdf5_2.38.1 vctrs_0.3.8 generics_0.1.2 TH.data_1.1-0 ## [33] xfun_0.30 Maaslin2_1.8.0 R6_2.5.1 GenomeInfoDb_1.30.1 ## [37] locfit_1.5-9.5 RcppZiggurat_0.1.6 bitops_1.0-7 rhdf5filters_1.6.0 ## [41] cachem_1.0.6 DelayedArray_0.20.0 assertthat_0.2.1 scales_1.1.1 ## [45] multcomp_1.4-18 nnet_7.3-17 gtable_0.3.0 sandwich_3.0-1 ## [49] rlang_1.0.2 genefilter_1.76.0 splines_4.1.2 protoclust_1.6.3 ## [53] rstatix_0.7.0 broom_0.7.12 checkmate_2.0.0 yaml_2.3.5 ## [57] reshape2_1.4.4 abind_1.4-5 backports_1.4.1 Rfast_2.0.6 ## [61] qvalue_2.26.0 Hmisc_4.6-0 DiagrammeR_1.0.9 tools_4.1.2 ## [65] bookdown_0.24 zCompositions_1.4.0 ellipsis_0.3.2 gplots_3.1.1 ## [69] jquerylib_0.1.4 biomformat_1.22.0 RColorBrewer_1.1-2 BiocGenerics_0.40.0 ## [73] Rcpp_1.0.8.2 plyr_1.8.6 base64enc_0.1-3 visNetwork_2.1.0 ## [77] zlibbioc_1.40.0 purrr_0.3.4 RCurl_1.98-1.6 rpart_4.1.16 ## [81] Wrench_1.12.0 cowplot_1.1.1 S4Vectors_0.32.3 zoo_1.8-9 ## [85] SummarizedExperiment_1.24.0 ggrepel_0.9.1 cluster_2.1.2 magrittr_2.0.2 ## [89] data.table_1.14.2 truncnorm_1.0-8 mvtnorm_1.1-3 matrixStats_0.61.0 ## [93] ALDEx2_1.26.0 corncob_0.2.0 RAIDA_1.0 evaluate_0.15 ## [97] xtable_1.8-4 XML_3.99-0.9 jpeg_0.1-9 IRanges_2.28.0 ## [101] gridExtra_2.3 shape_1.4.6 compiler_4.1.2 KernSmooth_2.23-20 ## [105] crayon_1.5.0 htmltools_0.5.2 mgcv_1.8-39 pcaPP_1.9-74 ## [109] Formula_1.2-4 tidyr_1.2.0 geneplotter_1.72.0 libcoin_1.0-9 ## [113] DBI_1.1.2 biglm_0.9-2.1 MASS_7.3-55 Matrix_1.4-0 ## [117] ade4_1.7-18 getopt_1.20.3 car_3.0-12 permute_0.9-7 ## [121] cli_3.2.0 parallel_4.1.2 igraph_1.2.11 GenomicRanges_1.46.1 ## [125] pkgconfig_2.0.3 coin_1.4-2 foreign_0.8-82 foreach_1.5.2 ## [129] annotate_1.72.0 bslib_0.3.1 multtest_2.50.0 XVector_0.34.0 ## [133] NADA_1.6-1.1 stringr_1.4.0 digest_0.6.29 vegan_2.5-7 ## [137] Biostrings_2.62.0 rmarkdown_2.13 htmlTable_2.4.0 edgeR_3.36.0 ## [141] gtools_3.9.2 modeltools_0.2-23 lifecycle_1.0.1 nlme_3.1-155 ## [145] jsonlite_1.8.0 Rhdf5lib_1.16.0 carData_3.0-5 limma_3.50.1 ## [149] fansi_1.0.2 pillar_1.7.0 lattice_0.20-45 KEGGREST_1.34.0 ## [153] fastmap_1.1.0 httr_1.4.2 DEoptimR_1.0-10 survival_3.3-1 ## [157] glue_1.6.2 png_0.1-7 iterators_1.0.14 glmnet_4.1-3 ## [161] bit_4.0.4 stringi_1.7.6 sass_0.4.0 metagenomeSeq_1.36.0 ## [165] blob_1.2.2 DESeq2_1.34.0 latticeExtra_0.6-29 caTools_1.18.2 ## [169] memoise_2.0.1 ape_5.6-2 "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
