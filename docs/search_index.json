[["index.html", "16s microbiota data analysis based on XMAS package Chapter 1 Prerequisites 1.1 Preparing for the tutorial 1.2 Workflow description", " 16s microbiota data analysis based on XMAS package Hua Zou 2022-08-09 Chapter 1 Prerequisites Here, we give users one example to practice the 16s microbiota data analysis workflow by XMAS 2.0. By the way, we also recommend users handling your own microbiota data in a reasonable manner when you utilize this package or workflow. Pay attention to whether your data fit the methods this package provided. 1.1 Preparing for the tutorial This tutorial requires that the users should have basic knowledge on R language and statistics. If you are new to microbial research, we recommend the Statistical Analysis of Microbiome Data with R (Xia et al. 2018) as guide book. We suggest users using local laptop because our own server have not deployed XMAS 2.0 package yet. In addition, installing the following software before using XMAS 2.0. R 3.6.3 or later release Download link. Rstudio Desktop Download link. 1.2 Workflow description The standard data analysis of 16S and MGS data by XMAS 2.0. The upstream process is performed by in-house pipeline. and this example just shows how to perform downstream data analysis. In briefly, the example comprises the following steps: Converting inputs into phyloseq object; Quality Evaluation; Pre-Processing Data; Diversity analysis; Ordination analysis; Composition analysis; Differential analysis. Figure 1.1: Functions of XMAS 2.0 References "],["convert-inputdata-into-phyloseq-object.html", "Chapter 2 Convert inputdata into phyloseq object 2.1 DADA2 2.2 Summarize phyloseq-class object 2.3 Systematic Information", " Chapter 2 Convert inputdata into phyloseq object r Biocpkg(“phyloseq”) (McMurdie and Holmes 2013) is the most popular Biocondcutor package used by the microbiome research field, and phyloseq-class objects are a great data-standard for microbiota data in R. Therefore, the core functions in XMAS take phyloseq-class object as input. In the phyloseq object, information on OTU abundances, taxonomy of OTUs, the phylogenetic tree and metadata is stored. This tutorial will introduce you the basic steps to convert results from the in-house pipeline into phyloseq-class object. More importantly on how to look at your data and filter appropriately. We will use the inputs from /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/. Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) 2.1 DADA2 dada2 results from standardized_analytics_workflow_R_function 2.1.1 Importing results from dada2 pipeline /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/process/xdada2/dada2_res.rds /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/process/fasta2tree/tree.nwk /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/16S/metadata.txt dada2_res &lt;- readRDS( system.file( &quot;extdata&quot;, &quot;dada2_res.rds&quot;, package = &quot;XMAS2&quot; ) ) sam_tab &lt;- read.table( system.file( &quot;extdata&quot;, &quot;dada2_metadata.tsv&quot;, package = &quot;XMAS2&quot; ), sep = &quot;\\t&quot;, header = TRUE, stringsAsFactors = FALSE ) tree &lt;- phyloseq::read_tree( system.file( &quot;extdata&quot;, &quot;tree.nwk&quot;, package = &quot;XMAS2&quot; ) ) 2.1.2 taxa table We use import_dada2_taxa to convert dada2_res$tax_tab into our own taxa table tax_tab &lt;- import_dada2_taxa(dada2_taxa = dada2_res$tax_tab) head(tax_tab, 1) ## Kingdom ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;k__Bacteria&quot; ## Phylum ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;p__Firmicutes&quot; ## Class ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;c__Clostridia&quot; ## Order ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;o__Clostridiales&quot; ## Family ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;f__Lachnospiraceae&quot; ## Genus ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;g__Blautia&quot; ## Species ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG &quot;s__Blautia_unclassified&quot; 2.1.3 otu table otu_tab &lt;- dada2_res$seq_tab # Shouldn&#39;t use the Total Number as SampleID (wrong: 123456; right: X123456) rownames(otu_tab) &lt;- paste0(&quot;S&quot;, rownames(otu_tab)) head(otu_tab[, 1, F]) ## TAATACGTAGGGGGCAAGCGTTATCCGGATTTACTGGGTGTAAAGGGAGCGTAGACGGTGTGGCAAGTCTGATGTGAAAGGCATGGGCTCAACCTGTGGACTGCATTGGAAACTGTCATACTTGAGTGCCGGAGGGGTAAGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAGGAACACCAGTGGCGAAGGCGGCTTACTGGACGGTAACTGACGTTGAGGCTCGAAAGCGTGGGGAGCAAACAGG ## S6030 1253 ## S6032 14677 ## S6033 2929 ## S6035 0 ## S6036 3548 ## S6037 8484 2.1.4 metadata table sam_tab &lt;- sam_tab %&gt;% tibble::column_to_rownames(&quot;seqID&quot;) # Shouldn&#39;t use the Total Number as SampleID (wrong: 123456; right: X123456) rownames(sam_tab) &lt;- paste0(&quot;S&quot;, rownames(sam_tab)) head(sam_tab) ## Group ## S6065 AA ## S6049 AA ## S6043 AA ## S6037 AA ## S6059 AA ## S6060 AA 2.1.5 phyloseq object dada2_ps &lt;- get_dada2_phyloseq( seq_tab = otu_tab, tax_tab = tax_tab, sam_tab = sam_tab, phy_tree = tree) dada2_ps ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 896 taxa and 24 samples ] ## sample_data() Sample Data: [ 24 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 896 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 896 tips and 893 internal nodes ] ## refseq() DNAStringSet: [ 896 reference sequences ] we obtain the phyloseq-class object and then use it to perform data analysis. Here, the phyloseq object comprises five components (OTU Table, Sample Data, Taxonomy Table, Phylogenetic Tree and DNAStringSet). otu_table dada2_ps@otu_table %&gt;% data.frame() %&gt;% head() ## S6030 S6032 S6033 S6035 S6036 S6037 S6040 S6043 S6045 S6046 S6048 S6049 S6050 S6054 S6055 S6058 S6059 S6060 S6061 S6063 ## ASV_1 1253 14677 2929 0 3548 8484 11727 5218 4942 7347 3503 3803 14593 4275 2812 0 6847 17893 2956 3328 ## ASV_2 2810 1558 1839 11885 0 5632 631 7326 1809 4781 3476 108 3100 39 3879 6389 298 4995 196 45061 ## ASV_3 7107 2915 2200 0 1232 19675 0 1617 839 9362 4815 0 0 1121 13472 0 1421 0 0 0 ## ASV_4 0 2280 94 13775 0 4456 937 746 3730 273 85 64 562 448 18 611 96 5976 0 837 ## ASV_5 6983 15963 1172 256 12140 874 1722 120 210 0 111 802 994 1971 18 517 808 443 48 109 ## ASV_6 489 0 199 0 836 0 8565 0 0 1257 0 5998 0 3093 2091 0 10572 0 8495 0 ## S6065 S6066 S6068 S8005 ## ASV_1 6302 8414 0 0 ## ASV_2 542 357 10870 7325 ## ASV_3 9694 4387 0 14797 ## ASV_4 0 706 17977 0 ## ASV_5 7 122 546 2516 ## ASV_6 2703 0 0 974 tax_table dada2_ps@tax_table %&gt;% data.frame() %&gt;% head() ## Kingdom Phylum Class Order Family ## ASV_1 k__Bacteria p__Firmicutes c__Clostridia o__Clostridiales f__Lachnospiraceae ## ASV_2 k__Bacteria p__Actinobacteria c__Actinobacteria o__Bifidobacteriales f__Bifidobacteriaceae ## ASV_3 k__Bacteria p__Actinobacteria c__Actinobacteria o__Bifidobacteriales f__Bifidobacteriaceae ## ASV_4 k__Bacteria p__Firmicutes c__Clostridia o__Clostridiales f__Lachnospiraceae ## ASV_5 k__Bacteria p__Firmicutes c__Bacilli o__Lactobacillales f__Streptococcaceae ## ASV_6 k__Bacteria p__Firmicutes c__Clostridia o__Clostridiales f__Ruminococcaceae ## Genus Species ## ASV_1 g__Blautia s__Blautia_unclassified ## ASV_2 g__Bifidobacterium s__Bifidobacterium_unclassified ## ASV_3 g__Bifidobacterium s__Bifidobacterium_unclassified ## ASV_4 g__Lachnospiraceae_unclassified s__Lachnospiraceae_unclassified ## ASV_5 g__Streptococcus s__Streptococcus_unclassified ## ASV_6 g__Faecalibacterium s__Faecalibacterium_unclassified sample_table dada2_ps@sam_data %&gt;% data.frame() %&gt;% head() ## Group ## S6030 BB ## S6032 BB ## S6033 BB ## S6035 AA ## S6036 BB ## S6037 AA 2.2 Summarize phyloseq-class object summarize_phyloseq(ps = dada2_ps) ## Compositional = NO2 ## 1] Min. number of reads = 511812] Max. number of reads = 936223] Total number of reads = 15025374] Average number of reads = 62605.70833333335] Median number of reads = 619157] Sparsity = 0.8653738839285716] Any OTU sum to 1 or less? NO8] Number of singletons = 09] Percent of OTUs that are singletons ## (i.e. exactly one read detected across all samples)010] Number of sample variables are: 1Group2 ## [[1]] ## [1] &quot;1] Min. number of reads = 51181&quot; ## ## [[2]] ## [1] &quot;2] Max. number of reads = 93622&quot; ## ## [[3]] ## [1] &quot;3] Total number of reads = 1502537&quot; ## ## [[4]] ## [1] &quot;4] Average number of reads = 62605.7083333333&quot; ## ## [[5]] ## [1] &quot;5] Median number of reads = 61915&quot; ## ## [[6]] ## [1] &quot;7] Sparsity = 0.865373883928571&quot; ## ## [[7]] ## [1] &quot;6] Any OTU sum to 1 or less? NO&quot; ## ## [[8]] ## [1] &quot;8] Number of singletons = 0&quot; ## ## [[9]] ## [1] &quot;9] Percent of OTUs that are singletons\\n (i.e. exactly one read detected across all samples)0&quot; ## ## [[10]] ## [1] &quot;10] Number of sample variables are: 1&quot; ## ## [[11]] ## [1] &quot;Group&quot; The minus account of the OTU counts is 51181 in the phyloseq object, and we can use it as the threshold to rarefy. Notice the Sparsity (0.865), indicating the data has many zeros and pay attention to the downstream data analysis. A common property of amplicon based microbiota data generated by sequencing. 2.3 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── References "],["quality-control.html", "Chapter 3 Quality Control 3.1 Reads’ track by DADA2 3.2 Spike-in sample (BRS) assessment 3.3 Spike-in sample’s (BRS) remove 3.4 Rarefaction curves 3.5 Summarize phyloseq-class object 3.6 Systematic Information", " Chapter 3 Quality Control Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) Quality control of DADA2 results will help us have more rational determinations on the further data analysis. 3.1 Reads’ track by DADA2 plot_Dada2Track(data = dada2_res$reads_track) Figure 3.1: Reads’ track by DADA2 The percentage of the final remained read counts approximate 70%, indicating that we should consider the sequence depth for analysis when we build the sequence library. 3.2 Spike-in sample (BRS) assessment The taxonomic levels of spike-in sample’s bacteria is genus. Firstly, using the summarize_taxa to get the genus level phyloseq object and get the BRS_ID. dada2_ps_genus &lt;- summarize_taxa(ps = dada2_ps, taxa_level = &quot;Genus&quot;) dada2_ps_genus@sam_data ## Group ## S6030 BB ## S6032 BB ## S6033 BB ## S6035 AA ## S6036 BB ## S6037 AA ## S6040 BB ## S6043 AA ## S6045 BB ## S6046 BB ## S6048 BB ## S6049 AA ## S6050 BB ## S6054 BB ## S6055 BB ## S6058 BB ## S6059 AA ## S6060 AA ## S6061 AA ## S6063 BB ## S6065 AA ## S6066 AA ## S6068 BB ## S8005 QC do run_RefCheck under the optimal parameters. BRS_ID: the ID of BRS sample; Reference: the directory of the latest spike-in sample matrix (default: /share/projects/Analytics/analytics/XMAS/RefCheck/); Save: the directory to save the latest spike-in sample matrix (default: /share/projects/Analytics/analytics/XMAS/RefCheck/). To see more details to use ?run_RefCheck. run_RefCheck( ps = dada2_ps_genus, BRS_ID = &quot;S8005&quot;, Ref_type = &quot;16s&quot;) ## Noting: the Reference Matrix is for 16s ## S8005 is in the Reference Matrix&#39;s samples and remove it to run ## ## ############Matched baterica of the BRS sample############# ## The number of BRS&#39; bacteria matched the Reference Matrix is [15] ## g__Bifidobacterium ## g__Bacteroides ## g__Faecalibacterium ## g__Lactobacillus ## g__Parabacteroides ## g__Collinsella ## g__Coprococcus_3 ## g__Dorea ## g__Streptococcus ## g__Roseburia ## g__Anaerostipes ## g__Escherichia_Shigella ## g__Enterococcus ## g__Prevotella_9 ## g__Eggerthella ## ## The number of the additional bacteria compared to Reference Matrix is [1] ## ########################################################### ## ## ##################Status of the BRS sample################## ## Whether the BRS has the all bateria of Reference Matrix: TRUE ## Correlation Coefficient of the BRS is: 0.9714 ## Bray Curtis of the BRS is: 0.07607 ## Impurity of the BRS is: 0.06409 ## ########################################################### ## #####Final Evaluation Results of the BRS ####### ## The BRS of sequencing dataset passed the cutoff of the Reference Matrix ## Cutoff of Coefficient is 0.8946 ## Cutoff of BrayCurtis is 0.3878 ## Cutoff of Impurity is 0.1565 ## ########################################################### ## 8002 8003 8004 8006 8007 8008 8009 8005 ## Bifidobacterium 31.11079015 30.88310969 32.31232692 18.4930259 20.20409870 17.96225391 18.03588291 27.22437034 ## Bacteroides 20.44753484 14.46581958 24.57151411 26.7370147 25.85863655 27.51353663 26.99272343 24.23896093 ## Faecalibacterium 0.79850615 0.62937893 1.05531023 1.7487249 1.64282727 1.96346413 1.81219797 1.04035376 ## Lactobacillus 2.61732573 3.36856272 3.44379163 5.9292703 5.78000836 5.78189064 6.32672332 3.87088505 ## Parabacteroides 7.11124408 7.45952579 5.36075144 8.7149995 8.01840234 8.74899584 8.62634005 5.61833757 ## Collinsella 0.12792605 0.88271385 0.55665744 1.2764130 0.67921372 1.89356397 1.26367828 0.45502126 ## Coprococcus_3 1.00380683 0.97969362 0.80270938 1.6693557 1.56419908 1.67969035 1.71221463 0.87586251 ## Dorea 2.80715148 3.45564660 2.46613277 3.9684605 3.99163530 3.81529666 3.69382881 2.34880690 ## Streptococcus 2.91960260 3.43387563 2.59149764 3.4818362 3.31409452 3.51378702 3.37721491 2.68740253 ## Roseburia 0.03404484 0.04750030 0.02806676 0.0338295 0.03178586 0.02503886 0.02499583 0.03311188 ## Anaerostipes 0.32291011 0.43245062 0.31528329 0.5386697 0.44500209 0.53416240 0.48047548 0.32471000 ## Escherichia_Shigella 15.27581475 16.00265210 12.36527954 10.8423545 13.43203680 10.15743185 11.59945565 14.03516268 ## Enterococcus 14.51444842 14.66472707 11.04239952 13.1674820 12.07360937 12.88771113 12.84924735 11.61906390 ## Prevotella_9 0.77374627 3.07465463 2.75709154 2.9145415 2.52446675 3.04952478 2.84952508 5.40257632 ## Eggerthella 0.04951976 0.15437596 0.27131203 0.4840221 0.43998327 0.47365181 0.35549631 0.16128688 ## Impurity_level 0.08562792 0.06531291 0.05987576 0.0000000 0.00000000 0.00000000 0.00000000 0.06409000 ## mean ## Bifidobacterium 24.52823232 ## Bacteroides 23.85321759 ## Faecalibacterium 1.33634542 ## Lactobacillus 4.63980722 ## Parabacteroides 7.45732457 ## Collinsella 0.89189845 ## Coprococcus_3 1.28594151 ## Dorea 3.31836988 ## Streptococcus 3.16491388 ## Roseburia 0.03229673 ## Anaerostipes 0.42420796 ## Escherichia_Shigella 12.96377349 ## Enterococcus 12.85233610 ## Prevotella_9 2.91826586 ## Eggerthella 0.29870601 ## Impurity_level 0.03436332 3.3 Spike-in sample’s (BRS) remove After evaluating the sequencing quality, we remove the BRS. dada2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = dada2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) dada2_ps_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 896 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 896 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 896 tips and 893 internal nodes ] ## refseq() DNAStringSet: [ 896 reference sequences ] 3.4 Rarefaction curves plot_RarefCurve(ps = dada2_ps_remove_BRS, taxa_level = &quot;OTU&quot;, step = 100, label = &quot;Group&quot;, color = &quot;Group&quot;) ## rarefying sample S6030 ## rarefying sample S6032 ## rarefying sample S6033 ## rarefying sample S6035 ## rarefying sample S6036 ## rarefying sample S6037 ## rarefying sample S6040 ## rarefying sample S6043 ## rarefying sample S6045 ## rarefying sample S6046 ## rarefying sample S6048 ## rarefying sample S6049 ## rarefying sample S6050 ## rarefying sample S6054 ## rarefying sample S6055 ## rarefying sample S6058 ## rarefying sample S6059 ## rarefying sample S6060 ## rarefying sample S6061 ## rarefying sample S6063 ## rarefying sample S6065 ## rarefying sample S6066 ## rarefying sample S6068 Figure 3.2: Rarefaction curves The result showed that all the samples had different sequence depth but had the full sample richness. 3.5 Summarize phyloseq-class object Summarizing the phyloseq-class object by using summarize_phyloseq. It displayed that briefly introduction of the object. summarize_phyloseq(ps = dada2_ps_remove_BRS) ## Compositional = NO2 ## 1] Min. number of reads = 511812] Max. number of reads = 716673] Total number of reads = 14089154] Average number of reads = 61257.17391304355] Median number of reads = 614357] Sparsity = 0.8610248447204976] Any OTU sum to 1 or less? YES8] Number of singletons = 49] Percent of OTUs that are singletons ## (i.e. exactly one read detected across all samples)010] Number of sample variables are: 1Group2 ## [[1]] ## [1] &quot;1] Min. number of reads = 51181&quot; ## ## [[2]] ## [1] &quot;2] Max. number of reads = 71667&quot; ## ## [[3]] ## [1] &quot;3] Total number of reads = 1408915&quot; ## ## [[4]] ## [1] &quot;4] Average number of reads = 61257.1739130435&quot; ## ## [[5]] ## [1] &quot;5] Median number of reads = 61435&quot; ## ## [[6]] ## [1] &quot;7] Sparsity = 0.861024844720497&quot; ## ## [[7]] ## [1] &quot;6] Any OTU sum to 1 or less? YES&quot; ## ## [[8]] ## [1] &quot;8] Number of singletons = 4&quot; ## ## [[9]] ## [1] &quot;9] Percent of OTUs that are singletons\\n (i.e. exactly one read detected across all samples)0&quot; ## ## [[10]] ## [1] &quot;10] Number of sample variables are: 1&quot; ## ## [[11]] ## [1] &quot;Group&quot; The minus account of the OTU counts is 51181 in the phyloseq object, and we can use it as the threshold to rarefy. Notice the Sparsity (0.86), indicating the data has many zeros and pay attention to the downstream data analysis. A common property of amplicon based microbiota data generated by sequencing. 3.6 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["data-processing.html", "Chapter 4 Data processing 4.1 Rarefy otu counts 4.2 Extracting specific taxonomic level 4.3 Systematic Information", " Chapter 4 Data processing Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) This part has too may procedures and we only choose some of them. Please go to XMAS tutorial: Chapter 6 to see more approaches and details for being familiar with this part. 4.1 Rarefy otu counts From previous results of quality evaluation, the sequence depth of samples are different which have effects on the downstream analysis. Here, choosing the rarefy (Normaliztion method: random subsampling counts to the smallest library size) to get the equal sample sums. dada2_ps_rare &lt;- norm_rarefy(object = dada2_ps_remove_BRS, size = 51181) dada2_ps_rare ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 891 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 891 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 891 tips and 888 internal nodes ] ## refseq() DNAStringSet: [ 891 reference sequences ] In addition, we could also perform some other normalization methods on the rarefied phyloseq object. By the way, we didn’t transform the data by using log algorithm because the count matrix is required by the following data analysis methods. 4.2 Extracting specific taxonomic level dada2_ps_rare_genus &lt;- summarize_taxa(ps = dada2_ps_rare, taxa_level = &quot;Genus&quot;) dada2_ps_rare_genus ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 198 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 198 taxa by 6 taxonomic ranks ] 4.3 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["diversity-analysis.html", "Chapter 5 Diversity analysis 5.1 Alpha diveristy 5.2 Beta diversity 5.3 Systematic Information", " Chapter 5 Diversity analysis Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) 5.1 Alpha diveristy Calculate the alpha diversity Notes: the otu table must be counts matrix (rarefied but not trim counts matrix) when you choose Observed etc measures. dada_ps_rare_genus_alpha &lt;- run_alpha_diversity(ps = dada2_ps_rare_genus, measures = c(&quot;Shannon&quot;, &quot;Chao1&quot;, &quot;Observed&quot;)) print(dada_ps_rare_genus_alpha) ## TempRowNames Group Observed Chao1 se.chao1 Shannon ## 1 S6030 BB 74 74.00000 0.0000000 2.622800 ## 2 S6032 BB 38 38.00000 0.0000000 1.711068 ## 3 S6033 BB 80 80.16667 0.5431879 2.719495 ## 4 S6035 AA 35 35.00000 0.1232013 1.953807 ## 5 S6036 BB 95 95.00000 0.0000000 2.942657 ## 6 S6037 AA 35 35.00000 0.0000000 1.933007 ## 7 S6040 BB 58 58.00000 0.0000000 2.490198 ## 8 S6043 AA 65 65.33333 0.9246628 2.098003 ## 9 S6045 BB 60 60.00000 0.0000000 2.920363 ## 10 S6046 BB 71 71.00000 0.1241166 2.264433 ## 11 S6048 BB 66 66.00000 0.0000000 2.630421 ## 12 S6049 AA 60 60.00000 0.0000000 2.506885 ## 13 S6050 BB 53 53.00000 0.0000000 2.431334 ## 14 S6054 BB 84 84.00000 0.0000000 2.769973 ## 15 S6055 BB 75 75.00000 0.0000000 2.297388 ## 16 S6058 BB 37 37.00000 0.2465985 2.262059 ## 17 S6059 AA 71 71.00000 0.0000000 2.682960 ## 18 S6060 AA 48 48.00000 0.0000000 1.883809 ## 19 S6061 AA 80 80.00000 0.0000000 3.088651 ## 20 S6063 BB 38 38.00000 0.0000000 1.543267 ## 21 S6065 AA 77 77.00000 0.0000000 2.877568 ## 22 S6066 AA 67 67.00000 0.0000000 2.638564 ## 23 S6068 BB 40 40.00000 0.0000000 2.100363 visualization plot_boxplot(data = dada_ps_rare_genus_alpha, y_index = c(&quot;Shannon&quot;, &quot;Chao1&quot;, &quot;Observed&quot;), group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), group_color = c(&quot;red&quot;, &quot;blue&quot;)) Figure 5.1: Alpha diversity (16s example) 5.2 Beta diversity beta dipersion dada2_ps_beta &lt;- run_beta_diversity(ps = dada2_ps_rare_genus, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.017526 0.0175257 2.7119 999 0.109 ## Residuals 21 0.135711 0.0064624 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## AA BB ## AA 0.116 ## BB 0.11449 dada2_ps_beta$BetaDispersion Figure 5.2: Beta diversity (16s example) beta distance plot_distance_corrplot(datMatrix = dada2_ps_beta$BetaDistance) Figure 5.3: Beta distance 5.3 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["permanova-beta-dispersion-ordination.html", "Chapter 6 PERMANOVA + beta dispersion + Ordination 6.1 PERMANOVA 6.2 beta dispersion 6.3 Ordination 6.4 Systematic Information", " Chapter 6 PERMANOVA + beta dispersion + Ordination Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) 6.1 PERMANOVA dada2_ps_per &lt;- run_permanova(ps = dada2_ps_rare_genus, method = &quot;bray&quot;, columns = &quot;Group&quot;) print(dada2_ps_per) ## SumsOfSample Df SumsOfSqs MeanSqs F.Model R2 Pr(&gt;F) AdjustedPvalue ## Group 23 1 0.2014665 0.2014665 1.132006 0.05114792 0.328 0.328 The PERMANOVA result of the Group (AdjustedPvalue &gt; 0.05) revealed that the two groups had not the distinct patterns of microbial community. 6.2 beta dispersion beta_df &lt;- run_beta_diversity(ps = dada2_ps_rare_genus, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.017526 0.0175257 2.7119 999 0.109 ## Residuals 21 0.135711 0.0064624 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## AA BB ## AA 0.116 ## BB 0.11449 6.3 Ordination We performed ordination by using Principal Coordinate Analysis (PCoA). If you want to try other methods please go to see Chapter 8 for more details. dada2_ps_ordination &lt;- run_ordination( ps = dada2_ps_rare_genus, group = &quot;Group&quot;, method = &quot;PCoA&quot;) plot_Ordination(ResultList = dada2_ps_ordination, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), group_color = c(&quot;blue&quot;, &quot;red&quot;)) Figure 6.1: PCoA (16s example) 6.4 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["microbial-composition.html", "Chapter 7 Microbial composition 7.1 Stacked barplot 7.2 Core microbiota 7.3 Systematic Information", " Chapter 7 Microbial composition Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) A whole picture of the microbial composition. 7.1 Stacked barplot XVIZ package plot_stacked_bar_XIVZ( phyloseq = dada2_ps_rare, level = &quot;Phylum&quot;, feature = &quot;Group&quot;) Figure 7.1: Microbial composition (16s example) XVIZ XMAS package plot_StackBarPlot( ps = dada2_ps_rare, taxa_level = &quot;Phylum&quot;, group = &quot;Group&quot;, cluster = TRUE) Figure 7.2: Microbial composition (16s example) 7.2 Core microbiota convert absolute abundance into relative abundance dada2_ps_rare_rb &lt;- XMAS2::normalize(object = dada2_ps_rare, method = &quot;TSS&quot;) dada2_ps_rare_rb ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 891 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 891 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 891 tips and 888 internal nodes ] ## refseq() DNAStringSet: [ 891 reference sequences ] visualization prevalences &lt;- seq(0.05, 1, 0.05) detections &lt;- 10^seq(log10(1e-3), log10(0.2), length = 10) pl_core &lt;- plot_core_taxa(dada2_ps_rare_rb, plot.type = &quot;heatmap&quot;, colours = gray(seq(0, 1, length=5)), prevalences = prevalences, detections = detections, min.prevalence = 0.5)+ xlab(&quot;Detection Threshold (Relative Abundance (%))&quot;) pl_core Figure 7.3: Core taxa (16s example) The degree of color indicates the size of abundance and prevalence. Use core_members to obtain the core taxa. detection for abundance and prevalence for occurrence. core_taxa_name &lt;- core_members(dada2_ps_rare_rb, detection = 0.01, prevalence = 0.8) print(core_taxa_name) ## [1] &quot;ASV_1&quot; Result: Only 2 genera (g__Bifidobacterium and g__Blautia) passed the threshold of detection and prevalence which we choose. 7.3 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["differential-analysis.html", "Chapter 8 Differential Analysis 8.1 Filtering and trimming 8.2 Liner discriminant analysis (LDA) effect size (LEfSe) 8.3 Wilcoxon Rank-Sum test 8.4 Dominant taxa 8.5 Multiple differential analysis by one function 8.6 Systematic Information", " Chapter 8 Differential Analysis Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) There are more than 10 approaches to perform differential analysis. Here, we choose two of them and recommend users going to XMAS2: Chapter 11 to see more details. 8.1 Filtering and trimming We suggest that filtering taxa with low abundance (the summarized value under cutoff: 10) and trimming taxa with low prevalence (default: 0.1). 8.1.1 Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 10) dada2_ps_rare_genus_filter &lt;- run_filter(ps = dada2_ps_rare_genus, cutoff = 10, unclass = TRUE) dada2_ps_rare_genus_filter ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 149 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 149 taxa by 6 taxonomic ranks ] 8.1.2 Trimming the taxa with low occurrence less than threshold dada2_ps_rare_genus_filter_trim &lt;- run_trim(object = dada2_ps_rare_genus_filter, cutoff = 0.1, trim = &quot;feature&quot;) dada2_ps_rare_genus_filter_trim ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 122 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 122 taxa by 6 taxonomic ranks ] Finally, we obtained the final phyloseq-class object dada2_ps_rare_genus_filter_trim and changed its name. 8.2 Liner discriminant analysis (LDA) effect size (LEfSe) Calculation dada2_ps_lefse &lt;- run_lefse( ps = dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), norm = &quot;CPM&quot;, Lda = 2) head(dada2_ps_lefse) ## TaxaID Block Enrichment LDA_Score EffectSize Log2FoldChange (Median)\\nAA_vs_BB ## 1 g__Parasutterella 9_AA vs 14_BB AA -3.622720 2.337478 4.400391 ## 2 g__Ruminococcaceae_UCG_004 9_AA vs 14_BB AA -2.786635 2.323866 NA ## 3 g__Intestinibacter 9_AA vs 14_BB BB 3.180391 2.707925 NA ## 4 g__Clostridium_sensu_stricto_1 9_AA vs 14_BB BB 3.657070 2.999010 NA ## 5 g__Romboutsia 9_AA vs 14_BB BB 3.689270 3.101747 -6.855390 ## 6 g__Lactobacillus 9_AA vs 14_BB BB 4.080945 2.535860 -3.319206 ## Median Abundance\\n(All) Median Abundance\\nAA Median Abundance\\nBB Log2FoldChange (Mean)\\nAA_vs_BB Mean Abundance\\n(All) ## 1 152.0946 1075.68521 50.93725 4.382363 3626.399 ## 2 222.5414 2450.05654 0.00000 2.352990 1382.304 ## 3 380.1043 0.00000 1210.74287 -2.077598 1782.122 ## 4 224.7329 0.00000 985.98421 -4.839795 5556.933 ## 5 2186.0380 50.35627 5830.84783 -3.320093 6940.723 ## 6 1281.2951 510.55140 5095.89137 -5.210661 19394.730 ## Mean Abundance\\nAA Mean Abundance\\nBB Occurrence (100%)\\n(All) Occurrence (100%)\\nAA Occurrence (100%)\\nBB ## 1 8624.2116 413.5201 65.22 88.89 50.00 ## 2 2708.0076 530.0652 52.17 77.78 35.71 ## 3 601.9396 2540.8102 60.87 22.22 85.71 ## 4 311.7956 8928.8074 60.87 22.22 85.71 ## 5 1072.6678 10713.0444 78.26 55.56 92.86 ## 6 845.7532 31319.0727 86.96 77.78 92.86 ## Odds Ratio (95% CI) ## 1 0.0051 (-10;10) ## 2 0.15 (-3.5;3.8) ## 3 3.7 (6.3;1.1) ## 4 6500 (6500;6500) ## 5 63 (71;55) ## 6 3.5e+08 (3.5e+08;3.5e+08) Visualization # # don&#39;t run this code when you do lefse in reality # dada2_ps_lefse$LDA_Score &lt;- dada2_ps_lefse$LDA_Score * 1000 plot_lefse( da_res = dada2_ps_lefse, x_index = &quot;LDA_Score&quot;, x_index_cutoff = 2, group_color = c(&quot;green&quot;, &quot;red&quot;)) Figure 8.1: Lefse analysis (16s example) 8.3 Wilcoxon Rank-Sum test Calculation dada2_ps_wilcox &lt;- run_wilcox( ps = dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;)) head(dada2_ps_wilcox) ## TaxaID Block Enrichment EffectSize Statistic Pvalue AdjustedPvalue Log2FoldChange (Median)\\nAA_vs_BB ## 1 g__Acidaminococcus 9_AA vs 14_BB Nonsignif 70.56349 63.5 1.0000000 1.0000000 NA ## 2 g__Actinomyces 9_AA vs 14_BB Nonsignif 39.65079 44.5 0.2556616 0.7335420 -0.9577718 ## 3 g__Adlercreutzia 9_AA vs 14_BB Nonsignif 23.17460 44.0 0.1980169 0.7335420 NA ## 4 g__Agathobacter 9_AA vs 14_BB Nonsignif 1222.58730 71.0 0.6293971 0.9141243 0.1524904 ## 5 g__Akkermansia 9_AA vs 14_BB Nonsignif 104.78571 64.5 0.9304707 0.9702344 NA ## 6 g__Alistipes 9_AA vs 14_BB Nonsignif 23.03175 67.0 0.8239942 0.9308083 -0.1085245 ## Median Abundance\\n(All) Median Abundance\\nAA Median Abundance\\nBB Log2FoldChange (Rank)\\nAA_vs_BB Mean Rank Abundance\\nAA ## 1 0 0 0.0 0.01201252 12.06 ## 2 30 26 50.5 -0.42227633 9.94 ## 3 0 0 9.0 -0.43387758 9.89 ## 4 316 329 296.0 0.17342686 12.89 ## 5 0 0 0.0 0.03358045 12.17 ## 6 64 64 69.0 0.08724541 12.44 ## Mean Rank Abundance\\nBB Occurrence (100%)\\n(All) Occurrence (100%)\\nAA Occurrence (100%)\\nBB Odds Ratio (95% CI) ## 1 11.96 21.74 22.22 21.43 0.67 (-0.11;1.5) ## 2 13.32 82.61 88.89 78.57 4.1 (6.8;1.3) ## 3 13.36 43.48 33.33 50.00 8.6 (13;4.3) ## 4 11.43 65.22 55.56 71.43 0.39 (-1.4;2.2) ## 5 11.89 21.74 22.22 21.43 1.5 (2.3;0.71) ## 6 11.71 73.91 77.78 71.43 0.88 (0.64;1.1) Volcano plot_volcano( da_res = dada2_ps_wilcox, group_names = c(&quot;AA&quot;, &quot;BB&quot;), x_index = &quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, group_color = c(&quot;red&quot;, &quot;grey&quot;, &quot;blue&quot;), topN = 5) Figure 8.2: Wilcoxon Rank-Sum test (16s example) 8.4 Dominant taxa Display the significant taxa with selection using boxplot. plot_topN_boxplot( ps = dada2_ps_rare_genus_filter_trim, da_res = dada2_ps_wilcox, x_index = &quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, topN = 5, group = &quot;Group&quot;) Figure 8.3: Dominant Taxa 8.5 Multiple differential analysis by one function here, we provide the run_multiple_da for obtaining the results list from multiple differential analysis methods. multiple_res &lt;- run_multiple_da( ps = dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), da_method = c(&quot;aldex&quot;, &quot;limma_voom&quot;, &quot;mbzinb&quot;, &quot;omnibus&quot;)) ## |------------(25%)----------(50%)----------(75%)----------| ## Start GMPR normalization ... ## Start Winsorization ... ## Perform filtering ... ## --A total of 102 taxa will be tested with a sample size of 23 ! ## --Omnibus test is selected! ## --Dispersion is treated as a parameter of interest! ## Start testing ... ## 10 % ## 20 % ## 30 % ## 40 % ## 50 % ## 60 % ## 70 % ## 80 % ## 90 % ## 100%! ## Handle failed taxa using permutation test! ## Permutation test .... ## Completed! names(multiple_res) ## [1] &quot;aldex&quot; &quot;limma_voom&quot; &quot;mbzinb&quot; &quot;omnibus&quot; plot results plot_multiple_DA( Multip_DA_res = multiple_res, x_index_list = c(&quot;EffectSize&quot;, &quot;logFC&quot;, &quot;mean.LFC&quot;, &quot;abund.LFC.CompvarBB.est&quot;), x_index_cutoff = 1, y_index = &quot;AdjustedPvalue&quot;, y_index_cutoff = 0.5, cellwidth = 50, cellheight = 15, fontsize_number = 15) Figure 8.4: Multiple DA results 8.6 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["network-analysis.html", "Chapter 9 Network Analysis 9.1 Importing data 9.2 Single network with Pearson correlation as association measure 9.3 Single network with sparcc correlation as association measure 9.4 Dissimilarity-based Networks 9.5 Systematic Information", " Chapter 9 Network Analysis Estimating microbial association networks from high-throughput sequencing data is a common exploratory data analysis approach aiming at understanding the complex interplay of microbial communities in their natural habitat. Statistical network estimation workflows comprise several analysis steps, including methods for zero handling, data normalization and computing microbial associations. Since microbial interactions are likely to change between conditions, e.g. between healthy individuals and patients, identifying network differences between groups is often an integral secondary analysis step. NetCoMi (Network Construction and Comparison for Microbiome Data) (Peschel et al. 2021) provides functionality for constructing, analyzing, and comparing networks suitable for the application on microbial compositional data. The following information is from NetCoMi github. Association measures: Pearson coefficient (cor() from stats package) Spearman coefficient (cor() from stats package) Biweight Midcorrelation bicor() from WGCNA package SparCC (sparcc() from SpiecEasi package) CCLasso (R code on GitHub) CCREPE (ccrepe package) SpiecEasi (SpiecEasi package) SPRING (SPRING package) gCoda (R code on GitHub) propr (propr package) Dissimilarity measures: Euclidean distance (vegdist() from vegan package) Bray-Curtis dissimilarity (vegdist() from vegan package) Kullback-Leibler divergence (KLD) (KLD() from LaplacesDemon package) Jeffrey divergence (own code using KLD() from LaplacesDemon package) Jensen-Shannon divergence (own code using KLD() from LaplacesDemon package) Compositional KLD (own implementation following [Martín-Fernández et al., 1999]) Aitchison distance (vegdist() and clr() from SpiecEasi package) Methods for zero replacement: Adding a predefined pseudo count Multiplicative replacement (multRepl from zCompositions package) Modified EM alr-algorithm (lrEM from zCompositions package) Bayesian-multiplicative replacement (cmultRepl from zCompositions package) Normalization methods: Total Sum Scaling (TSS) (own implementation) Cumulative Sum Scaling (CSS) (cumNormMat from metagenomeSeq package) Common Sum Scaling (COM) (own implementation) Rarefying (rrarefy from vegan package) Variance Stabilizing Transformation (VST) (varianceStabilizingTransformation from DESeq2 package) Centered log-ratio (clr) transformation (clr() from SpiecEasi package)) TSS, CSS, COM, VST, and the clr transformation are described in [Badri et al., 2020]. Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(NetCoMi) 9.1 Importing data dada2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = dada2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) dada2_ps_rare &lt;- norm_rarefy(object = dada2_ps_remove_BRS, size = 51181) dada2_ps_rare_genus &lt;- summarize_taxa(ps = dada2_ps_rare, taxa_level = &quot;Genus&quot;) dada2_ps_rare_genus_filter &lt;- run_filter(ps = dada2_ps_rare_genus, cutoff = 10, unclass = TRUE) dada2_ps_rare_genus_filter ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 149 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 1 sample variables ] ## tax_table() Taxonomy Table: [ 149 taxa by 6 taxonomic ranks ] 9.2 Single network with Pearson correlation as association measure Since Pearson correlations may lead to compositional effects when applied to sequencing data, we use the clr transformation as normalization method. Zero treatment is necessary in this case. A threshold of 0.3 is used as sparsification method, so that only OTUs with an absolute correlation greater than or equal to 0.3 are connected. 9.2.1 Building network model net_single &lt;- netConstruct(dada2_ps_rare_genus_filter, measure = &quot;pearson&quot;, normMethod = &quot;clr&quot;, zeroMethod = &quot;multRepl&quot;, sparsMethod = &quot;threshold&quot;, thresh = 0.7, verbose = 3, seed = 123) 9.2.2 Analyzing the constructed network NetCoMi’s netAnalyze() function is used for analyzing the constructed network(s). props_single &lt;- netAnalyze(net_single, clustMethod = &quot;cluster_fast_greedy&quot;) summary(props_single, numbNodes = 5L) ## ## Component sizes ## ``````````````` ## size: 39 3 2 1 ## #: 1 2 8 88 ## ______________________________ ## Global network properties ## ````````````````````````` ## Largest connected component (LCC): ## ## Relative LCC size 0.26174 ## Clustering coefficient 0.59645 ## Modularity 0.59201 ## Positive edge percentage 80.55556 ## Edge density 0.09717 ## Natural connectivity 0.06273 ## Vertex connectivity 1.00000 ## Edge connectivity 1.00000 ## Average dissimilarity* 0.94444 ## Average path length** 1.86198 ## ## Whole network: ## ## Number of components 99.00000 ## Clustering coefficient 0.61305 ## Modularity 0.68097 ## Positive edge percentage 78.82353 ## Edge density 0.00771 ## Natural connectivity 0.01044 ## ## *Dissimilarity = 1 - edge weight ## **Path length: Units with average dissimilarity ## ## ______________________________ ## Clusters ## - In the whole network ## - Algorithm: cluster_fast_greedy ## ```````````````````````````````` ## ## name: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ## #: 88 12 2 3 2 2 9 4 2 2 3 4 2 2 6 2 4 ## ## ______________________________ ## Hubs ## - In alphabetical/numerical order ## - Based on empirical quantiles of centralities ## ``````````````````````````````````````````````` ## g__Aggregatibacter ## g__CHKCI002 ## g__Enterorhabdus ## g__Family_XIII_UCG_001 ## g__Lachnospiraceae_UCG_008 ## g__Ruminococcaceae_UCG_008 ## g__Ruminococcaceae_UCG_009 ## g__Slackia ## ## ______________________________ ## Centrality measures ## - In decreasing order ## - Centrality of disconnected components is zero ## ```````````````````````````````````````````````` ## Degree (normalized): ## ## g__Lachnospiraceae_UCG_008 0.07432 ## g__CHKCI002 0.05405 ## g__Aggregatibacter 0.04730 ## g__Enterorhabdus 0.04730 ## g__Prevotella_9 0.04730 ## ## Betweenness centrality (normalized): ## ## g__Lachnospiraceae_UCG_008 0.70128 ## g__Enterorhabdus 0.32432 ## g__Prevotella_9 0.32290 ## g__Coprococcus_2 0.19346 ## g__Holdemanella 0.19346 ## ## Closeness centrality (normalized): ## ## g__CHKCI002 2.29073 ## g__Enterorhabdus 2.10507 ## g__Ruminococcaceae_UCG_008 1.86673 ## g__Lachnospiraceae_UCG_008 1.55863 ## g__Asaccharospora 1.39662 ## ## Eigenvector centrality (normalized): ## ## g__CHKCI002 1.00000 ## g__Enterorhabdus 0.98929 ## g__Ruminococcaceae_UCG_008 0.92786 ## g__Family_XIII_UCG_001 0.84702 ## g__Ruminococcaceae_UCG_009 0.83421 9.2.3 Visualizing the network primary plot plot(props_single, nodeColor = &quot;cluster&quot;, nodeSize = &quot;eigenvector&quot;, title1 = &quot;Network on 16s with Pearson correlations&quot;, showTitle = TRUE, labelLength = 10, cexTitle = 1.5) legend(0.7, 1.1, cex = 1, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;#009900&quot;,&quot;red&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.1: Network on 16s with Pearson correlations improve the visualization by changing the following arguments: repulsion = 0.8: Place the nodes further apart rmSingles = TRUE: Single nodes are removed labelScale = FALSE and cexLabels = 1.6: All labels have equal size and are enlarged to improve readability of small node’s labels nodeSizeSpread = 3 (default is 4): Node sizes are more similar if the value is decreased. This argument (in combination with cexNodes) is useful to enlarge small nodes while keeping the size of big nodes. plot(props_single, nodeColor = &quot;cluster&quot;, nodeSize = &quot;eigenvector&quot;, labelLength = 40, repulsion = 0.8, rmSingles = TRUE, labelScale = FALSE, cexLabels = 1, nodeSizeSpread = 3, cexNodes = 2, title1 = &quot;Network on metabolomics with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 1.5) legend(0.7, 1.1, cex = 1.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;#009900&quot;,&quot;red&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.2: Network on 16s with Pearson correlations Network on genus level with Pearson correlations set.seed(123) graph &lt;- igraph::graph_from_adjacency_matrix(net_single$adjaMat1, weighted = TRUE) lay_fr &lt;- igraph::layout_with_fr(graph) rownames(lay_fr) &lt;- rownames(net_single$adjaMat1) plot(props_single, layout = &quot;layout_with_fr&quot;, shortenLabels = &quot;simple&quot;, labelLength = 30, charToRm = &quot;g__&quot;, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;clr&quot;, nodeColor = &quot;cluster&quot;, hubBorderCol = &quot;darkgray&quot;, cexNodes = 2, cexLabels = 1.5, cexHubLabels = 2, title1 = &quot;Network on genus level with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 2.3) legend(0.7, 1.1, cex = 2.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;#009900&quot;,&quot;red&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.3: Network on 16s with Pearson correlations (Genus) Let’s check whether the largest nodes are actually those with highest column sums in the matrix with normalized counts returned by netConstruct(). sort(colSums(net_single$normCounts1), decreasing = TRUE)[1:10] ## g__Blautia g__Bifidobacterium g__Bacteroides g__Faecalibacterium g__Streptococcus g__Anaerostipes ## 118.72356 102.80453 89.05312 59.39712 58.50952 46.25736 ## g__Collinsella g__Lachnoclostridium g__Agathobacter g__Dorea ## 39.56018 37.38476 36.47407 35.96901 Network on genus level with Pearson correlations with phylum annotation # Get phyla names from the taxonomic table created before taxatab &lt;- dada2_ps_rare_genus_filter@tax_table %&gt;% data.frame() phyla &lt;- as.factor(gsub(&quot;p__&quot;, &quot;&quot;, taxatab[, &quot;Phylum&quot;])) names(phyla) &lt;- taxatab$Genus # Define phylum colors phylcol &lt;- c(&quot;cyan&quot;, &quot;blue3&quot;, &quot;red&quot;, &quot;lawngreen&quot;, &quot;yellow&quot;, &quot;deeppink&quot;, &quot;grey&quot;) plot(props_single, layout = &quot;spring&quot;, repulsion = 0.84, shortenLabels = &quot;none&quot;, charToRm = &quot;g__&quot;, labelLength = 30, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;clr&quot;, nodeSizeSpread = 4, nodeColor = &quot;feature&quot;, featVecCol = phyla, colorVec = phylcol, posCol = &quot;darkturquoise&quot;, negCol = &quot;orange&quot;, edgeTranspLow = 0, edgeTranspHigh = 40, cexNodes = 2, cexLabels = 2, cexHubLabels = 2.5, title1 = &quot;Network on genus level with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 2.3) # Colors used in the legend should be equally transparent as in the plot phylcol_transp &lt;- NetCoMi:::colToTransp(phylcol, 60) legend(-1.2, 1.2, cex = 2, pt.cex = 2.5, title = &quot;Phylum:&quot;, legend=levels(phyla), col = phylcol_transp, bty = &quot;n&quot;, pch = 16) legend(0.7, 1.1, cex = 2.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;darkturquoise&quot;,&quot;orange&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.4: Network on 16s with Pearson correlations (Annotation) 9.3 Single network with sparcc correlation as association measure Only the 100 features with highest variance are selected. Only samples with a total number of reads of at least 1000 included. 9.3.1 Building network model net_single2 &lt;- netConstruct(dada2_ps_rare_genus_filter, measure = &quot;sparcc&quot;, measurePar = list(iter = 20, inner_iter = 10, th = 0.1), filtTax = &quot;highestVar&quot;, filtTaxPar = list(highestVar = 100), filtSamp = &quot;totalReads&quot;, filtSampPar = list(totalReads = 100), verbose = 3, seed = 123) ## Data filtering ... ## 49 taxa removed. ## 100 taxa and 23 samples remaining. ## ## Calculate &#39;sparcc&#39; associations ... Done. ## ## Sparsify associations via &#39;t-test&#39; ... ## Adjust for multiple testing via &#39;adaptBH&#39; ... ## Proportion of true null hypotheses: 0.9 ## Done. ## Done. 9.3.2 Analyzing the constructed network NetCoMi’s netAnalyze() function is used for analyzing the constructed network(s). props_single2 &lt;- netAnalyze(net_single2, clustMethod = &quot;cluster_fast_greedy&quot;) summary(props_single2, numbNodes = 5L) ## ## Component sizes ## ``````````````` ## size: 2 1 ## #: 3 94 ## ______________________________ ## Global network properties ## ````````````````````````` ## Largest connected component (LCC): ## ## Relative LCC size 0.02000 ## Clustering coefficient 0.00000 ## Modularity 0.00000 ## Positive edge percentage 100.00000 ## Edge density 1.00000 ## Natural connectivity 0.93918 ## Vertex connectivity 1.00000 ## Edge connectivity 1.00000 ## Average dissimilarity* 0.29983 ## Average path length** 1.00000 ## ## Whole network: ## ## Number of components 97.00000 ## Clustering coefficient 0.00000 ## Modularity 0.66667 ## Positive edge percentage 66.66667 ## Edge density 0.00061 ## Natural connectivity 0.01060 ## ## *Dissimilarity = 1 - edge weight ## **Path length: Units with average dissimilarity ## ## ______________________________ ## Clusters ## - In the whole network ## - Algorithm: cluster_fast_greedy ## ```````````````````````````````` ## ## name: 0 1 2 3 ## #: 94 2 2 2 ## ## ______________________________ ## Hubs ## - In alphabetical/numerical order ## - Based on empirical quantiles of centralities ## ``````````````````````````````````````````````` ## g__Blautia ## g__Erysipelatoclostridium ## ## ______________________________ ## Centrality measures ## - In decreasing order ## - Centrality of disconnected components is zero ## ```````````````````````````````````````````````` ## Degree (normalized): ## ## g__Blautia 0.0101 ## g__Erysipelatoclostridium 0.0101 ## g__Bifidobacterium 0.0000 ## g__Bacteroides 0.0000 ## g__Streptococcus 0.0000 ## ## Betweenness centrality (normalized): ## ## g__Bifidobacterium 0 ## g__Bacteroides 0 ## g__Blautia 0 ## g__Streptococcus 0 ## g__Faecalibacterium 0 ## ## Closeness centrality (normalized): ## ## g__Blautia 1 ## g__Erysipelatoclostridium 1 ## g__Bifidobacterium 0 ## g__Bacteroides 0 ## g__Streptococcus 0 ## ## Eigenvector centrality (normalized): ## ## g__Blautia 1 ## g__Erysipelatoclostridium 1 ## g__Bifidobacterium 0 ## g__Bacteroides 0 ## g__Streptococcus 0 9.3.2.1 Visualizing the network plot(props_single2, layout = &quot;spring&quot;, repulsion = 0.84, shortenLabels = &quot;none&quot;, charToRm = &quot;g__&quot;, labelLength = 30, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;clr&quot;, nodeSizeSpread = 4, nodeColor = &quot;feature&quot;, featVecCol = phyla, colorVec = phylcol, posCol = &quot;darkturquoise&quot;, negCol = &quot;orange&quot;, edgeTranspLow = 0, edgeTranspHigh = 40, cexNodes = 2, cexLabels = 2, cexHubLabels = 2.5, title1 = &quot;Network on genus level with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 2.3) # Colors used in the legend should be equally transparent as in the plot phylcol_transp &lt;- NetCoMi:::colToTransp(phylcol, 60) legend(-1.2, 1.2, cex = 2, pt.cex = 2.5, title = &quot;Phylum:&quot;, legend=levels(phyla), col = phylcol_transp, bty = &quot;n&quot;, pch = 16) legend(0.7, 1.1, cex = 2.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;darkturquoise&quot;,&quot;orange&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.5: Network on metabolomics with sparcc associations 9.4 Dissimilarity-based Networks If a dissimilarity measure is used for network construction, nodes are subjects instead of OTUs. The estimated dissimilarities are transformed into similarities, which are used as edge weights so that subjects with a similar microbial composition are placed close together in the network plot. We construct a single network using Aitchison’s distance being suitable for the application on compositional data. Since the Aitchison distance is based on the clr-transformation, zeros in the data need to be replaced. The network is sparsified using the k-nearest neighbor (knn) algorithm. 9.4.1 Building network module net_aitchison &lt;- netConstruct(dada2_ps_rare_genus_filter, measure = &quot;aitchison&quot;, zeroMethod = &quot;multRepl&quot;, sparsMethod = &quot;knn&quot;, kNeighbor = 3, verbose = 3) ## Infos about changed arguments: ## Counts normalized to fractions for measure &#39;aitchison&#39;. ## 149 taxa and 23 samples remaining. ## ## Zero treatment: ## Execute multRepl() ... ## Warning in (function (X, label = NULL, dl = NULL, frac = 0.65, imp.missing = FALSE, : Column(s) containing more than 80% zeros/unobserved values were found (check it out using zPatterns). ## (You can use the z.warning argument to modify the warning threshold). ## Done. ## ## Normalization: ## Counts normalized by total sum scaling. ## ## Calculate &#39;aitchison&#39; dissimilarities ... Done. ## ## Sparsify dissimilarities via &#39;knn&#39; ... Done. 9.4.2 Analyzing the constructed network NetCoMi’s netAnalyze() function is used for analyzing the constructed network(s). props_aitchison &lt;- netAnalyze(net_aitchison, clustMethod = &quot;hierarchical&quot;, clustPar = list(method = &quot;average&quot;, k = 3), hubPar = &quot;eigenvector&quot;) summary(props_aitchison, numbNodes = 5L) ## ## Component sizes ## ``````````````` ## size: 23 ## #: 1 ## ______________________________ ## Global network properties ## ````````````````````````` ## ## Number of components 1.00000 ## Clustering coefficient 0.42932 ## Modularity 0.36419 ## Positive edge percentage 100.00000 ## Edge density 0.18577 ## Natural connectivity 0.10798 ## Vertex connectivity 2.00000 ## Edge connectivity 3.00000 ## Average dissimilarity* 0.87407 ## Average path length** 0.87285 ## ## *Dissimilarity = 1 - edge weight ## **Path length: Units with average dissimilarity ## ## ______________________________ ## Clusters ## - In the whole network ## - Algorithm: hierarchical ## ````````````````````````` ## ## name: 1 2 3 ## #: 12 9 2 ## ## ______________________________ ## Hubs ## - In alphabetical/numerical order ## - Based on empirical quantiles of centralities ## ``````````````````````````````````````````````` ## S6032 ## S6063 ## ## ______________________________ ## Centrality measures ## - In decreasing order ## - Computed for the complete network ## ```````````````````````````````````` ## Degree (normalized): ## ## S6032 0.36364 ## S6063 0.36364 ## S6055 0.31818 ## S6035 0.27273 ## S6054 0.22727 ## ## Betweenness centrality (normalized): ## ## S6063 0.29870 ## S6055 0.24675 ## S6035 0.19048 ## S6032 0.18182 ## S6046 0.17749 ## ## Closeness centrality (normalized): ## ## S6050 3.42434 ## S6040 3.39372 ## S6035 2.20310 ## S6068 2.13482 ## S6032 2.11212 ## ## Eigenvector centrality (normalized): ## ## S6063 1.00000 ## S6032 0.86437 ## S6035 0.78392 ## S6068 0.72544 ## S6037 0.59651 9.4.3 Visualizing the network primary plot plot(props_aitchison, nodeColor = &quot;cluster&quot;, nodeSize = &quot;eigenvector&quot;, repulsion = 0.8, rmSingles = TRUE, labelScale = FALSE, cexLabels = 1.6, nodeSizeSpread = 3, cexNodes = 1.5, title1 = &quot;Network on metagenomics with Aitchison distance&quot;, showTitle = TRUE, cexTitle = 1.5, hubTransp = 50, edgeTranspLow = 60, charToRm = &quot;00000&quot;, mar = c(1, 3, 3, 5)) # get green color with 50% transparency green2 &lt;- colToTransp(&quot;#009900&quot;, 40) legend(0.4, 1.1, cex = 1.5, legend = c(&quot;high similarity (low Aitchison distance)&quot;, &quot;low similarity (high Aitchison distance)&quot;), lty = 1, lwd = c(3, 1), col = c(&quot;darkgreen&quot;, green2), bty = &quot;n&quot;) Figure 9.6: Dissimilarity-based Networks plot samples with group information # Get gorup names from the sample table created before sampletab &lt;- dada2_ps_rare_genus_filter@sam_data %&gt;% data.frame() group_labels &lt;- factor(sampletab$Group) names(group_labels) &lt;- rownames(sampletab) # Define group colors group_lcol &lt;- c(&quot;blue3&quot;, &quot;red&quot;) plot(props_aitchison, layout = &quot;spring&quot;, repulsion = 0.84, shortenLabels = &quot;none&quot;, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;eigenvector&quot;, nodeSizeSpread = 4, nodeColor = &quot;feature&quot;, featVecCol = group_labels, colorVec = group_lcol, posCol = &quot;darkturquoise&quot;, negCol = &quot;orange&quot;, edgeTranspLow = 0, edgeTranspHigh = 40, cexNodes = 2, cexLabels = 2, cexHubLabels = 2.5, title1 = &quot;Network on genus level with Aitchison distance&quot;, showTitle = TRUE, cexTitle = 2.3) # Colors used in the legend should be equally transparent as in the plot group_transp &lt;- NetCoMi:::colToTransp(group_lcol, 60) legend(-1.2, 1.2, cex = 2, pt.cex = 2.5, title = &quot;Group:&quot;, legend = levels(group_labels), col = group_transp, bty = &quot;n&quot;, pch = 16) # get green color with 50% transparency green2 &lt;- colToTransp(&quot;#009900&quot;, 40) legend(0.4, 1.1, cex = 1.5, legend = c(&quot;high similarity (low Aitchison distance)&quot;, &quot;low similarity (high Aitchison distance)&quot;), lty = 1, lwd = c(3, 1), col = c(&quot;darkgreen&quot;, green2), bty = &quot;n&quot;) Figure 9.7: Dissimilarity-based Networks (group information) 9.5 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── References "],["test-example.html", "Chapter 10 Test Example 10.1 Loading packages 10.2 Loading data 10.3 Metaphlan2 result 10.4 Step1: Reads’ Track 10.5 Step2: Convert inputs into phyloseq data 10.6 Step3: BRS checking 10.7 Step4: Rarefaction curves 10.8 Step5: Rarefy otu counts 10.9 Step6: Extracting specific taxonomic level 10.10 Step7: GlobalView 10.11 Step8: Differential Analysis 10.12 Systematic Information", " Chapter 10 Test Example 10.1 Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) library(readxl) 10.2 Loading data dada2_res &lt;- readRDS(&quot;DataSet/RawData/dada2_res.rds&quot;) tree &lt;- phyloseq::read_tree(&quot;DataSet/RawData/tree.nwk&quot;) metadata &lt;- readxl::read_xlsx(&quot;DataSet/RawData/诺禾宏基因组678月-ZH.xlsx&quot;, sheet = 3) metaphlan2_res &lt;- read.table(&quot;DataSet/RawData/merged_metaphlan2.tsv&quot;, header = TRUE, stringsAsFactors = FALSE) %&gt;% tibble::rownames_to_column(&quot;ID&quot;) 10.3 Metaphlan2 result metaphlan2_res_list &lt;- import_metaphlan_taxa(data_metaphlan2 = metaphlan2_res, taxa_level = &quot;Species&quot;) tax_tab &lt;- metaphlan2_res_list$tax_tab otu_tab &lt;- metaphlan2_res_list$abu_tab colnames(otu_tab) &lt;- gsub(&quot;X&quot;, &quot;S_&quot;, colnames(otu_tab)) sam_tab &lt;- metadata %&gt;% data.frame() %&gt;% dplyr::mutate(Group=ifelse(SampleType == &quot;粪便&quot;, &quot;Stool&quot;, ifelse(SampleType == &quot;QC&quot;, &quot;QC&quot;, &quot;Product&quot;))) %&gt;% dplyr::select(SampleTubeID, Group, everything()) rownames(sam_tab) &lt;- paste0(&quot;S_&quot;, sam_tab$SeqID_MGS) overlap_samples &lt;- intersect(rownames(sam_tab), colnames(otu_tab)) otu_tab_cln &lt;- otu_tab[, match(overlap_samples, colnames(otu_tab))] sam_tab_cln &lt;- sam_tab[match(overlap_samples, rownames(sam_tab)), ] rownames(sam_tab_cln) &lt;- overlap_samples metaphlan2_ps &lt;- get_metaphlan_phyloseq( otu_tab = otu_tab_cln, sam_tab = sam_tab_cln, tax_tab = tax_tab) metaphlan2_ps ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 328 taxa and 145 samples ] ## sample_data() Sample Data: [ 145 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 328 taxa by 7 taxonomic ranks ] 10.4 Step1: Reads’ Track plot_Dada2Track(data = dada2_res$reads_track) + guides(color = &quot;none&quot;) Figure 10.1: DADA2’ read track (Example) 10.5 Step2: Convert inputs into phyloseq data tax_tab_16s &lt;- import_dada2_taxa(dada2_taxa = dada2_res$tax_tab) otu_tab_16s &lt;- dada2_res$seq_tab # Shouldn&#39;t use the Total Number as SampleID (wrong: 123456; right: X123456) rownames(otu_tab_16s) &lt;- paste0(&quot;S_&quot;, rownames(otu_tab_16s)) sam_tab_16s &lt;- metadata %&gt;% data.frame() %&gt;% dplyr::mutate(Group=ifelse(SampleType == &quot;粪便&quot;, &quot;Stool&quot;, ifelse(SampleType == &quot;QC&quot;, &quot;QC&quot;, &quot;Product&quot;))) %&gt;% dplyr::filter(SampleTubeID %in% sam_tab_cln$SampleTubeID) %&gt;% dplyr::select(SampleTubeID, Group, everything()) rownames(sam_tab_16s) &lt;- paste0(&quot;S_&quot;, sam_tab_16s$SeqID_16s) overlap_samples_16s &lt;- intersect(rownames(sam_tab_16s), rownames(otu_tab_16s)) otu_tab_16s_cln &lt;- otu_tab_16s[match(overlap_samples_16s, rownames(otu_tab_16s)), ] sam_tab_16s_cln &lt;- sam_tab_16s[match(overlap_samples_16s, rownames(sam_tab_16s)), ] dada2_ps &lt;- get_dada2_phyloseq( seq_tab = otu_tab_16s_cln, tax_tab = tax_tab_16s, sam_tab = sam_tab_16s_cln, phy_tree = tree) dada2_ps ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 1948 taxa and 145 samples ] ## sample_data() Sample Data: [ 145 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 1948 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 1948 tips and 1933 internal nodes ] ## refseq() DNAStringSet: [ 1948 reference sequences ] if (!dir.exists(&quot;DataSet/Step2/&quot;)) { dir.create(&quot;DataSet/Step2/&quot;) } saveRDS(dada2_ps, &quot;DataSet/Step2/Donor_16s_phyloseq.RDS&quot;, compress = TRUE) 10.6 Step3: BRS checking dada2_ps &lt;- readRDS(&quot;DataSet/Step2/Donor_16s_phyloseq.RDS&quot;) dada2_ps_genus &lt;- summarize_taxa(ps = dada2_ps, taxa_level = &quot;Genus&quot;) tail(dada2_ps_genus@sam_data %&gt;% data.frame()) ## SampleTubeID Group Date_Sequencing ProductID SampleType ProductBatch Date_Sampling Date_Receiving SeqID_MGS ## S_7929 GGM50-210730 Stool 2021-08-03 M50 粪便 CYM50-210735 2021.07.30 2021-08-06 7769 ## S_7930 CYM50-210735-0727 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.27 2021-08-06 7770 ## S_7931 CYM50-210735-0728 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.28 2021-08-06 7771 ## S_7932 CYM50-210735-0729 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.29 2021-08-06 7772 ## S_7933 CYM50-210735-0730 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.30 2021-08-06 7773 ## S_7327 Community QC &lt;NA&gt; Ref QC &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; 7222 ## SeqID_16s Pipeline_MGS ## S_7929 7929 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output ## S_7930 7930 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output ## S_7931 7931 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output ## S_7932 7932 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output ## S_7933 7933 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output ## S_7327 7327 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output ## Pipeline_16s ## S_7929 /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7930 /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7931 /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7932 /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7933 /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7327 /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 run_RefCheck( ps = dada2_ps_genus, BRS_ID = &quot;S_7327&quot;, Ref_type = &quot;16s&quot;) ## Noting: the Reference Matrix is for 16s ## ## ############Matched baterica of the BRS sample############# ## The number of BRS&#39; bacteria matched the Reference Matrix is [3] ## g__Lactobacillus ## g__Escherichia_Shigella ## g__Enterococcus ## The number of bacteria unmatched the Reference Matrix is [12] ## g__Bifidobacterium ## g__Bacteroides ## g__Faecalibacterium ## g__Parabacteroides ## g__Collinsella ## g__Coprococcus_3 ## g__Dorea ## g__Streptococcus ## g__Roseburia ## g__Anaerostipes ## g__Prevotella_9 ## g__Eggerthella ## The number of the additional bacteria compared to the Reference Matrix is [6] ## ########################################################### ## ## ##################Status of the BRS sample################## ## Whether the BRS has the all bateria of Reference Matrix: FALSE ## Correlation Coefficient of the BRS is: 6 ## Bray Curtis of the BRS is: 0.2265 ## Impurity of the BRS is: 68.36 ## ########################################################### ## #####Final Evaluation Results of the BRS ####### ## The BRS of sequencing dataset didn&#39;t pass the cutoff of the Reference Matrix ## ########################################################### ## 8002 8003 8004 8005 8006 8007 8008 8009 S_7327 mean ## Lactobacillus 2.61732573 3.36856272 3.44379163 3.88394343 5.92927 5.780008 5.781891 6.326723 12.263006 5.48828 ## Escherichia_Shigella 15.27581475 16.00265210 12.36527954 14.08077142 10.84235 13.432037 10.157432 11.599456 12.119942 12.87508 ## Enterococcus 14.51444842 14.66472707 11.04239952 11.66901114 13.16748 12.073609 12.887711 12.849247 7.258671 12.23637 ## Impurity_level 0.08562792 0.06531291 0.05987576 0.06228054 0.00000 0.000000 0.000000 0.000000 68.360000 7.62590 ## Evaluation ## Lactobacillus S_7327 didn&#39;t pass the threshold (2022-08-09 16:05:39). ## Escherichia_Shigella S_7327 didn&#39;t pass the threshold (2022-08-09 16:05:39). ## Enterococcus S_7327 didn&#39;t pass the threshold (2022-08-09 16:05:39). ## Impurity_level S_7327 didn&#39;t pass the threshold (2022-08-09 16:05:39). dada2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = dada2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) dada2_ps_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 1948 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 1948 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 1948 tips and 1933 internal nodes ] ## refseq() DNAStringSet: [ 1948 reference sequences ] if (!dir.exists(&quot;DataSet/Step3/&quot;)) { dir.create(&quot;DataSet/Step3/&quot;) } saveRDS(dada2_ps_remove_BRS, &quot;DataSet/Step3/Donor_16s_phyloseq_remove_BRS.RDS&quot;, compress = TRUE) 10.7 Step4: Rarefaction curves dada2_ps_remove_BRS &lt;- readRDS(&quot;DataSet/Step3/Donor_16s_phyloseq_remove_BRS.RDS&quot;) plot_RarefCurve(ps = dada2_ps_remove_BRS, taxa_level = &quot;OTU&quot;, step = 400, label = &quot;Group&quot;, color = &quot;Group&quot;) ## rarefying sample S_7271 ## rarefying sample S_7272 ## rarefying sample S_7273 ## rarefying sample S_7274 ## rarefying sample S_7275 ## rarefying sample S_7276 ## rarefying sample S_7277 ## rarefying sample S_7278 ## rarefying sample S_7279 ## rarefying sample S_7280 ## rarefying sample S_7281 ## rarefying sample S_7282 ## rarefying sample S_7283 ## rarefying sample S_7284 ## rarefying sample S_7285 ## rarefying sample S_7286 ## rarefying sample S_7287 ## rarefying sample S_7288 ## rarefying sample S_7289 ## rarefying sample S_7290 ## rarefying sample S_7291 ## rarefying sample S_7292 ## rarefying sample S_7293 ## rarefying sample S_7294 ## rarefying sample S_7295 ## rarefying sample S_7296 ## rarefying sample S_7297 ## rarefying sample S_7298 ## rarefying sample S_7299 ## rarefying sample S_7300 ## rarefying sample S_7301 ## rarefying sample S_7302 ## rarefying sample S_7303 ## rarefying sample S_7304 ## rarefying sample S_7305 ## rarefying sample S_7306 ## rarefying sample S_7307 ## rarefying sample S_7308 ## rarefying sample S_7309 ## rarefying sample S_7310 ## rarefying sample S_7311 ## rarefying sample S_7312 ## rarefying sample S_7313 ## rarefying sample S_7314 ## rarefying sample S_7315 ## rarefying sample S_7316 ## rarefying sample S_7317 ## rarefying sample S_7318 ## rarefying sample S_7319 ## rarefying sample S_7320 ## rarefying sample S_7321 ## rarefying sample S_7322 ## rarefying sample S_7323 ## rarefying sample S_7324 ## rarefying sample S_7325 ## rarefying sample S_7326 ## rarefying sample S_7846 ## rarefying sample S_7847 ## rarefying sample S_7848 ## rarefying sample S_7849 ## rarefying sample S_7850 ## rarefying sample S_7851 ## rarefying sample S_7852 ## rarefying sample S_7853 ## rarefying sample S_7854 ## rarefying sample S_7855 ## rarefying sample S_7856 ## rarefying sample S_7857 ## rarefying sample S_7858 ## rarefying sample S_7859 ## rarefying sample S_7860 ## rarefying sample S_7861 ## rarefying sample S_7862 ## rarefying sample S_7863 ## rarefying sample S_7864 ## rarefying sample S_7865 ## rarefying sample S_7866 ## rarefying sample S_7867 ## rarefying sample S_7868 ## rarefying sample S_7869 ## rarefying sample S_7870 ## rarefying sample S_7871 ## rarefying sample S_7872 ## rarefying sample S_7873 ## rarefying sample S_7874 ## rarefying sample S_7875 ## rarefying sample S_7876 ## rarefying sample S_7877 ## rarefying sample S_7878 ## rarefying sample S_7879 ## rarefying sample S_7880 ## rarefying sample S_7881 ## rarefying sample S_7882 ## rarefying sample S_7883 ## rarefying sample S_7884 ## rarefying sample S_7885 ## rarefying sample S_7886 ## rarefying sample S_7887 ## rarefying sample S_7888 ## rarefying sample S_7889 ## rarefying sample S_7890 ## rarefying sample S_7891 ## rarefying sample S_7892 ## rarefying sample S_7893 ## rarefying sample S_7894 ## rarefying sample S_7895 ## rarefying sample S_7896 ## rarefying sample S_7897 ## rarefying sample S_7898 ## rarefying sample S_7899 ## rarefying sample S_7900 ## rarefying sample S_7901 ## rarefying sample S_7902 ## rarefying sample S_7903 ## rarefying sample S_7904 ## rarefying sample S_7905 ## rarefying sample S_7906 ## rarefying sample S_7907 ## rarefying sample S_7908 ## rarefying sample S_7909 ## rarefying sample S_7910 ## rarefying sample S_7911 ## rarefying sample S_7912 ## rarefying sample S_7913 ## rarefying sample S_7914 ## rarefying sample S_7915 ## rarefying sample S_7916 ## rarefying sample S_7917 ## rarefying sample S_7918 ## rarefying sample S_7919 ## rarefying sample S_7920 ## rarefying sample S_7921 ## rarefying sample S_7922 ## rarefying sample S_7923 ## rarefying sample S_7924 ## rarefying sample S_7925 ## rarefying sample S_7926 ## rarefying sample S_7927 ## rarefying sample S_7928 ## rarefying sample S_7929 ## rarefying sample S_7930 ## rarefying sample S_7931 ## rarefying sample S_7932 ## rarefying sample S_7933 Figure 10.2: Rarefaction curves (Example) 10.8 Step5: Rarefy otu counts dada2_ps_remove_BRS &lt;- readRDS(&quot;DataSet/Step3/Donor_16s_phyloseq_remove_BRS.RDS&quot;) summarize_phyloseq(ps = dada2_ps_remove_BRS) ## [[1]] ## [1] &quot;1] Min. number of reads = 33267&quot; ## ## [[2]] ## [1] &quot;2] Max. number of reads = 153367&quot; ## ## [[3]] ## [1] &quot;3] Total number of reads = 10909876&quot; ## ## [[4]] ## [1] &quot;4] Average number of reads = 75763.0277777778&quot; ## ## [[5]] ## [1] &quot;5] Median number of reads = 71985.5&quot; ## ## [[6]] ## [1] &quot;7] Sparsity = 0.912599104494638&quot; ## ## [[7]] ## [1] &quot;6] Any OTU sum to 1 or less? YES&quot; ## ## [[8]] ## [1] &quot;8] Number of singletons = 837&quot; ## ## [[9]] ## [1] &quot;9] Percent of OTUs that are singletons\\n (i.e. exactly one read detected across all samples)0&quot; ## ## [[10]] ## [1] &quot;10] Number of sample variables are: 12&quot; ## ## [[11]] ## [1] &quot;SampleTubeID&quot; &quot;Group&quot; &quot;Date_Sequencing&quot; &quot;ProductID&quot; &quot;SampleType&quot; &quot;ProductBatch&quot; ## [7] &quot;Date_Sampling&quot; &quot;Date_Receiving&quot; &quot;SeqID_MGS&quot; &quot;SeqID_16s&quot; &quot;Pipeline_MGS&quot; &quot;Pipeline_16s&quot; dada2_ps_rare &lt;- norm_rarefy(object = dada2_ps_remove_BRS, size = 33267) dada2_ps_rare ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 1091 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 1091 taxa by 7 taxonomic ranks ] ## phy_tree() Phylogenetic Tree: [ 1091 tips and 1086 internal nodes ] ## refseq() DNAStringSet: [ 1091 reference sequences ] if (!dir.exists(&quot;DataSet/Step5/&quot;)) { dir.create(&quot;DataSet/Step5/&quot;) } saveRDS(dada2_ps_rare, &quot;DataSet/Step5/Donor_16s_phyloseq_remove_BRS_rare.RDS&quot;, compress = TRUE) 10.9 Step6: Extracting specific taxonomic level dada2_ps_rare &lt;- readRDS(&quot;DataSet/Step5/Donor_16s_phyloseq_remove_BRS_rare.RDS&quot;) dada2_ps_rare_genus &lt;- summarize_taxa(ps = dada2_ps_rare, taxa_level = &quot;Genus&quot;) dada2_ps_rare_genus ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 225 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 225 taxa by 6 taxonomic ranks ] dada2_ps_rare_order &lt;- summarize_taxa(ps = dada2_ps_rare, taxa_level = &quot;Order&quot;) dada2_ps_rare_order ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 37 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 37 taxa by 4 taxonomic ranks ] dada2_ps_rare_phylum &lt;- summarize_taxa(ps = dada2_ps_rare, taxa_level = &quot;Phylum&quot;) dada2_ps_rare_phylum ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 15 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 15 taxa by 2 taxonomic ranks ] if (!dir.exists(&quot;DataSet/Step6/&quot;)) { dir.create(&quot;DataSet/Step6/&quot;) } saveRDS(dada2_ps_rare_genus, &quot;DataSet/Step6/Donor_16s_phyloseq_remove_BRS_rare_genus.RDS&quot;, compress = TRUE) saveRDS(dada2_ps_rare_order, &quot;DataSet/Step6/Donor_16s_phyloseq_remove_BRS_rare_order.RDS&quot;, compress = TRUE) saveRDS(dada2_ps_rare_phylum, &quot;DataSet/Step6/Donor_16s_phyloseq_remove_BRS_rare_phylum.RDS&quot;, compress = TRUE) 10.10 Step7: GlobalView dada2_ps_rare_genus &lt;- readRDS(&quot;DataSet/Step6/Donor_16s_phyloseq_remove_BRS_rare_genus.RDS&quot;) # alpha dada2_ps_rare_genus_alpha &lt;- run_alpha_diversity(ps = dada2_ps_rare_genus, measures = c(&quot;Shannon&quot;, &quot;Chao1&quot;, &quot;Observed&quot;)) plot_boxplot(data = dada2_ps_rare_genus_alpha, y_index = c(&quot;Shannon&quot;, &quot;Chao1&quot;, &quot;Observed&quot;), group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), group_color = c(&quot;red&quot;, &quot;blue&quot;)) Figure 10.3: diversity and ordination and composition(Example) # beta dada2_ps_beta &lt;- run_beta_diversity(ps = dada2_ps_rare_genus, method = &quot;bray&quot;) plot_distance_corrplot(datMatrix = dada2_ps_beta$BetaDistance) Figure 10.4: diversity and ordination and composition(Example) # permanova dada2_ps_per &lt;- run_permanova(ps = dada2_ps_rare_genus, method = &quot;bray&quot;, columns = &quot;Group&quot;) print(dada2_ps_per) ## SumsOfSample Df SumsOfSqs MeanSqs F.Model R2 Pr(&gt;F) AdjustedPvalue ## Group 144 1 1.335187 1.335187 9.669403 0.06375315 0.001 0.001 # beta dispersion beta_df &lt;- run_beta_diversity(ps = dada2_ps_rare_genus, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.04375 0.043749 5.6785 999 0.016 * ## Residuals 142 1.09402 0.007704 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## Product Stool ## Product 0.017 ## Stool 0.018497 # ordination dada2_ps_ordination &lt;- run_ordination( ps = dada2_ps_rare_genus, group = &quot;Group&quot;, method = &quot;PCoA&quot;) plot_Ordination(ResultList = dada2_ps_ordination, group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), group_color = c(&quot;blue&quot;, &quot;red&quot;)) Figure 10.5: diversity and ordination and composition(Example) # Microbial composition plot_stacked_bar_XIVZ( phyloseq = dada2_ps_rare_genus, level = &quot;Phylum&quot;, feature = &quot;Group&quot;) Figure 10.6: diversity and ordination and composition(Example) 10.11 Step8: Differential Analysis dada2_ps_rare_genus &lt;- readRDS(&quot;DataSet/Step6/Donor_16s_phyloseq_remove_BRS_rare_genus.RDS&quot;) # filter &amp; trim dada2_ps_rare_genus_filter &lt;- run_filter(ps = dada2_ps_rare_genus, cutoff = 10, unclass = TRUE) dada2_ps_rare_genus_filter_trim &lt;- run_trim(object = dada2_ps_rare_genus_filter, cutoff = 0.1, trim = &quot;feature&quot;) dada2_ps_rare_genus_filter_trim ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 127 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 127 taxa by 6 taxonomic ranks ] # lefse dada2_ps_lefse &lt;- run_lefse( ps = dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), norm = &quot;CPM&quot;, Lda = 2) # # don&#39;t run this code when you do lefse in reality # dada2_ps_lefse$LDA_Score &lt;- dada2_ps_lefse$LDA_Score * 1000 plot_lefse( da_res = dada2_ps_lefse, x_index = &quot;LDA_Score&quot;, x_index_cutoff = 2, group_color = c(&quot;green&quot;, &quot;red&quot;)) Figure 10.7: Differential Analysis (Example) dada2_ps_wilcox &lt;- run_wilcox( ps = dada2_ps_rare_genus_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;)) plot_volcano( da_res = dada2_ps_wilcox, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), x_index = &quot;Log2FoldChange (Rank)\\nStool_vs_Product&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, group_color = c(&quot;red&quot;, &quot;grey&quot;, &quot;blue&quot;), topN = 5) Figure 10.8: Differential Analysis (Example) if (!dir.exists(&quot;DataSet/Step8/&quot;)) { dir.create(&quot;DataSet/Step8/&quot;) } saveRDS(dada2_ps_rare_genus_filter_trim, &quot;DataSet/Step8/Donor_16s_phyloseq_remove_BRS_rare_genus_filter_trim.RDS&quot;, compress = TRUE) 10.12 Systematic Information devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.2 (2021-11-01) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2022-08-09 ## rstudio 2022.07.1+554 Spotted Wakerobin (desktop) ## pandoc 2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.1.0) ## ade4 1.7-18 2021-09-16 [1] CRAN (R 4.1.0) ## ALDEx2 1.26.0 2021-10-26 [1] Bioconductor ## annotate 1.72.0 2021-10-26 [1] Bioconductor ## AnnotationDbi 1.56.2 2021-11-09 [1] Bioconductor ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.1.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [1] CRAN (R 4.1.0) ## Biobase 2.54.0 2021-10-26 [1] Bioconductor ## BiocGenerics 0.40.0 2021-10-26 [1] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [1] Bioconductor ## biomformat 1.22.0 2021-10-26 [1] Bioconductor ## Biostrings 2.62.0 2021-10-26 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] CRAN (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] CRAN (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] CRAN (R 4.1.0) ## bookdown 0.27 2022-06-14 [1] CRAN (R 4.1.2) ## brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0) ## broom 0.7.12 2022-01-28 [1] CRAN (R 4.1.2) ## bslib 0.3.1 2021-10-06 [1] CRAN (R 4.1.0) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0) ## callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0) ## car 3.0-12 2021-11-06 [1] CRAN (R 4.1.0) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [1] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [1] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.1.0) ## checkmate 2.0.0 2020-02-06 [1] CRAN (R 4.1.0) ## cli 3.3.0 2022-04-25 [1] CRAN (R 4.1.2) ## cluster 2.1.2 2021-04-17 [1] CRAN (R 4.1.2) ## codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [1] CRAN (R 4.1.0) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2) ## conflicted 1.1.0 2021-11-26 [1] CRAN (R 4.1.0) ## corpcor 1.6.10 2021-09-16 [1] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [1] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.1.0) ## crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2) ## data.table 1.14.2 2021-09-27 [1] CRAN (R 4.1.0) ## DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0) ## DelayedArray 0.20.0 2021-10-26 [1] Bioconductor ## deldir 1.0-6 2021-10-23 [1] CRAN (R 4.1.0) ## desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2) ## DESeq2 1.34.0 2021-10-26 [1] Bioconductor ## devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0) ## digest 0.6.29 2021-12-01 [1] CRAN (R 4.1.0) ## doParallel 1.0.17 2022-02-07 [1] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [1] CRAN (R 4.1.2) ## dplyr * 1.0.8 2022-02-08 [1] CRAN (R 4.1.2) ## dynamicTreeCut 1.63-1 2016-03-11 [1] CRAN (R 4.1.0) ## edgeR 3.36.0 2021-10-26 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0) ## evaluate 0.15 2022-02-18 [1] CRAN (R 4.1.2) ## fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2) ## farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0) ## fastcluster 1.2.3 2021-05-24 [1] CRAN (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0) ## fdrtool 1.2.17 2021-11-13 [1] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [1] CRAN (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] CRAN (R 4.1.0) ## foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2) ## foreign 0.8-82 2022-01-13 [1] CRAN (R 4.1.2) ## forestplot 2.0.1 2021-09-03 [1] CRAN (R 4.1.0) ## Formula 1.2-4 2020-10-16 [1] CRAN (R 4.1.0) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [1] Bioconductor ## geneplotter 1.72.0 2021-10-26 [1] Bioconductor ## generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2) ## GenomeInfoDb 1.30.1 2022-01-30 [1] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [1] Bioconductor ## GenomicRanges 1.46.1 2021-11-18 [1] Bioconductor ## ggplot2 * 3.3.5 2021-06-25 [1] CRAN (R 4.1.0) ## ggpubr * 0.4.0 2020-06-27 [1] CRAN (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] CRAN (R 4.1.0) ## ggsignif 0.6.3 2021-09-09 [1] CRAN (R 4.1.0) ## glasso 1.11 2019-10-01 [1] CRAN (R 4.1.0) ## glmnet 4.1-3 2021-11-02 [1] CRAN (R 4.1.0) ## glue * 1.6.2 2022-02-24 [1] CRAN (R 4.1.2) ## Gmisc * 3.0.0 2022-01-03 [1] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [1] Bioconductor ## gplots 3.1.1 2020-11-28 [1] CRAN (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] CRAN (R 4.1.0) ## highr 0.9 2021-04-16 [1] CRAN (R 4.1.0) ## Hmisc 4.6-0 2021-10-07 [1] CRAN (R 4.1.0) ## htmlTable * 2.4.0 2022-01-04 [1] CRAN (R 4.1.2) ## htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.1.0) ## htmlwidgets 1.5.4 2021-09-08 [1] CRAN (R 4.1.0) ## httr 1.4.2 2020-07-20 [1] CRAN (R 4.1.0) ## huge 1.3.5 2021-06-30 [1] CRAN (R 4.1.0) ## igraph 1.2.11 2022-01-04 [1] CRAN (R 4.1.2) ## impute 1.68.0 2021-10-26 [1] Bioconductor ## IRanges 2.28.0 2021-10-26 [1] Bioconductor ## irlba 2.3.5 2021-12-06 [1] CRAN (R 4.1.0) ## iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2) ## jpeg 0.1-9 2021-07-24 [1] CRAN (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.1.0) ## jsonlite 1.8.0 2022-02-22 [1] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [1] CRAN (R 4.1.2) ## knitr 1.39 2022-04-26 [1] CRAN (R 4.1.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0) ## lattice 0.20-45 2021-09-22 [1] CRAN (R 4.1.2) ## latticeExtra 0.6-29 2019-12-19 [1] CRAN (R 4.1.0) ## lavaan 0.6-11 2022-03-31 [1] CRAN (R 4.1.2) ## libcoin 1.0-9 2021-09-27 [1] CRAN (R 4.1.0) ## lifecycle 1.0.1 2021-09-24 [1] CRAN (R 4.1.0) ## limma 3.50.1 2022-02-17 [1] Bioconductor ## locfit 1.5-9.5 2022-03-03 [1] CRAN (R 4.1.2) ## lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0) ## magrittr * 2.0.2 2022-01-26 [1] CRAN (R 4.1.2) ## MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2) ## Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0) ## MatrixGenerics 1.6.0 2021-10-26 [1] Bioconductor ## matrixStats 0.61.0 2021-09-17 [1] CRAN (R 4.1.0) ## mbzinb 0.2 2022-03-16 [1] local ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [1] Bioconductor ## mgcv 1.8-39 2022-02-24 [1] CRAN (R 4.1.2) ## mixedCCA 1.5.2 2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3) ## mnormt 2.0.2 2020-09-01 [1] CRAN (R 4.1.0) ## modeltools 0.2-23 2020-03-05 [1] CRAN (R 4.1.0) ## multcomp 1.4-18 2022-01-04 [1] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0) ## mvtnorm 1.1-3 2021-10-08 [1] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [1] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2) ## nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2) ## pbapply 1.5-0 2021-09-16 [1] CRAN (R 4.1.0) ## pbivnorm 0.6.0 2015-01-23 [1] CRAN (R 4.1.0) ## pcaPP 1.9-74 2021-04-23 [1] CRAN (R 4.1.0) ## permute 0.9-7 2022-01-27 [1] CRAN (R 4.1.2) ## pheatmap 1.0.12 2019-01-04 [1] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [1] Bioconductor ## pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2) ## pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0) ## pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0) ## png 0.1-7 2013-12-03 [1] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [1] Bioconductor ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0) ## processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0) ## proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0) ## ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0) ## pscl 1.5.5 2020-03-07 [1] CRAN (R 4.1.0) ## psych 2.2.5 2022-05-10 [1] CRAN (R 4.1.2) ## pulsar 0.3.7 2020-08-07 [1] CRAN (R 4.1.0) ## purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0) ## qgraph 1.9.2 2022-03-04 [1] CRAN (R 4.1.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0) ## rbibutils 2.2.7 2021-12-07 [1] CRAN (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] CRAN (R 4.1.0) ## Rcpp * 1.0.8.2 2022-03-11 [1] CRAN (R 4.1.2) ## RcppZiggurat 0.1.6 2020-10-20 [1] CRAN (R 4.1.0) ## RCurl 1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2) ## Rdpack 2.2 2022-03-19 [1] CRAN (R 4.1.2) ## readxl * 1.4.0 2022-03-28 [1] CRAN (R 4.1.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0) ## Rfast 2.0.6 2022-02-16 [1] CRAN (R 4.1.2) ## rhdf5 2.38.1 2022-03-10 [1] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [1] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [1] Bioconductor ## rlang 1.0.2 2022-03-04 [1] CRAN (R 4.1.2) ## rmarkdown 2.14 2022-04-25 [1] CRAN (R 4.1.2) ## rootSolve 1.8.2.3 2021-09-29 [1] CRAN (R 4.1.0) ## rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2) ## rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0) ## RSQLite 2.2.10 2022-02-17 [1] CRAN (R 4.1.2) ## rstatix 0.7.0 2021-02-13 [1] CRAN (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0) ## S4Vectors 0.32.3 2021-11-21 [1] Bioconductor ## sandwich 3.0-1 2021-05-18 [1] CRAN (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] CRAN (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] CRAN (R 4.1.0) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [1] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [1] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.6 2021-11-29 [1] CRAN (R 4.1.0) ## stringr 1.4.0 2019-02-10 [1] CRAN (R 4.1.0) ## SummarizedExperiment 1.24.0 2021-10-26 [1] Bioconductor ## survival 3.3-1 2022-03-03 [1] CRAN (R 4.1.2) ## testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2) ## TH.data 1.1-0 2021-09-27 [1] CRAN (R 4.1.0) ## tibble * 3.1.6 2021-11-07 [1] CRAN (R 4.1.0) ## tidyr 1.2.0 2022-02-01 [1] CRAN (R 4.1.2) ## tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2) ## tmvnsim 1.0-2 2016-12-15 [1] CRAN (R 4.1.0) ## truncnorm 1.0-8 2018-02-27 [1] CRAN (R 4.1.0) ## usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.1.0) ## vegan 2.5-7 2020-11-28 [1] CRAN (R 4.1.0) ## VGAM 1.1-6 2022-02-14 [1] CRAN (R 4.1.2) ## WGCNA 1.71 2022-04-22 [1] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [1] Bioconductor ## xfun 0.30 2022-03-02 [1] CRAN (R 4.1.2) ## XMAS2 * 2.1.7.4 2022-08-09 [1] local ## XML 3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [1] Bioconductor ## yaml 2.3.5 2022-02-21 [1] CRAN (R 4.1.2) ## zCompositions 1.4.0 2022-01-13 [1] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] CRAN (R 4.1.0) ## ## [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
