<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Network Analysis | 16s microbiota data analysis based on XMAS package</title>
  <meta name="description" content="Chapter 9 Network Analysis | 16s microbiota data analysis based on XMAS package" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Network Analysis | 16s microbiota data analysis based on XMAS package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 9 Network Analysis | 16s microbiota data analysis based on XMAS package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Network Analysis | 16s microbiota data analysis based on XMAS package" />
  
  <meta name="twitter:description" content="Chapter 9 Network Analysis | 16s microbiota data analysis based on XMAS package" />
  

<meta name="author" content="Hua Zou" />


<meta name="date" content="2022-08-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="differential-analysis.html"/>
<link rel="next" href="test-example.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">16s microbiota data analysis based on XMAS package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#preparing-for-the-tutorial"><i class="fa fa-check"></i><b>1.1</b> Preparing for the tutorial</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#workflow-description"><i class="fa fa-check"></i><b>1.2</b> Workflow description</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html"><i class="fa fa-check"></i><b>2</b> Convert inputdata into phyloseq object</a>
<ul>
<li class="chapter" data-level="2.1" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#dada2"><i class="fa fa-check"></i><b>2.1</b> DADA2</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#importing-results-from-dada2-pipeline"><i class="fa fa-check"></i><b>2.1.1</b> Importing results from dada2 pipeline</a></li>
<li class="chapter" data-level="2.1.2" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#taxa-table"><i class="fa fa-check"></i><b>2.1.2</b> taxa table</a></li>
<li class="chapter" data-level="2.1.3" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#otu-table"><i class="fa fa-check"></i><b>2.1.3</b> otu table</a></li>
<li class="chapter" data-level="2.1.4" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#metadata-table"><i class="fa fa-check"></i><b>2.1.4</b> metadata table</a></li>
<li class="chapter" data-level="2.1.5" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#phyloseq-object"><i class="fa fa-check"></i><b>2.1.5</b> phyloseq object</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#summarize-phyloseq-class-object"><i class="fa fa-check"></i><b>2.2</b> Summarize phyloseq-class object</a></li>
<li class="chapter" data-level="2.3" data-path="convert-inputdata-into-phyloseq-object.html"><a href="convert-inputdata-into-phyloseq-object.html#systematic-information"><i class="fa fa-check"></i><b>2.3</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="quality-control.html"><a href="quality-control.html"><i class="fa fa-check"></i><b>3</b> Quality Control</a>
<ul>
<li class="chapter" data-level="3.1" data-path="quality-control.html"><a href="quality-control.html#reads-track-by-dada2"><i class="fa fa-check"></i><b>3.1</b> Reads’ track by DADA2</a></li>
<li class="chapter" data-level="3.2" data-path="quality-control.html"><a href="quality-control.html#spike-in-sample-brs-assessment"><i class="fa fa-check"></i><b>3.2</b> Spike-in sample (BRS) assessment</a></li>
<li class="chapter" data-level="3.3" data-path="quality-control.html"><a href="quality-control.html#spike-in-samples-brs-remove"><i class="fa fa-check"></i><b>3.3</b> Spike-in sample’s (BRS) remove</a></li>
<li class="chapter" data-level="3.4" data-path="quality-control.html"><a href="quality-control.html#rarefaction-curves"><i class="fa fa-check"></i><b>3.4</b> Rarefaction curves</a></li>
<li class="chapter" data-level="3.5" data-path="quality-control.html"><a href="quality-control.html#summarize-phyloseq-class-object-1"><i class="fa fa-check"></i><b>3.5</b> Summarize phyloseq-class object</a></li>
<li class="chapter" data-level="3.6" data-path="quality-control.html"><a href="quality-control.html#systematic-information-1"><i class="fa fa-check"></i><b>3.6</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-processing.html"><a href="data-processing.html"><i class="fa fa-check"></i><b>4</b> Data processing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-processing.html"><a href="data-processing.html#rarefy-otu-counts"><i class="fa fa-check"></i><b>4.1</b> Rarefy otu counts</a></li>
<li class="chapter" data-level="4.2" data-path="data-processing.html"><a href="data-processing.html#extracting-specific-taxonomic-level"><i class="fa fa-check"></i><b>4.2</b> Extracting specific taxonomic level</a></li>
<li class="chapter" data-level="4.3" data-path="data-processing.html"><a href="data-processing.html#systematic-information-2"><i class="fa fa-check"></i><b>4.3</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="diversity-analysis.html"><a href="diversity-analysis.html"><i class="fa fa-check"></i><b>5</b> Diversity analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="diversity-analysis.html"><a href="diversity-analysis.html#alpha-diveristy"><i class="fa fa-check"></i><b>5.1</b> Alpha diveristy</a></li>
<li class="chapter" data-level="5.2" data-path="diversity-analysis.html"><a href="diversity-analysis.html#beta-diversity"><i class="fa fa-check"></i><b>5.2</b> Beta diversity</a></li>
<li class="chapter" data-level="5.3" data-path="diversity-analysis.html"><a href="diversity-analysis.html#systematic-information-3"><i class="fa fa-check"></i><b>5.3</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="permanova-beta-dispersion-ordination.html"><a href="permanova-beta-dispersion-ordination.html"><i class="fa fa-check"></i><b>6</b> PERMANOVA + beta dispersion + Ordination</a>
<ul>
<li class="chapter" data-level="6.1" data-path="permanova-beta-dispersion-ordination.html"><a href="permanova-beta-dispersion-ordination.html#permanova"><i class="fa fa-check"></i><b>6.1</b> PERMANOVA</a></li>
<li class="chapter" data-level="6.2" data-path="permanova-beta-dispersion-ordination.html"><a href="permanova-beta-dispersion-ordination.html#beta-dispersion"><i class="fa fa-check"></i><b>6.2</b> beta dispersion</a></li>
<li class="chapter" data-level="6.3" data-path="permanova-beta-dispersion-ordination.html"><a href="permanova-beta-dispersion-ordination.html#ordination"><i class="fa fa-check"></i><b>6.3</b> Ordination</a></li>
<li class="chapter" data-level="6.4" data-path="permanova-beta-dispersion-ordination.html"><a href="permanova-beta-dispersion-ordination.html#systematic-information-4"><i class="fa fa-check"></i><b>6.4</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="microbial-composition.html"><a href="microbial-composition.html"><i class="fa fa-check"></i><b>7</b> Microbial composition</a>
<ul>
<li class="chapter" data-level="7.1" data-path="microbial-composition.html"><a href="microbial-composition.html#stacked-barplot"><i class="fa fa-check"></i><b>7.1</b> Stacked barplot</a></li>
<li class="chapter" data-level="7.2" data-path="microbial-composition.html"><a href="microbial-composition.html#core-microbiota"><i class="fa fa-check"></i><b>7.2</b> Core microbiota</a></li>
<li class="chapter" data-level="7.3" data-path="microbial-composition.html"><a href="microbial-composition.html#systematic-information-5"><i class="fa fa-check"></i><b>7.3</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="differential-analysis.html"><a href="differential-analysis.html"><i class="fa fa-check"></i><b>8</b> Differential Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="differential-analysis.html"><a href="differential-analysis.html#filtering-and-trimming"><i class="fa fa-check"></i><b>8.1</b> Filtering and trimming</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="differential-analysis.html"><a href="differential-analysis.html#filtering-the-low-relative-abundance-or-unclassified-taxa-by-the-threshold-total-counts-10"><i class="fa fa-check"></i><b>8.1.1</b> Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 10)</a></li>
<li class="chapter" data-level="8.1.2" data-path="differential-analysis.html"><a href="differential-analysis.html#trimming-the-taxa-with-low-occurrence-less-than-threshold"><i class="fa fa-check"></i><b>8.1.2</b> Trimming the taxa with low occurrence less than threshold</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="differential-analysis.html"><a href="differential-analysis.html#liner-discriminant-analysis-lda-effect-size-lefse"><i class="fa fa-check"></i><b>8.2</b> Liner discriminant analysis (LDA) effect size (LEfSe)</a></li>
<li class="chapter" data-level="8.3" data-path="differential-analysis.html"><a href="differential-analysis.html#wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>8.3</b> Wilcoxon Rank-Sum test</a></li>
<li class="chapter" data-level="8.4" data-path="differential-analysis.html"><a href="differential-analysis.html#dominant-taxa"><i class="fa fa-check"></i><b>8.4</b> Dominant taxa</a></li>
<li class="chapter" data-level="8.5" data-path="differential-analysis.html"><a href="differential-analysis.html#multiple-differential-analysis-by-one-function"><i class="fa fa-check"></i><b>8.5</b> Multiple differential analysis by one function</a></li>
<li class="chapter" data-level="8.6" data-path="differential-analysis.html"><a href="differential-analysis.html#systematic-information-6"><i class="fa fa-check"></i><b>8.6</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>9</b> Network Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="network-analysis.html"><a href="network-analysis.html#importing-data"><i class="fa fa-check"></i><b>9.1</b> Importing data</a></li>
<li class="chapter" data-level="9.2" data-path="network-analysis.html"><a href="network-analysis.html#single-network-with-pearson-correlation-as-association-measure"><i class="fa fa-check"></i><b>9.2</b> Single network with Pearson correlation as association measure</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="network-analysis.html"><a href="network-analysis.html#building-network-model"><i class="fa fa-check"></i><b>9.2.1</b> Building network model</a></li>
<li class="chapter" data-level="9.2.2" data-path="network-analysis.html"><a href="network-analysis.html#analyzing-the-constructed-network"><i class="fa fa-check"></i><b>9.2.2</b> Analyzing the constructed network</a></li>
<li class="chapter" data-level="9.2.3" data-path="network-analysis.html"><a href="network-analysis.html#visualizing-the-network"><i class="fa fa-check"></i><b>9.2.3</b> Visualizing the network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="network-analysis.html"><a href="network-analysis.html#single-network-with-sparcc-correlation-as-association-measure"><i class="fa fa-check"></i><b>9.3</b> Single network with sparcc correlation as association measure</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="network-analysis.html"><a href="network-analysis.html#building-network-model-1"><i class="fa fa-check"></i><b>9.3.1</b> Building network model</a></li>
<li class="chapter" data-level="9.3.2" data-path="network-analysis.html"><a href="network-analysis.html#analyzing-the-constructed-network-1"><i class="fa fa-check"></i><b>9.3.2</b> Analyzing the constructed network</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="network-analysis.html"><a href="network-analysis.html#dissimilarity-based-networks"><i class="fa fa-check"></i><b>9.4</b> Dissimilarity-based Networks</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="network-analysis.html"><a href="network-analysis.html#building-network-module"><i class="fa fa-check"></i><b>9.4.1</b> Building network module</a></li>
<li class="chapter" data-level="9.4.2" data-path="network-analysis.html"><a href="network-analysis.html#analyzing-the-constructed-network-2"><i class="fa fa-check"></i><b>9.4.2</b> Analyzing the constructed network</a></li>
<li class="chapter" data-level="9.4.3" data-path="network-analysis.html"><a href="network-analysis.html#visualizing-the-network-2"><i class="fa fa-check"></i><b>9.4.3</b> Visualizing the network</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="network-analysis.html"><a href="network-analysis.html#systematic-information-7"><i class="fa fa-check"></i><b>9.5</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="test-example.html"><a href="test-example.html"><i class="fa fa-check"></i><b>10</b> Test Example</a>
<ul>
<li class="chapter" data-level="10.1" data-path="test-example.html"><a href="test-example.html#loading-packages"><i class="fa fa-check"></i><b>10.1</b> Loading packages</a></li>
<li class="chapter" data-level="10.2" data-path="test-example.html"><a href="test-example.html#loading-data"><i class="fa fa-check"></i><b>10.2</b> Loading data</a></li>
<li class="chapter" data-level="10.3" data-path="test-example.html"><a href="test-example.html#metaphlan2-result"><i class="fa fa-check"></i><b>10.3</b> Metaphlan2 result</a></li>
<li class="chapter" data-level="10.4" data-path="test-example.html"><a href="test-example.html#step1-reads-track"><i class="fa fa-check"></i><b>10.4</b> Step1: Reads’ Track</a></li>
<li class="chapter" data-level="10.5" data-path="test-example.html"><a href="test-example.html#step2-convert-inputs-into-phyloseq-data"><i class="fa fa-check"></i><b>10.5</b> Step2: Convert inputs into phyloseq data</a></li>
<li class="chapter" data-level="10.6" data-path="test-example.html"><a href="test-example.html#step3-brs-checking"><i class="fa fa-check"></i><b>10.6</b> Step3: BRS checking</a></li>
<li class="chapter" data-level="10.7" data-path="test-example.html"><a href="test-example.html#step4-rarefaction-curves"><i class="fa fa-check"></i><b>10.7</b> Step4: Rarefaction curves</a></li>
<li class="chapter" data-level="10.8" data-path="test-example.html"><a href="test-example.html#step5-rarefy-otu-counts"><i class="fa fa-check"></i><b>10.8</b> Step5: Rarefy otu counts</a></li>
<li class="chapter" data-level="10.9" data-path="test-example.html"><a href="test-example.html#step6-extracting-specific-taxonomic-level"><i class="fa fa-check"></i><b>10.9</b> Step6: Extracting specific taxonomic level</a></li>
<li class="chapter" data-level="10.10" data-path="test-example.html"><a href="test-example.html#step7-globalview"><i class="fa fa-check"></i><b>10.10</b> Step7: GlobalView</a></li>
<li class="chapter" data-level="10.11" data-path="test-example.html"><a href="test-example.html#step8-differential-analysis"><i class="fa fa-check"></i><b>10.11</b> Step8: Differential Analysis</a></li>
<li class="chapter" data-level="10.12" data-path="test-example.html"><a href="test-example.html#systematic-information-8"><i class="fa fa-check"></i><b>10.12</b> Systematic Information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">16s microbiota data analysis based on XMAS package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="network-analysis" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Network Analysis<a href="network-analysis.html#network-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Estimating microbial association networks from high-throughput sequencing data is a common exploratory data analysis approach aiming at understanding the complex interplay of microbial communities in their natural habitat. Statistical network estimation workflows comprise several analysis steps, including methods for zero handling, data normalization and computing microbial associations. Since microbial interactions are likely to change between conditions, e.g. between healthy individuals and patients, identifying network differences between groups is often an integral secondary analysis step.</p>
</blockquote>
<p>NetCoMi (Network Construction and Comparison for Microbiome Data) <span class="citation">(<a href="#ref-peschel2021netcomi" role="doc-biblioref">Peschel et al. 2021</a>)</span> provides functionality for constructing, analyzing, and comparing networks suitable for the application on microbial compositional data.</p>
<p>The following information is from <a href="https://github.com/stefpeschel/NetCoMi">NetCoMi github</a>.</p>
<p><strong>Association measures:</strong></p>
<ul>
<li>Pearson coefficient
(<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor"><code>cor()</code></a>
from <code>stats</code> package)</li>
<li>Spearman coefficient
(<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor"><code>cor()</code></a>
from <code>stats</code> package)</li>
<li>Biweight Midcorrelation
<a href="https://rdrr.io/cran/WGCNA/man/bicor.html"><code>bicor()</code></a> from <code>WGCNA</code>
package</li>
<li>SparCC
(<a href="https://rdrr.io/github/zdk123/SpiecEasi/man/sparcc.html"><code>sparcc()</code></a>
from <code>SpiecEasi</code> package)</li>
<li>CCLasso (<a href="https://github.com/huayingfang/CCLasso">R code on GitHub</a>)</li>
<li>CCREPE
(<a href="https://bioconductor.org/packages/release/bioc/html/ccrepe.html"><code>ccrepe</code></a>
package)</li>
<li>SpiecEasi (<a href="https://github.com/zdk123/SpiecEasi"><code>SpiecEasi</code></a>
package)</li>
<li>SPRING (<a href="https://github.com/GraceYoon/SPRING"><code>SPRING</code></a> package)</li>
<li>gCoda (<a href="https://github.com/huayingfang/gCoda">R code on GitHub</a>)</li>
<li>propr
(<a href="https://cran.r-project.org/web/packages/propr/index.html"><code>propr</code></a>
package)</li>
</ul>
<p><strong>Dissimilarity measures:</strong></p>
<ul>
<li>Euclidean distance
(<a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/vegdist"><code>vegdist()</code></a>
from <code>vegan</code> package)</li>
<li>Bray-Curtis dissimilarity
(<a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/vegdist"><code>vegdist()</code></a>
from <code>vegan</code> package)</li>
<li>Kullback-Leibler divergence (KLD)
(<a href="https://rdrr.io/cran/LaplacesDemon/man/KLD.html"><code>KLD()</code></a> from
<code>LaplacesDemon</code> package)</li>
<li>Jeffrey divergence (own code using
<a href="https://rdrr.io/cran/LaplacesDemon/man/KLD.html"><code>KLD()</code></a> from
<code>LaplacesDemon</code> package)</li>
<li>Jensen-Shannon divergence (own code using
<a href="https://rdrr.io/cran/LaplacesDemon/man/KLD.html"><code>KLD()</code></a> from
<code>LaplacesDemon</code> package)</li>
<li>Compositional KLD (own implementation following [Martín-Fernández
et al., 1999])</li>
<li>Aitchison distance
(<a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/vegdist"><code>vegdist()</code></a>
and <a href="https://rdrr.io/github/zdk123/SpiecEasi/man/clr.html"><code>clr()</code></a>
from <code>SpiecEasi</code> package)</li>
</ul>
<p><strong>Methods for zero replacement:</strong></p>
<ul>
<li>Adding a predefined pseudo count</li>
<li>Multiplicative replacement
(<a href="https://rdrr.io/cran/zCompositions/man/multRepl.html"><code>multRepl</code></a>
from <code>zCompositions</code> package)</li>
<li>Modified EM alr-algorithm
(<a href="https://rdrr.io/cran/zCompositions/man/lrEM.html"><code>lrEM</code></a> from
<code>zCompositions</code> package)</li>
<li>Bayesian-multiplicative replacement
(<a href="https://rdrr.io/cran/zCompositions/man/cmultRepl.html"><code>cmultRepl</code></a>
from <code>zCompositions</code> package)</li>
</ul>
<p><strong>Normalization methods:</strong></p>
<ul>
<li>Total Sum Scaling (TSS) (own implementation)</li>
<li>Cumulative Sum Scaling (CSS) (<a href=""><code>cumNormMat</code></a> from <code>metagenomeSeq</code>
package)</li>
<li>Common Sum Scaling (COM) (own implementation)</li>
<li>Rarefying (<a href=""><code>rrarefy</code></a> from <code>vegan</code> package)</li>
<li>Variance Stabilizing Transformation (VST)
(<a href=""><code>varianceStabilizingTransformation</code></a> from <code>DESeq2</code> package)</li>
<li>Centered log-ratio (clr) transformation
(<a href="https://rdrr.io/github/zdk123/SpiecEasi/man/clr.html"><code>clr()</code></a>
from <code>SpiecEasi</code> package))</li>
</ul>
<p>TSS, CSS, COM, VST, and the clr transformation are described in [Badri
et al., 2020].</p>
<p><strong>Loading packages</strong></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="network-analysis.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XMAS2)</span>
<span id="cb87-2"><a href="network-analysis.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb87-3"><a href="network-analysis.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb87-4"><a href="network-analysis.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb87-5"><a href="network-analysis.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb87-6"><a href="network-analysis.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NetCoMi)</span></code></pre></div>
<div id="importing-data" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Importing data<a href="network-analysis.html#importing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="network-analysis.html#cb88-1" aria-hidden="true" tabindex="-1"></a>dada2_ps_remove_BRS <span class="ot">&lt;-</span> <span class="fu">get_GroupPhyloseq</span>(</span>
<span id="cb88-2"><a href="network-analysis.html#cb88-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ps =</span> dada2_ps,</span>
<span id="cb88-3"><a href="network-analysis.html#cb88-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb88-4"><a href="network-analysis.html#cb88-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">group_names =</span> <span class="st">&quot;QC&quot;</span>,</span>
<span id="cb88-5"><a href="network-analysis.html#cb88-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">discard =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-6"><a href="network-analysis.html#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="network-analysis.html#cb88-7" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare <span class="ot">&lt;-</span> <span class="fu">norm_rarefy</span>(<span class="at">object =</span> dada2_ps_remove_BRS, </span>
<span id="cb88-8"><a href="network-analysis.html#cb88-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="dv">51181</span>)</span>
<span id="cb88-9"><a href="network-analysis.html#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="network-analysis.html#cb88-10" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus <span class="ot">&lt;-</span> <span class="fu">summarize_taxa</span>(<span class="at">ps =</span> dada2_ps_rare, </span>
<span id="cb88-11"><a href="network-analysis.html#cb88-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">taxa_level =</span> <span class="st">&quot;Genus&quot;</span>)</span>
<span id="cb88-12"><a href="network-analysis.html#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="network-analysis.html#cb88-13" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus_filter <span class="ot">&lt;-</span> <span class="fu">run_filter</span>(<span class="at">ps =</span> dada2_ps_rare_genus, </span>
<span id="cb88-14"><a href="network-analysis.html#cb88-14" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">cutoff =</span> <span class="dv">10</span>, </span>
<span id="cb88-15"><a href="network-analysis.html#cb88-15" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">unclass =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-16"><a href="network-analysis.html#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="network-analysis.html#cb88-17" aria-hidden="true" tabindex="-1"></a>dada2_ps_rare_genus_filter</span></code></pre></div>
<pre><code>## phyloseq-class experiment-level object
## otu_table()   OTU Table:         [ 149 taxa and 23 samples ]
## sample_data() Sample Data:       [ 23 samples by 1 sample variables ]
## tax_table()   Taxonomy Table:    [ 149 taxa by 6 taxonomic ranks ]</code></pre>
</div>
<div id="single-network-with-pearson-correlation-as-association-measure" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Single network with Pearson correlation as association measure<a href="network-analysis.html#single-network-with-pearson-correlation-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since Pearson correlations may lead to compositional effects when applied to sequencing data, we use the clr transformation as normalization method. Zero treatment is necessary in this case.</p>
<p>A threshold of 0.3 is used as sparsification method, so that only OTUs with an absolute correlation greater than or equal to 0.3 are connected.</p>
<div id="building-network-model" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Building network model<a href="network-analysis.html#building-network-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="network-analysis.html#cb90-1" aria-hidden="true" tabindex="-1"></a>net_single <span class="ot">&lt;-</span> <span class="fu">netConstruct</span>(dada2_ps_rare_genus_filter,  </span>
<span id="cb90-2"><a href="network-analysis.html#cb90-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">measure =</span> <span class="st">&quot;pearson&quot;</span>,</span>
<span id="cb90-3"><a href="network-analysis.html#cb90-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">normMethod =</span> <span class="st">&quot;clr&quot;</span>, </span>
<span id="cb90-4"><a href="network-analysis.html#cb90-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">zeroMethod =</span> <span class="st">&quot;multRepl&quot;</span>,</span>
<span id="cb90-5"><a href="network-analysis.html#cb90-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sparsMethod =</span> <span class="st">&quot;threshold&quot;</span>, </span>
<span id="cb90-6"><a href="network-analysis.html#cb90-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">thresh =</span> <span class="fl">0.7</span>,</span>
<span id="cb90-7"><a href="network-analysis.html#cb90-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb90-8"><a href="network-analysis.html#cb90-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
</div>
<div id="analyzing-the-constructed-network" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Analyzing the constructed network<a href="network-analysis.html#analyzing-the-constructed-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>NetCoMi’s <code>netAnalyze()</code> function is used for analyzing the constructed network(s).</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="network-analysis.html#cb91-1" aria-hidden="true" tabindex="-1"></a>props_single <span class="ot">&lt;-</span> <span class="fu">netAnalyze</span>(net_single, <span class="at">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>)</span>
<span id="cb91-2"><a href="network-analysis.html#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="network-analysis.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(props_single, <span class="at">numbNodes =</span> 5L)</span></code></pre></div>
<pre><code>## 
## Component sizes
## ```````````````               
## size: 39 3 2  1
##    #:  1 2 8 88
## ______________________________
## Global network properties
## `````````````````````````
## Largest connected component (LCC):
##                                  
## Relative LCC size         0.26174
## Clustering coefficient    0.59645
## Modularity                0.59201
## Positive edge percentage 80.55556
## Edge density              0.09717
## Natural connectivity      0.06273
## Vertex connectivity       1.00000
## Edge connectivity         1.00000
## Average dissimilarity*    0.94444
## Average path length**     1.86198
## 
## Whole network:
##                                  
## Number of components     99.00000
## Clustering coefficient    0.61305
## Modularity                0.68097
## Positive edge percentage 78.82353
## Edge density              0.00771
## Natural connectivity      0.01044
## 
##  *Dissimilarity = 1 - edge weight
## **Path length: Units with average dissimilarity
## 
## ______________________________
## Clusters
## - In the whole network
## - Algorithm: cluster_fast_greedy
## ```````````````````````````````` 
##                                                 
## name:  0  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
##    #: 88 12 2 3 2 2 9 4 2 2  3  4  2  2  6  2  4
## 
## ______________________________
## Hubs
## - In alphabetical/numerical order
## - Based on empirical quantiles of centralities
## ```````````````````````````````````````````````                           
##  g__Aggregatibacter        
##  g__CHKCI002               
##  g__Enterorhabdus          
##  g__Family_XIII_UCG_001    
##  g__Lachnospiraceae_UCG_008
##  g__Ruminococcaceae_UCG_008
##  g__Ruminococcaceae_UCG_009
##  g__Slackia                
## 
## ______________________________
## Centrality measures
## - In decreasing order
## - Centrality of disconnected components is zero
## ````````````````````````````````````````````````
## Degree (normalized):
##                                   
## g__Lachnospiraceae_UCG_008 0.07432
## g__CHKCI002                0.05405
## g__Aggregatibacter         0.04730
## g__Enterorhabdus           0.04730
## g__Prevotella_9            0.04730
## 
## Betweenness centrality (normalized):
##                                   
## g__Lachnospiraceae_UCG_008 0.70128
## g__Enterorhabdus           0.32432
## g__Prevotella_9            0.32290
## g__Coprococcus_2           0.19346
## g__Holdemanella            0.19346
## 
## Closeness centrality (normalized):
##                                   
## g__CHKCI002                2.29073
## g__Enterorhabdus           2.10507
## g__Ruminococcaceae_UCG_008 1.86673
## g__Lachnospiraceae_UCG_008 1.55863
## g__Asaccharospora          1.39662
## 
## Eigenvector centrality (normalized):
##                                   
## g__CHKCI002                1.00000
## g__Enterorhabdus           0.98929
## g__Ruminococcaceae_UCG_008 0.92786
## g__Family_XIII_UCG_001     0.84702
## g__Ruminococcaceae_UCG_009 0.83421</code></pre>
</div>
<div id="visualizing-the-network" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Visualizing the network<a href="network-analysis.html#visualizing-the-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>primary plot</li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="network-analysis.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_single, </span>
<span id="cb93-2"><a href="network-analysis.html#cb93-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb93-3"><a href="network-analysis.html#cb93-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb93-4"><a href="network-analysis.html#cb93-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on 16s with Pearson correlations&quot;</span>, </span>
<span id="cb93-5"><a href="network-analysis.html#cb93-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb93-6"><a href="network-analysis.html#cb93-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelLength =</span> <span class="dv">10</span>,</span>
<span id="cb93-7"><a href="network-analysis.html#cb93-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb93-8"><a href="network-analysis.html#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="network-analysis.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>, </span>
<span id="cb93-10"><a href="network-analysis.html#cb93-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb93-11"><a href="network-analysis.html#cb93-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-58"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-58-1.png" alt="Network on 16s with Pearson correlations" width="768" />
<p class="caption">
Figure 9.1: Network on 16s with Pearson correlations
</p>
</div>
<ul>
<li><p>improve the visualization by changing the following arguments:</p>
<ul>
<li><p><code>repulsion = 0.8</code>: Place the nodes further apart</p></li>
<li><p><code>rmSingles = TRUE</code>: Single nodes are removed</p></li>
<li><p><code>labelScale = FALSE</code> and <code>cexLabels = 1.6</code>: All labels have equal size and are enlarged to improve readability of small node’s labels</p></li>
<li><p><code>nodeSizeSpread = 3</code> (default is 4): Node sizes are more similar if the value is decreased. This argument (in combination with <code>cexNodes</code>) is useful to enlarge small nodes while keeping the size of big nodes.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="network-analysis.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_single, </span>
<span id="cb94-2"><a href="network-analysis.html#cb94-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb94-3"><a href="network-analysis.html#cb94-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb94-4"><a href="network-analysis.html#cb94-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelLength =</span> <span class="dv">40</span>,</span>
<span id="cb94-5"><a href="network-analysis.html#cb94-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb94-6"><a href="network-analysis.html#cb94-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">rmSingles =</span> <span class="cn">TRUE</span>,</span>
<span id="cb94-7"><a href="network-analysis.html#cb94-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelScale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb94-8"><a href="network-analysis.html#cb94-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexLabels =</span> <span class="dv">1</span>,</span>
<span id="cb94-9"><a href="network-analysis.html#cb94-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb94-10"><a href="network-analysis.html#cb94-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb94-11"><a href="network-analysis.html#cb94-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on metabolomics with Pearson correlations&quot;</span>, </span>
<span id="cb94-12"><a href="network-analysis.html#cb94-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb94-13"><a href="network-analysis.html#cb94-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">1.5</span>)</span>
<span id="cb94-14"><a href="network-analysis.html#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="network-analysis.html#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb94-16"><a href="network-analysis.html#cb94-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb94-17"><a href="network-analysis.html#cb94-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-59"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-59-1.png" alt="Network on 16s with Pearson correlations" width="1152" />
<p class="caption">
Figure 9.2: Network on 16s with Pearson correlations
</p>
</div>
<ul>
<li>Network on genus level with Pearson correlations</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="network-analysis.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb95-2"><a href="network-analysis.html#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="network-analysis.html#cb95-3" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(net_single<span class="sc">$</span>adjaMat1, <span class="at">weighted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-4"><a href="network-analysis.html#cb95-4" aria-hidden="true" tabindex="-1"></a>lay_fr <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">layout_with_fr</span>(graph)</span>
<span id="cb95-5"><a href="network-analysis.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(lay_fr) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(net_single<span class="sc">$</span>adjaMat1)</span>
<span id="cb95-6"><a href="network-analysis.html#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="network-analysis.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_single,</span>
<span id="cb95-8"><a href="network-analysis.html#cb95-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> <span class="st">&quot;layout_with_fr&quot;</span>,</span>
<span id="cb95-9"><a href="network-analysis.html#cb95-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">shortenLabels =</span> <span class="st">&quot;simple&quot;</span>,</span>
<span id="cb95-10"><a href="network-analysis.html#cb95-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelLength =</span> <span class="dv">30</span>,</span>
<span id="cb95-11"><a href="network-analysis.html#cb95-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">charToRm =</span> <span class="st">&quot;g__&quot;</span>,</span>
<span id="cb95-12"><a href="network-analysis.html#cb95-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelScale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb95-13"><a href="network-analysis.html#cb95-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">rmSingles =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-14"><a href="network-analysis.html#cb95-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;clr&quot;</span>,</span>
<span id="cb95-15"><a href="network-analysis.html#cb95-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>,</span>
<span id="cb95-16"><a href="network-analysis.html#cb95-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">hubBorderCol =</span> <span class="st">&quot;darkgray&quot;</span>,</span>
<span id="cb95-17"><a href="network-analysis.html#cb95-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb95-18"><a href="network-analysis.html#cb95-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexLabels =</span> <span class="fl">1.5</span>,</span>
<span id="cb95-19"><a href="network-analysis.html#cb95-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexHubLabels =</span> <span class="dv">2</span>,</span>
<span id="cb95-20"><a href="network-analysis.html#cb95-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on genus level with Pearson correlations&quot;</span>, </span>
<span id="cb95-21"><a href="network-analysis.html#cb95-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-22"><a href="network-analysis.html#cb95-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">2.3</span>)</span>
<span id="cb95-23"><a href="network-analysis.html#cb95-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-24"><a href="network-analysis.html#cb95-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="at">cex =</span> <span class="fl">2.2</span>, <span class="at">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb95-25"><a href="network-analysis.html#cb95-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#009900&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb95-26"><a href="network-analysis.html#cb95-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-60"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-60-1.png" alt="Network on 16s with Pearson correlations (Genus)" width="1152" />
<p class="caption">
Figure 9.3: Network on 16s with Pearson correlations (Genus)
</p>
</div>
<p>Let’s check whether the largest nodes are actually those with highest column sums in the matrix with normalized counts returned by netConstruct().</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="network-analysis.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">colSums</span>(net_single<span class="sc">$</span>normCounts1), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##           g__Blautia   g__Bifidobacterium       g__Bacteroides  g__Faecalibacterium     g__Streptococcus      g__Anaerostipes 
##            118.72356            102.80453             89.05312             59.39712             58.50952             46.25736 
##       g__Collinsella g__Lachnoclostridium      g__Agathobacter             g__Dorea 
##             39.56018             37.38476             36.47407             35.96901</code></pre>
<ul>
<li>Network on genus level with Pearson correlations with phylum annotation</li>
</ul>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="network-analysis.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get phyla names from the taxonomic table created before</span></span>
<span id="cb98-2"><a href="network-analysis.html#cb98-2" aria-hidden="true" tabindex="-1"></a>taxatab <span class="ot">&lt;-</span> dada2_ps_rare_genus_filter<span class="sc">@</span>tax_table <span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="network-analysis.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb98-4"><a href="network-analysis.html#cb98-4" aria-hidden="true" tabindex="-1"></a>phyla <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">gsub</span>(<span class="st">&quot;p__&quot;</span>, <span class="st">&quot;&quot;</span>, taxatab[, <span class="st">&quot;Phylum&quot;</span>]))</span>
<span id="cb98-5"><a href="network-analysis.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(phyla) <span class="ot">&lt;-</span> taxatab<span class="sc">$</span>Genus</span>
<span id="cb98-6"><a href="network-analysis.html#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="network-analysis.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define phylum colors</span></span>
<span id="cb98-8"><a href="network-analysis.html#cb98-8" aria-hidden="true" tabindex="-1"></a>phylcol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;lawngreen&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;deeppink&quot;</span>, <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb98-9"><a href="network-analysis.html#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="network-analysis.html#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_single,</span>
<span id="cb98-11"><a href="network-analysis.html#cb98-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb98-12"><a href="network-analysis.html#cb98-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">repulsion =</span> <span class="fl">0.84</span>,</span>
<span id="cb98-13"><a href="network-analysis.html#cb98-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">shortenLabels =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb98-14"><a href="network-analysis.html#cb98-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">charToRm =</span> <span class="st">&quot;g__&quot;</span>,</span>
<span id="cb98-15"><a href="network-analysis.html#cb98-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelLength =</span> <span class="dv">30</span>,</span>
<span id="cb98-16"><a href="network-analysis.html#cb98-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelScale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb98-17"><a href="network-analysis.html#cb98-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">rmSingles =</span> <span class="cn">TRUE</span>,</span>
<span id="cb98-18"><a href="network-analysis.html#cb98-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;clr&quot;</span>,</span>
<span id="cb98-19"><a href="network-analysis.html#cb98-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSizeSpread =</span> <span class="dv">4</span>,</span>
<span id="cb98-20"><a href="network-analysis.html#cb98-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;feature&quot;</span>, </span>
<span id="cb98-21"><a href="network-analysis.html#cb98-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">featVecCol =</span> phyla, </span>
<span id="cb98-22"><a href="network-analysis.html#cb98-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">colorVec =</span>  phylcol,</span>
<span id="cb98-23"><a href="network-analysis.html#cb98-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">posCol =</span> <span class="st">&quot;darkturquoise&quot;</span>, </span>
<span id="cb98-24"><a href="network-analysis.html#cb98-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">negCol =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb98-25"><a href="network-analysis.html#cb98-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspLow =</span> <span class="dv">0</span>,</span>
<span id="cb98-26"><a href="network-analysis.html#cb98-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspHigh =</span> <span class="dv">40</span>,</span>
<span id="cb98-27"><a href="network-analysis.html#cb98-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb98-28"><a href="network-analysis.html#cb98-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexLabels =</span> <span class="dv">2</span>,</span>
<span id="cb98-29"><a href="network-analysis.html#cb98-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexHubLabels =</span> <span class="fl">2.5</span>,</span>
<span id="cb98-30"><a href="network-analysis.html#cb98-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on genus level with Pearson correlations&quot;</span>, </span>
<span id="cb98-31"><a href="network-analysis.html#cb98-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb98-32"><a href="network-analysis.html#cb98-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">2.3</span>)</span>
<span id="cb98-33"><a href="network-analysis.html#cb98-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-34"><a href="network-analysis.html#cb98-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors used in the legend should be equally transparent as in the plot</span></span>
<span id="cb98-35"><a href="network-analysis.html#cb98-35" aria-hidden="true" tabindex="-1"></a>phylcol_transp <span class="ot">&lt;-</span> NetCoMi<span class="sc">:::</span><span class="fu">colToTransp</span>(phylcol, <span class="dv">60</span>)</span>
<span id="cb98-36"><a href="network-analysis.html#cb98-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-37"><a href="network-analysis.html#cb98-37" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pt.cex =</span> <span class="fl">2.5</span>, <span class="at">title =</span> <span class="st">&quot;Phylum:&quot;</span>, </span>
<span id="cb98-38"><a href="network-analysis.html#cb98-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">levels</span>(phyla), <span class="at">col =</span> phylcol_transp, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb98-39"><a href="network-analysis.html#cb98-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-40"><a href="network-analysis.html#cb98-40" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="at">cex =</span> <span class="fl">2.2</span>, <span class="at">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb98-41"><a href="network-analysis.html#cb98-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkturquoise&quot;</span>,<span class="st">&quot;orange&quot;</span>), </span>
<span id="cb98-42"><a href="network-analysis.html#cb98-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-62"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-62-1.png" alt="Network on 16s with Pearson correlations (Annotation)" width="2016" />
<p class="caption">
Figure 9.4: Network on 16s with Pearson correlations (Annotation)
</p>
</div>
</div>
</div>
<div id="single-network-with-sparcc-correlation-as-association-measure" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Single network with sparcc correlation as association measure<a href="network-analysis.html#single-network-with-sparcc-correlation-as-association-measure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Only the 100 features with highest variance are selected.</p></li>
<li><p>Only samples with a total number of reads of at least 1000 included.</p></li>
</ul>
<div id="building-network-model-1" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Building network model<a href="network-analysis.html#building-network-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="network-analysis.html#cb99-1" aria-hidden="true" tabindex="-1"></a>net_single2 <span class="ot">&lt;-</span> <span class="fu">netConstruct</span>(dada2_ps_rare_genus_filter, </span>
<span id="cb99-2"><a href="network-analysis.html#cb99-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">measure =</span> <span class="st">&quot;sparcc&quot;</span>,</span>
<span id="cb99-3"><a href="network-analysis.html#cb99-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">measurePar =</span> <span class="fu">list</span>(<span class="at">iter =</span> <span class="dv">20</span>,</span>
<span id="cb99-4"><a href="network-analysis.html#cb99-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">inner_iter =</span> <span class="dv">10</span>,</span>
<span id="cb99-5"><a href="network-analysis.html#cb99-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">th =</span> <span class="fl">0.1</span>),</span>
<span id="cb99-6"><a href="network-analysis.html#cb99-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">filtTax =</span> <span class="st">&quot;highestVar&quot;</span>,</span>
<span id="cb99-7"><a href="network-analysis.html#cb99-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">filtTaxPar =</span> <span class="fu">list</span>(<span class="at">highestVar =</span> <span class="dv">100</span>),</span>
<span id="cb99-8"><a href="network-analysis.html#cb99-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">filtSamp =</span> <span class="st">&quot;totalReads&quot;</span>,</span>
<span id="cb99-9"><a href="network-analysis.html#cb99-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">filtSampPar =</span> <span class="fu">list</span>(<span class="at">totalReads =</span> <span class="dv">100</span>),</span>
<span id="cb99-10"><a href="network-analysis.html#cb99-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">verbose =</span> <span class="dv">3</span>,</span>
<span id="cb99-11"><a href="network-analysis.html#cb99-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">seed =</span> <span class="dv">123</span>)</span></code></pre></div>
<pre><code>## Data filtering ...</code></pre>
<pre><code>## 49 taxa removed.</code></pre>
<pre><code>## 100 taxa and 23 samples remaining.</code></pre>
<pre><code>## 
## Calculate &#39;sparcc&#39; associations ... Done.
## 
## Sparsify associations via &#39;t-test&#39; ... 
## Adjust for multiple testing via &#39;adaptBH&#39; ... 
##  Proportion of true null hypotheses: 0.9
## Done.
## Done.</code></pre>
</div>
<div id="analyzing-the-constructed-network-1" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Analyzing the constructed network<a href="network-analysis.html#analyzing-the-constructed-network-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>NetCoMi’s <code>netAnalyze()</code> function is used for analyzing the constructed network(s).</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="network-analysis.html#cb104-1" aria-hidden="true" tabindex="-1"></a>props_single2 <span class="ot">&lt;-</span> <span class="fu">netAnalyze</span>(net_single2, <span class="at">clustMethod =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>)</span>
<span id="cb104-2"><a href="network-analysis.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="network-analysis.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(props_single2, <span class="at">numbNodes =</span> 5L)</span></code></pre></div>
<pre><code>## 
## Component sizes
## ```````````````          
## size: 2  1
##    #: 3 94
## ______________________________
## Global network properties
## `````````````````````````
## Largest connected component (LCC):
##                                   
## Relative LCC size          0.02000
## Clustering coefficient     0.00000
## Modularity                 0.00000
## Positive edge percentage 100.00000
## Edge density               1.00000
## Natural connectivity       0.93918
## Vertex connectivity        1.00000
## Edge connectivity          1.00000
## Average dissimilarity*     0.29983
## Average path length**      1.00000
## 
## Whole network:
##                                  
## Number of components     97.00000
## Clustering coefficient    0.00000
## Modularity                0.66667
## Positive edge percentage 66.66667
## Edge density              0.00061
## Natural connectivity      0.01060
## 
##  *Dissimilarity = 1 - edge weight
## **Path length: Units with average dissimilarity
## 
## ______________________________
## Clusters
## - In the whole network
## - Algorithm: cluster_fast_greedy
## ```````````````````````````````` 
##               
## name:  0 1 2 3
##    #: 94 2 2 2
## 
## ______________________________
## Hubs
## - In alphabetical/numerical order
## - Based on empirical quantiles of centralities
## ```````````````````````````````````````````````                          
##  g__Blautia               
##  g__Erysipelatoclostridium
## 
## ______________________________
## Centrality measures
## - In decreasing order
## - Centrality of disconnected components is zero
## ````````````````````````````````````````````````
## Degree (normalized):
##                                 
## g__Blautia                0.0101
## g__Erysipelatoclostridium 0.0101
## g__Bifidobacterium        0.0000
## g__Bacteroides            0.0000
## g__Streptococcus          0.0000
## 
## Betweenness centrality (normalized):
##                      
## g__Bifidobacterium  0
## g__Bacteroides      0
## g__Blautia          0
## g__Streptococcus    0
## g__Faecalibacterium 0
## 
## Closeness centrality (normalized):
##                            
## g__Blautia                1
## g__Erysipelatoclostridium 1
## g__Bifidobacterium        0
## g__Bacteroides            0
## g__Streptococcus          0
## 
## Eigenvector centrality (normalized):
##                            
## g__Blautia                1
## g__Erysipelatoclostridium 1
## g__Bifidobacterium        0
## g__Bacteroides            0
## g__Streptococcus          0</code></pre>
<div id="visualizing-the-network-1" class="section level4 hasAnchor" number="9.3.2.1">
<h4><span class="header-section-number">9.3.2.1</span> Visualizing the network<a href="network-analysis.html#visualizing-the-network-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="network-analysis.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_single2,</span>
<span id="cb106-2"><a href="network-analysis.html#cb106-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb106-3"><a href="network-analysis.html#cb106-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">repulsion =</span> <span class="fl">0.84</span>,</span>
<span id="cb106-4"><a href="network-analysis.html#cb106-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">shortenLabels =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb106-5"><a href="network-analysis.html#cb106-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">charToRm =</span> <span class="st">&quot;g__&quot;</span>,</span>
<span id="cb106-6"><a href="network-analysis.html#cb106-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelLength =</span> <span class="dv">30</span>,</span>
<span id="cb106-7"><a href="network-analysis.html#cb106-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelScale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb106-8"><a href="network-analysis.html#cb106-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">rmSingles =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-9"><a href="network-analysis.html#cb106-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;clr&quot;</span>,</span>
<span id="cb106-10"><a href="network-analysis.html#cb106-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSizeSpread =</span> <span class="dv">4</span>,</span>
<span id="cb106-11"><a href="network-analysis.html#cb106-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;feature&quot;</span>, </span>
<span id="cb106-12"><a href="network-analysis.html#cb106-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">featVecCol =</span> phyla, </span>
<span id="cb106-13"><a href="network-analysis.html#cb106-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">colorVec =</span>  phylcol,</span>
<span id="cb106-14"><a href="network-analysis.html#cb106-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">posCol =</span> <span class="st">&quot;darkturquoise&quot;</span>, </span>
<span id="cb106-15"><a href="network-analysis.html#cb106-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">negCol =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb106-16"><a href="network-analysis.html#cb106-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspLow =</span> <span class="dv">0</span>,</span>
<span id="cb106-17"><a href="network-analysis.html#cb106-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspHigh =</span> <span class="dv">40</span>,</span>
<span id="cb106-18"><a href="network-analysis.html#cb106-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb106-19"><a href="network-analysis.html#cb106-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexLabels =</span> <span class="dv">2</span>,</span>
<span id="cb106-20"><a href="network-analysis.html#cb106-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexHubLabels =</span> <span class="fl">2.5</span>,</span>
<span id="cb106-21"><a href="network-analysis.html#cb106-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on genus level with Pearson correlations&quot;</span>, </span>
<span id="cb106-22"><a href="network-analysis.html#cb106-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-23"><a href="network-analysis.html#cb106-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">2.3</span>)</span>
<span id="cb106-24"><a href="network-analysis.html#cb106-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-25"><a href="network-analysis.html#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors used in the legend should be equally transparent as in the plot</span></span>
<span id="cb106-26"><a href="network-analysis.html#cb106-26" aria-hidden="true" tabindex="-1"></a>phylcol_transp <span class="ot">&lt;-</span> NetCoMi<span class="sc">:::</span><span class="fu">colToTransp</span>(phylcol, <span class="dv">60</span>)</span>
<span id="cb106-27"><a href="network-analysis.html#cb106-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-28"><a href="network-analysis.html#cb106-28" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pt.cex =</span> <span class="fl">2.5</span>, <span class="at">title =</span> <span class="st">&quot;Phylum:&quot;</span>, </span>
<span id="cb106-29"><a href="network-analysis.html#cb106-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">levels</span>(phyla), <span class="at">col =</span> phylcol_transp, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb106-30"><a href="network-analysis.html#cb106-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-31"><a href="network-analysis.html#cb106-31" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="at">cex =</span> <span class="fl">2.2</span>, <span class="at">title =</span> <span class="st">&quot;estimated correlation:&quot;</span>,</span>
<span id="cb106-32"><a href="network-analysis.html#cb106-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkturquoise&quot;</span>,<span class="st">&quot;orange&quot;</span>), </span>
<span id="cb106-33"><a href="network-analysis.html#cb106-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-65"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-65-1.png" alt="Network on metabolomics with sparcc associations" width="2016" />
<p class="caption">
Figure 9.5: Network on metabolomics with sparcc associations
</p>
</div>
</div>
</div>
</div>
<div id="dissimilarity-based-networks" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Dissimilarity-based Networks<a href="network-analysis.html#dissimilarity-based-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>If a dissimilarity measure is used for network construction, nodes are subjects instead of OTUs. The estimated dissimilarities are transformed into similarities, which are used as edge weights so that subjects with a similar microbial composition are placed close together in the network plot.</p>
</blockquote>
<blockquote>
<p>We construct a single network using Aitchison’s distance being suitable for the application on compositional data.</p>
</blockquote>
<blockquote>
<p>Since the Aitchison distance is based on the clr-transformation, zeros in the data need to be replaced.</p>
</blockquote>
<blockquote>
<p>The network is sparsified using the k-nearest neighbor (knn) algorithm.</p>
</blockquote>
<div id="building-network-module" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Building network module<a href="network-analysis.html#building-network-module" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="network-analysis.html#cb107-1" aria-hidden="true" tabindex="-1"></a>net_aitchison <span class="ot">&lt;-</span> <span class="fu">netConstruct</span>(dada2_ps_rare_genus_filter,</span>
<span id="cb107-2"><a href="network-analysis.html#cb107-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">measure =</span> <span class="st">&quot;aitchison&quot;</span>,</span>
<span id="cb107-3"><a href="network-analysis.html#cb107-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">zeroMethod =</span> <span class="st">&quot;multRepl&quot;</span>,</span>
<span id="cb107-4"><a href="network-analysis.html#cb107-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sparsMethod =</span> <span class="st">&quot;knn&quot;</span>, </span>
<span id="cb107-5"><a href="network-analysis.html#cb107-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">kNeighbor =</span> <span class="dv">3</span>,</span>
<span id="cb107-6"><a href="network-analysis.html#cb107-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Infos about changed arguments:</code></pre>
<pre><code>## Counts normalized to fractions for measure &#39;aitchison&#39;.</code></pre>
<pre><code>## 149 taxa and 23 samples remaining.</code></pre>
<pre><code>## 
## Zero treatment:</code></pre>
<pre><code>## Execute multRepl() ...</code></pre>
<pre><code>## Warning in (function (X, label = NULL, dl = NULL, frac = 0.65, imp.missing = FALSE, : Column(s) containing more than 80% zeros/unobserved values were found (check it out using zPatterns).
##                     (You can use the z.warning argument to modify the warning threshold).</code></pre>
<pre><code>## Done.
## 
## Normalization:
## Counts normalized by total sum scaling.
## 
## Calculate &#39;aitchison&#39; dissimilarities ... Done.
## 
## Sparsify dissimilarities via &#39;knn&#39; ... Done.</code></pre>
</div>
<div id="analyzing-the-constructed-network-2" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Analyzing the constructed network<a href="network-analysis.html#analyzing-the-constructed-network-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>NetCoMi’s <code>netAnalyze()</code> function is used for analyzing the constructed network(s).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="network-analysis.html#cb115-1" aria-hidden="true" tabindex="-1"></a>props_aitchison <span class="ot">&lt;-</span> <span class="fu">netAnalyze</span>(net_aitchison,</span>
<span id="cb115-2"><a href="network-analysis.html#cb115-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">clustMethod =</span> <span class="st">&quot;hierarchical&quot;</span>,</span>
<span id="cb115-3"><a href="network-analysis.html#cb115-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">clustPar =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;average&quot;</span>, <span class="at">k =</span> <span class="dv">3</span>),</span>
<span id="cb115-4"><a href="network-analysis.html#cb115-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hubPar =</span> <span class="st">&quot;eigenvector&quot;</span>)</span>
<span id="cb115-5"><a href="network-analysis.html#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="network-analysis.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(props_aitchison, <span class="at">numbNodes =</span> 5L)</span></code></pre></div>
<pre><code>## 
## Component sizes
## ```````````````        
## size: 23
##    #:  1
## ______________________________
## Global network properties
## `````````````````````````
##                                   
## Number of components       1.00000
## Clustering coefficient     0.42932
## Modularity                 0.36419
## Positive edge percentage 100.00000
## Edge density               0.18577
## Natural connectivity       0.10798
## Vertex connectivity        2.00000
## Edge connectivity          3.00000
## Average dissimilarity*     0.87407
## Average path length**      0.87285
## 
##  *Dissimilarity = 1 - edge weight
## **Path length: Units with average dissimilarity
## 
## ______________________________
## Clusters
## - In the whole network
## - Algorithm: hierarchical
## ````````````````````````` 
##             
## name:  1 2 3
##    #: 12 9 2
## 
## ______________________________
## Hubs
## - In alphabetical/numerical order
## - Based on empirical quantiles of centralities
## ```````````````````````````````````````````````      
##  S6032
##  S6063
## 
## ______________________________
## Centrality measures
## - In decreasing order
## - Computed for the complete network
## ````````````````````````````````````
## Degree (normalized):
##              
## S6032 0.36364
## S6063 0.36364
## S6055 0.31818
## S6035 0.27273
## S6054 0.22727
## 
## Betweenness centrality (normalized):
##              
## S6063 0.29870
## S6055 0.24675
## S6035 0.19048
## S6032 0.18182
## S6046 0.17749
## 
## Closeness centrality (normalized):
##              
## S6050 3.42434
## S6040 3.39372
## S6035 2.20310
## S6068 2.13482
## S6032 2.11212
## 
## Eigenvector centrality (normalized):
##              
## S6063 1.00000
## S6032 0.86437
## S6035 0.78392
## S6068 0.72544
## S6037 0.59651</code></pre>
</div>
<div id="visualizing-the-network-2" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Visualizing the network<a href="network-analysis.html#visualizing-the-network-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>primary plot</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="network-analysis.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_aitchison, </span>
<span id="cb117-2"><a href="network-analysis.html#cb117-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;cluster&quot;</span>, </span>
<span id="cb117-3"><a href="network-analysis.html#cb117-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb117-4"><a href="network-analysis.html#cb117-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">repulsion =</span> <span class="fl">0.8</span>,</span>
<span id="cb117-5"><a href="network-analysis.html#cb117-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">rmSingles =</span> <span class="cn">TRUE</span>,</span>
<span id="cb117-6"><a href="network-analysis.html#cb117-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelScale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb117-7"><a href="network-analysis.html#cb117-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexLabels =</span> <span class="fl">1.6</span>,</span>
<span id="cb117-8"><a href="network-analysis.html#cb117-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSizeSpread =</span> <span class="dv">3</span>,</span>
<span id="cb117-9"><a href="network-analysis.html#cb117-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexNodes =</span> <span class="fl">1.5</span>,</span>
<span id="cb117-10"><a href="network-analysis.html#cb117-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on metagenomics with Aitchison distance&quot;</span>, </span>
<span id="cb117-11"><a href="network-analysis.html#cb117-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb117-12"><a href="network-analysis.html#cb117-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">1.5</span>,</span>
<span id="cb117-13"><a href="network-analysis.html#cb117-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">hubTransp =</span> <span class="dv">50</span>,</span>
<span id="cb117-14"><a href="network-analysis.html#cb117-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspLow =</span> <span class="dv">60</span>,</span>
<span id="cb117-15"><a href="network-analysis.html#cb117-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">charToRm =</span> <span class="st">&quot;00000&quot;</span>,</span>
<span id="cb117-16"><a href="network-analysis.html#cb117-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb117-17"><a href="network-analysis.html#cb117-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-18"><a href="network-analysis.html#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="co"># get green color with 50% transparency</span></span>
<span id="cb117-19"><a href="network-analysis.html#cb117-19" aria-hidden="true" tabindex="-1"></a>green2 <span class="ot">&lt;-</span> <span class="fu">colToTransp</span>(<span class="st">&quot;#009900&quot;</span>, <span class="dv">40</span>)</span>
<span id="cb117-20"><a href="network-analysis.html#cb117-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-21"><a href="network-analysis.html#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.4</span>, <span class="fl">1.1</span>,</span>
<span id="cb117-22"><a href="network-analysis.html#cb117-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb117-23"><a href="network-analysis.html#cb117-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;high similarity (low Aitchison distance)&quot;</span>,</span>
<span id="cb117-24"><a href="network-analysis.html#cb117-24" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;low similarity (high Aitchison distance)&quot;</span>), </span>
<span id="cb117-25"><a href="network-analysis.html#cb117-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, </span>
<span id="cb117-26"><a href="network-analysis.html#cb117-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb117-27"><a href="network-analysis.html#cb117-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, green2),</span>
<span id="cb117-28"><a href="network-analysis.html#cb117-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-68"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-68-1.png" alt="Dissimilarity-based Networks" width="1152" />
<p class="caption">
Figure 9.6: Dissimilarity-based Networks
</p>
</div>
<ul>
<li>plot samples with group information</li>
</ul>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="network-analysis.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get gorup names from the sample table created before</span></span>
<span id="cb118-2"><a href="network-analysis.html#cb118-2" aria-hidden="true" tabindex="-1"></a>sampletab <span class="ot">&lt;-</span> dada2_ps_rare_genus_filter<span class="sc">@</span>sam_data <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="network-analysis.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb118-4"><a href="network-analysis.html#cb118-4" aria-hidden="true" tabindex="-1"></a>group_labels <span class="ot">&lt;-</span> <span class="fu">factor</span>(sampletab<span class="sc">$</span>Group)</span>
<span id="cb118-5"><a href="network-analysis.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(group_labels) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sampletab)</span>
<span id="cb118-6"><a href="network-analysis.html#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="network-analysis.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define group colors</span></span>
<span id="cb118-8"><a href="network-analysis.html#cb118-8" aria-hidden="true" tabindex="-1"></a>group_lcol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb118-9"><a href="network-analysis.html#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="network-analysis.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(props_aitchison,</span>
<span id="cb118-11"><a href="network-analysis.html#cb118-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb118-12"><a href="network-analysis.html#cb118-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">repulsion =</span> <span class="fl">0.84</span>,</span>
<span id="cb118-13"><a href="network-analysis.html#cb118-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">shortenLabels =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb118-14"><a href="network-analysis.html#cb118-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">labelScale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb118-15"><a href="network-analysis.html#cb118-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">rmSingles =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-16"><a href="network-analysis.html#cb118-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSize =</span> <span class="st">&quot;eigenvector&quot;</span>,</span>
<span id="cb118-17"><a href="network-analysis.html#cb118-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeSizeSpread =</span> <span class="dv">4</span>,</span>
<span id="cb118-18"><a href="network-analysis.html#cb118-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">nodeColor =</span> <span class="st">&quot;feature&quot;</span>, </span>
<span id="cb118-19"><a href="network-analysis.html#cb118-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">featVecCol =</span> group_labels, </span>
<span id="cb118-20"><a href="network-analysis.html#cb118-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">colorVec =</span>  group_lcol,</span>
<span id="cb118-21"><a href="network-analysis.html#cb118-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">posCol =</span> <span class="st">&quot;darkturquoise&quot;</span>, </span>
<span id="cb118-22"><a href="network-analysis.html#cb118-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">negCol =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb118-23"><a href="network-analysis.html#cb118-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspLow =</span> <span class="dv">0</span>,</span>
<span id="cb118-24"><a href="network-analysis.html#cb118-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">edgeTranspHigh =</span> <span class="dv">40</span>,</span>
<span id="cb118-25"><a href="network-analysis.html#cb118-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexNodes =</span> <span class="dv">2</span>,</span>
<span id="cb118-26"><a href="network-analysis.html#cb118-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexLabels =</span> <span class="dv">2</span>,</span>
<span id="cb118-27"><a href="network-analysis.html#cb118-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexHubLabels =</span> <span class="fl">2.5</span>,</span>
<span id="cb118-28"><a href="network-analysis.html#cb118-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">title1 =</span> <span class="st">&quot;Network on genus level with Aitchison distance&quot;</span>, </span>
<span id="cb118-29"><a href="network-analysis.html#cb118-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">showTitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-30"><a href="network-analysis.html#cb118-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">cexTitle =</span> <span class="fl">2.3</span>)</span>
<span id="cb118-31"><a href="network-analysis.html#cb118-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-32"><a href="network-analysis.html#cb118-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors used in the legend should be equally transparent as in the plot</span></span>
<span id="cb118-33"><a href="network-analysis.html#cb118-33" aria-hidden="true" tabindex="-1"></a>group_transp <span class="ot">&lt;-</span> NetCoMi<span class="sc">:::</span><span class="fu">colToTransp</span>(group_lcol, <span class="dv">60</span>)</span>
<span id="cb118-34"><a href="network-analysis.html#cb118-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-35"><a href="network-analysis.html#cb118-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pt.cex =</span> <span class="fl">2.5</span>, <span class="at">title =</span> <span class="st">&quot;Group:&quot;</span>, </span>
<span id="cb118-36"><a href="network-analysis.html#cb118-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">levels</span>(group_labels), <span class="at">col =</span> group_transp, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>) </span>
<span id="cb118-37"><a href="network-analysis.html#cb118-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-38"><a href="network-analysis.html#cb118-38" aria-hidden="true" tabindex="-1"></a><span class="co"># get green color with 50% transparency</span></span>
<span id="cb118-39"><a href="network-analysis.html#cb118-39" aria-hidden="true" tabindex="-1"></a>green2 <span class="ot">&lt;-</span> <span class="fu">colToTransp</span>(<span class="st">&quot;#009900&quot;</span>, <span class="dv">40</span>)</span>
<span id="cb118-40"><a href="network-analysis.html#cb118-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-41"><a href="network-analysis.html#cb118-41" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.4</span>, <span class="fl">1.1</span>,</span>
<span id="cb118-42"><a href="network-analysis.html#cb118-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb118-43"><a href="network-analysis.html#cb118-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;high similarity (low Aitchison distance)&quot;</span>,</span>
<span id="cb118-44"><a href="network-analysis.html#cb118-44" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;low similarity (high Aitchison distance)&quot;</span>), </span>
<span id="cb118-45"><a href="network-analysis.html#cb118-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, </span>
<span id="cb118-46"><a href="network-analysis.html#cb118-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb118-47"><a href="network-analysis.html#cb118-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, green2),</span>
<span id="cb118-48"><a href="network-analysis.html#cb118-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-69"></span>
<img src="16s-microbiota-data-analysis-based-on-XMAS-package_files/figure-html/unnamed-chunk-69-1.png" alt="Dissimilarity-based Networks (group information)" width="1920" />
<p class="caption">
Figure 9.7: Dissimilarity-based Networks (group information)
</p>
</div>
</div>
</div>
<div id="systematic-information-7" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Systematic Information<a href="network-analysis.html#systematic-information-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="network-analysis.html#cb119-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ──────────────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value
##  version  R version 4.1.2 (2021-11-01)
##  os       macOS Monterey 12.2.1
##  system   x86_64, darwin17.0
##  ui       RStudio
##  language (EN)
##  collate  en_US.UTF-8
##  ctype    en_US.UTF-8
##  tz       Asia/Shanghai
##  date     2022-08-09
##  rstudio  2022.07.1+554 Spotted Wakerobin (desktop)
##  pandoc   2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown)
## 
## ─ Packages ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
##  package              * version  date (UTC) lib source
##  abind                  1.4-5    2016-07-21 [1] CRAN (R 4.1.0)
##  ade4                   1.7-18   2021-09-16 [1] CRAN (R 4.1.0)
##  ALDEx2                 1.26.0   2021-10-26 [1] Bioconductor
##  annotate               1.72.0   2021-10-26 [1] Bioconductor
##  AnnotationDbi          1.56.2   2021-11-09 [1] Bioconductor
##  ape                    5.6-2    2022-03-02 [1] CRAN (R 4.1.2)
##  assertthat             0.2.1    2019-03-21 [1] CRAN (R 4.1.0)
##  backports              1.4.1    2021-12-13 [1] CRAN (R 4.1.0)
##  base64enc              0.1-3    2015-07-28 [1] CRAN (R 4.1.0)
##  Biobase                2.54.0   2021-10-26 [1] Bioconductor
##  BiocGenerics           0.40.0   2021-10-26 [1] Bioconductor
##  BiocParallel           1.28.3   2021-12-09 [1] Bioconductor
##  biomformat             1.22.0   2021-10-26 [1] Bioconductor
##  Biostrings             2.62.0   2021-10-26 [1] Bioconductor
##  bit                    4.0.4    2020-08-04 [1] CRAN (R 4.1.0)
##  bit64                  4.0.5    2020-08-30 [1] CRAN (R 4.1.0)
##  bitops                 1.0-7    2021-04-24 [1] CRAN (R 4.1.0)
##  blob                   1.2.2    2021-07-23 [1] CRAN (R 4.1.0)
##  bookdown               0.27     2022-06-14 [1] CRAN (R 4.1.2)
##  brio                   1.1.3    2021-11-30 [1] CRAN (R 4.1.0)
##  broom                  0.7.12   2022-01-28 [1] CRAN (R 4.1.2)
##  bslib                  0.3.1    2021-10-06 [1] CRAN (R 4.1.0)
##  cachem                 1.0.6    2021-08-19 [1] CRAN (R 4.1.0)
##  callr                  3.7.0    2021-04-20 [1] CRAN (R 4.1.0)
##  car                    3.0-12   2021-11-06 [1] CRAN (R 4.1.0)
##  carData                3.0-5    2022-01-06 [1] CRAN (R 4.1.2)
##  caTools                1.18.2   2021-03-28 [1] CRAN (R 4.1.0)
##  cccd                   1.6      2022-04-08 [1] CRAN (R 4.1.2)
##  cellranger             1.1.0    2016-07-27 [1] CRAN (R 4.1.0)
##  checkmate              2.0.0    2020-02-06 [1] CRAN (R 4.1.0)
##  cli                    3.3.0    2022-04-25 [1] CRAN (R 4.1.2)
##  cluster                2.1.2    2021-04-17 [1] CRAN (R 4.1.2)
##  codetools              0.2-18   2020-11-04 [1] CRAN (R 4.1.2)
##  coin                   1.4-2    2021-10-08 [1] CRAN (R 4.1.0)
##  colorspace             2.0-3    2022-02-21 [1] CRAN (R 4.1.2)
##  conflicted             1.1.0    2021-11-26 [1] CRAN (R 4.1.0)
##  corpcor                1.6.10   2021-09-16 [1] CRAN (R 4.1.0)
##  corrplot               0.92     2021-11-18 [1] CRAN (R 4.1.0)
##  cowplot                1.1.1    2020-12-30 [1] CRAN (R 4.1.0)
##  crayon                 1.5.0    2022-02-14 [1] CRAN (R 4.1.2)
##  data.table             1.14.2   2021-09-27 [1] CRAN (R 4.1.0)
##  DBI                    1.1.2    2021-12-20 [1] CRAN (R 4.1.0)
##  DelayedArray           0.20.0   2021-10-26 [1] Bioconductor
##  deldir                 1.0-6    2021-10-23 [1] CRAN (R 4.1.0)
##  desc                   1.4.1    2022-03-06 [1] CRAN (R 4.1.2)
##  DESeq2                 1.34.0   2021-10-26 [1] Bioconductor
##  devtools               2.4.3    2021-11-30 [1] CRAN (R 4.1.0)
##  digest                 0.6.29   2021-12-01 [1] CRAN (R 4.1.0)
##  doParallel             1.0.17   2022-02-07 [1] CRAN (R 4.1.2)
##  doSNOW                 1.0.20   2022-02-04 [1] CRAN (R 4.1.2)
##  dplyr                * 1.0.8    2022-02-08 [1] CRAN (R 4.1.2)
##  dynamicTreeCut         1.63-1   2016-03-11 [1] CRAN (R 4.1.0)
##  edgeR                  3.36.0   2021-10-26 [1] Bioconductor
##  ellipsis               0.3.2    2021-04-29 [1] CRAN (R 4.1.0)
##  evaluate               0.15     2022-02-18 [1] CRAN (R 4.1.2)
##  fansi                  1.0.2    2022-01-14 [1] CRAN (R 4.1.2)
##  farver                 2.1.0    2021-02-28 [1] CRAN (R 4.1.0)
##  fastcluster            1.2.3    2021-05-24 [1] CRAN (R 4.1.0)
##  fastmap                1.1.0    2021-01-25 [1] CRAN (R 4.1.0)
##  fdrtool                1.2.17   2021-11-13 [1] CRAN (R 4.1.0)
##  filematrix             1.3      2018-02-27 [1] CRAN (R 4.1.0)
##  FNN                    1.1.3    2019-02-15 [1] CRAN (R 4.1.0)
##  foreach                1.5.2    2022-02-02 [1] CRAN (R 4.1.2)
##  foreign                0.8-82   2022-01-13 [1] CRAN (R 4.1.2)
##  forestplot             2.0.1    2021-09-03 [1] CRAN (R 4.1.0)
##  Formula                1.2-4    2020-10-16 [1] CRAN (R 4.1.0)
##  fs                     1.5.2    2021-12-08 [1] CRAN (R 4.1.0)
##  genefilter             1.76.0   2021-10-26 [1] Bioconductor
##  geneplotter            1.72.0   2021-10-26 [1] Bioconductor
##  generics               0.1.2    2022-01-31 [1] CRAN (R 4.1.2)
##  GenomeInfoDb           1.30.1   2022-01-30 [1] Bioconductor
##  GenomeInfoDbData       1.2.7    2022-03-09 [1] Bioconductor
##  GenomicRanges          1.46.1   2021-11-18 [1] Bioconductor
##  ggplot2              * 3.3.5    2021-06-25 [1] CRAN (R 4.1.0)
##  ggpubr               * 0.4.0    2020-06-27 [1] CRAN (R 4.1.0)
##  ggrepel                0.9.1    2021-01-15 [1] CRAN (R 4.1.0)
##  ggsignif               0.6.3    2021-09-09 [1] CRAN (R 4.1.0)
##  glasso                 1.11     2019-10-01 [1] CRAN (R 4.1.0)
##  glmnet                 4.1-3    2021-11-02 [1] CRAN (R 4.1.0)
##  glue                 * 1.6.2    2022-02-24 [1] CRAN (R 4.1.2)
##  Gmisc                * 3.0.0    2022-01-03 [1] CRAN (R 4.1.2)
##  GO.db                  3.14.0   2022-04-11 [1] Bioconductor
##  gplots                 3.1.1    2020-11-28 [1] CRAN (R 4.1.0)
##  gridExtra              2.3      2017-09-09 [1] CRAN (R 4.1.0)
##  gtable                 0.3.0    2019-03-25 [1] CRAN (R 4.1.0)
##  gtools                 3.9.2    2021-06-06 [1] CRAN (R 4.1.0)
##  highr                  0.9      2021-04-16 [1] CRAN (R 4.1.0)
##  Hmisc                  4.6-0    2021-10-07 [1] CRAN (R 4.1.0)
##  htmlTable            * 2.4.0    2022-01-04 [1] CRAN (R 4.1.2)
##  htmltools              0.5.2    2021-08-25 [1] CRAN (R 4.1.0)
##  htmlwidgets            1.5.4    2021-09-08 [1] CRAN (R 4.1.0)
##  httr                   1.4.2    2020-07-20 [1] CRAN (R 4.1.0)
##  huge                   1.3.5    2021-06-30 [1] CRAN (R 4.1.0)
##  igraph                 1.2.11   2022-01-04 [1] CRAN (R 4.1.2)
##  impute                 1.68.0   2021-10-26 [1] Bioconductor
##  IRanges                2.28.0   2021-10-26 [1] Bioconductor
##  irlba                  2.3.5    2021-12-06 [1] CRAN (R 4.1.0)
##  iterators              1.0.14   2022-02-05 [1] CRAN (R 4.1.2)
##  jpeg                   0.1-9    2021-07-24 [1] CRAN (R 4.1.0)
##  jquerylib              0.1.4    2021-04-26 [1] CRAN (R 4.1.0)
##  jsonlite               1.8.0    2022-02-22 [1] CRAN (R 4.1.2)
##  KEGGREST               1.34.0   2021-10-26 [1] Bioconductor
##  KernSmooth             2.23-20  2021-05-03 [1] CRAN (R 4.1.2)
##  knitr                  1.39     2022-04-26 [1] CRAN (R 4.1.2)
##  labeling               0.4.2    2020-10-20 [1] CRAN (R 4.1.0)
##  lattice                0.20-45  2021-09-22 [1] CRAN (R 4.1.2)
##  latticeExtra           0.6-29   2019-12-19 [1] CRAN (R 4.1.0)
##  lavaan                 0.6-11   2022-03-31 [1] CRAN (R 4.1.2)
##  libcoin                1.0-9    2021-09-27 [1] CRAN (R 4.1.0)
##  lifecycle              1.0.1    2021-09-24 [1] CRAN (R 4.1.0)
##  limma                  3.50.1   2022-02-17 [1] Bioconductor
##  locfit                 1.5-9.5  2022-03-03 [1] CRAN (R 4.1.2)
##  lubridate              1.8.0    2021-10-07 [1] CRAN (R 4.1.0)
##  magrittr             * 2.0.2    2022-01-26 [1] CRAN (R 4.1.2)
##  MASS                   7.3-55   2022-01-13 [1] CRAN (R 4.1.2)
##  Matrix                 1.4-0    2021-12-08 [1] CRAN (R 4.1.0)
##  MatrixGenerics         1.6.0    2021-10-26 [1] Bioconductor
##  matrixStats            0.61.0   2021-09-17 [1] CRAN (R 4.1.0)
##  mbzinb                 0.2      2022-03-16 [1] local
##  memoise                2.0.1    2021-11-26 [1] CRAN (R 4.1.0)
##  metagenomeSeq          1.36.0   2021-10-26 [1] Bioconductor
##  mgcv                   1.8-39   2022-02-24 [1] CRAN (R 4.1.2)
##  mixedCCA               1.5.2    2022-07-14 [1] Github (irinagain/mixedCCA@c6d41a3)
##  mnormt                 2.0.2    2020-09-01 [1] CRAN (R 4.1.0)
##  modeltools             0.2-23   2020-03-05 [1] CRAN (R 4.1.0)
##  multcomp               1.4-18   2022-01-04 [1] CRAN (R 4.1.2)
##  multtest               2.50.0   2021-10-26 [1] Bioconductor
##  munsell                0.5.0    2018-06-12 [1] CRAN (R 4.1.0)
##  mvtnorm                1.1-3    2021-10-08 [1] CRAN (R 4.1.0)
##  NADA                   1.6-1.1  2020-03-22 [1] CRAN (R 4.1.0)
##  NetCoMi              * 1.0.3    2022-07-14 [1] Github (stefpeschel/NetCoMi@d4d80d3)
##  nlme                   3.1-155  2022-01-13 [1] CRAN (R 4.1.2)
##  nnet                   7.3-17   2022-01-13 [1] CRAN (R 4.1.2)
##  pbapply                1.5-0    2021-09-16 [1] CRAN (R 4.1.0)
##  pbivnorm               0.6.0    2015-01-23 [1] CRAN (R 4.1.0)
##  pcaPP                  1.9-74   2021-04-23 [1] CRAN (R 4.1.0)
##  permute                0.9-7    2022-01-27 [1] CRAN (R 4.1.2)
##  pheatmap               1.0.12   2019-01-04 [1] CRAN (R 4.1.0)
##  phyloseq             * 1.38.0   2021-10-26 [1] Bioconductor
##  pillar                 1.7.0    2022-02-01 [1] CRAN (R 4.1.2)
##  pkgbuild               1.3.1    2021-12-20 [1] CRAN (R 4.1.0)
##  pkgconfig              2.0.3    2019-09-22 [1] CRAN (R 4.1.0)
##  pkgload                1.2.4    2021-11-30 [1] CRAN (R 4.1.0)
##  plyr                   1.8.6    2020-03-03 [1] CRAN (R 4.1.0)
##  png                    0.1-7    2013-12-03 [1] CRAN (R 4.1.0)
##  preprocessCore         1.56.0   2021-10-26 [1] Bioconductor
##  prettyunits            1.1.1    2020-01-24 [1] CRAN (R 4.1.0)
##  processx               3.5.2    2021-04-30 [1] CRAN (R 4.1.0)
##  proxy                  0.4-26   2021-06-07 [1] CRAN (R 4.1.0)
##  ps                     1.6.0    2021-02-28 [1] CRAN (R 4.1.0)
##  pscl                   1.5.5    2020-03-07 [1] CRAN (R 4.1.0)
##  psych                  2.2.5    2022-05-10 [1] CRAN (R 4.1.2)
##  pulsar                 0.3.7    2020-08-07 [1] CRAN (R 4.1.0)
##  purrr                  0.3.4    2020-04-17 [1] CRAN (R 4.1.0)
##  qgraph                 1.9.2    2022-03-04 [1] CRAN (R 4.1.2)
##  R6                     2.5.1    2021-08-19 [1] CRAN (R 4.1.0)
##  rbibutils              2.2.7    2021-12-07 [1] CRAN (R 4.1.0)
##  RColorBrewer           1.1-2    2014-12-07 [1] CRAN (R 4.1.0)
##  Rcpp                 * 1.0.8.2  2022-03-11 [1] CRAN (R 4.1.2)
##  RcppZiggurat           0.1.6    2020-10-20 [1] CRAN (R 4.1.0)
##  RCurl                  1.98-1.6 2022-02-08 [1] CRAN (R 4.1.2)
##  Rdpack                 2.2      2022-03-19 [1] CRAN (R 4.1.2)
##  readxl               * 1.4.0    2022-03-28 [1] CRAN (R 4.1.2)
##  remotes                2.4.2    2021-11-30 [1] CRAN (R 4.1.0)
##  reshape2               1.4.4    2020-04-09 [1] CRAN (R 4.1.0)
##  Rfast                  2.0.6    2022-02-16 [1] CRAN (R 4.1.2)
##  rhdf5                  2.38.1   2022-03-10 [1] Bioconductor
##  rhdf5filters           1.6.0    2021-10-26 [1] Bioconductor
##  Rhdf5lib               1.16.0   2021-10-26 [1] Bioconductor
##  rlang                  1.0.2    2022-03-04 [1] CRAN (R 4.1.2)
##  rmarkdown              2.14     2022-04-25 [1] CRAN (R 4.1.2)
##  rootSolve              1.8.2.3  2021-09-29 [1] CRAN (R 4.1.0)
##  rpart                  4.1.16   2022-01-24 [1] CRAN (R 4.1.2)
##  rprojroot              2.0.2    2020-11-15 [1] CRAN (R 4.1.0)
##  RSQLite                2.2.10   2022-02-17 [1] CRAN (R 4.1.2)
##  rstatix                0.7.0    2021-02-13 [1] CRAN (R 4.1.0)
##  rstudioapi             0.13     2020-11-12 [1] CRAN (R 4.1.0)
##  S4Vectors              0.32.3   2021-11-21 [1] Bioconductor
##  sandwich               3.0-1    2021-05-18 [1] CRAN (R 4.1.0)
##  sass                   0.4.0    2021-05-12 [1] CRAN (R 4.1.0)
##  scales                 1.1.1    2020-05-11 [1] CRAN (R 4.1.0)
##  sessioninfo            1.2.2    2021-12-06 [1] CRAN (R 4.1.0)
##  shape                  1.4.6    2021-05-19 [1] CRAN (R 4.1.0)
##  snow                   0.4-4    2021-10-27 [1] CRAN (R 4.1.0)
##  SpiecEasi            * 1.1.2    2022-07-14 [1] Github (zdk123/SpiecEasi@c463727)
##  SPRING                 1.0.4    2022-08-03 [1] Github (GraceYoon/SPRING@3d641a4)
##  stringi                1.7.6    2021-11-29 [1] CRAN (R 4.1.0)
##  stringr                1.4.0    2019-02-10 [1] CRAN (R 4.1.0)
##  SummarizedExperiment   1.24.0   2021-10-26 [1] Bioconductor
##  survival               3.3-1    2022-03-03 [1] CRAN (R 4.1.2)
##  testthat               3.1.2    2022-01-20 [1] CRAN (R 4.1.2)
##  TH.data                1.1-0    2021-09-27 [1] CRAN (R 4.1.0)
##  tibble               * 3.1.6    2021-11-07 [1] CRAN (R 4.1.0)
##  tidyr                  1.2.0    2022-02-01 [1] CRAN (R 4.1.2)
##  tidyselect             1.1.2    2022-02-21 [1] CRAN (R 4.1.2)
##  tmvnsim                1.0-2    2016-12-15 [1] CRAN (R 4.1.0)
##  truncnorm              1.0-8    2018-02-27 [1] CRAN (R 4.1.0)
##  usethis                2.1.5    2021-12-09 [1] CRAN (R 4.1.0)
##  utf8                   1.2.2    2021-07-24 [1] CRAN (R 4.1.0)
##  vctrs                  0.3.8    2021-04-29 [1] CRAN (R 4.1.0)
##  vegan                  2.5-7    2020-11-28 [1] CRAN (R 4.1.0)
##  VGAM                   1.1-6    2022-02-14 [1] CRAN (R 4.1.2)
##  WGCNA                  1.71     2022-04-22 [1] CRAN (R 4.1.2)
##  withr                  2.5.0    2022-03-03 [1] CRAN (R 4.1.2)
##  Wrench                 1.12.0   2021-10-26 [1] Bioconductor
##  xfun                   0.30     2022-03-02 [1] CRAN (R 4.1.2)
##  XMAS2                * 2.1.7.4  2022-08-09 [1] local
##  XML                    3.99-0.9 2022-02-24 [1] CRAN (R 4.1.2)
##  xtable                 1.8-4    2019-04-21 [1] CRAN (R 4.1.0)
##  XVector                0.34.0   2021-10-26 [1] Bioconductor
##  yaml                   2.3.5    2022-02-21 [1] CRAN (R 4.1.2)
##  zCompositions          1.4.0    2022-01-13 [1] CRAN (R 4.1.2)
##  zlibbioc               1.40.0   2021-10-26 [1] Bioconductor
##  zoo                    1.8-9    2021-03-09 [1] CRAN (R 4.1.0)
## 
##  [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library
## 
## ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-peschel2021netcomi" class="csl-entry">
Peschel, Stefanie, Christian L Müller, Erika von Mutius, Anne-Laure Boulesteix, and Martin Depner. 2021. <span>“NetCoMi: Network Construction and Comparison for Microbiome Data in r.”</span> <em>Briefings in Bioinformatics</em> 22 (4): bbaa290.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="differential-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="test-example.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XbiomeAnalysis/16s_DataAnalysis_template/blob/main/08-Network_Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["16s microbiota data analysis based on XMAS package.pdf", "16s microbiota data analysis based on XMAS package.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true,
"toc_depth": 3
}
});
});
</script>

</body>

</html>
